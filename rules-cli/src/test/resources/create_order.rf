workflow 'create_order' ruleset 'Main' 'AVAILABLE_PAYMENT_METHODS' payment_method.payment_type not in list('CO_available_pmt_methods') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'Test_cvv' payment_method.payment_type in 'credit_card' AND user_id in list('CO_TEST_PAYMENTS') AND payment_method.requires_cvv_by_fraud <> 'pending' AND device.app.normalized_version in '7.52','7.53','7.54','7.55' return prevent with action('cvv_required',{'case_type':'-'}) 'TEST_CUSTOM_CVV2' user_id in list('CO_TEST_PAYMENTS') AND payment_method.payment_type in 'credit_card' AND device.app.normalized_version in '7.52','7.53','7.54','7.55' return allow 'user_ato_qa' user_id in list('CO_QA-Users-ATO-Test') return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'NEEDS_VALIDATION_SOAT_HIGH_AMOUNT_AND_LOGIN_1D' payment_method.payment_type in 'credit_card' AND order.store_type in 'Soat','SOAT','soat','soat_webview' AND order.custom.different_items_quantity <=2 AND order.custom.mk_internal_model_scoring_bucket >= 90 AND payment_method.verification_status not in 'success','Success' AND order.amount_in_usd >= 70 AND user.maturity in 'None','New' AND features.crosses_add_card_events_other_fingerprint_qty_fingerprints >=2 AND features.user_events_login_1d >=1 AND features.crosses_add_card_events_other_fingerprint_qty_fingerprints_failed_30d > 0 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_ORDER_TURBO_HIGH_AMOUNT' payment_method.payment_type in 'credit_card' AND order.store.store_type in list('CO_Vertical-Turbo') AND order.custom.different_items_quantity <=3 AND order.custom.mk_internal_model_scoring_bucket >= 75 AND payment_method.verification_status not in 'success','Success' AND order.amount_in_usd >= 40 AND user.maturity in 'None','New', 'Amateur' AND features.crosses_add_card_events_other_fingerprint_qty_fingerprints >= 1 AND features.user_events_add_card_qty_1d >= 1 AND (order.items.any{category in 'Cigarros','Cerveza','Whisky'}) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_OREDERS_EXPRESS_HIGH_AMOUNT' payment_method.payment_type in 'credit_card' AND order.order_type in 'express_picker','market','express' AND order.custom.different_items_quantity >=3 AND order.custom.mk_internal_model_scoring_bucket >= 75 AND payment_method.verification_status not in 'success','Success' AND user.customs.account_age_in_days = 0 AND order.amount_in_usd >= 20 AND user.maturity in 'None','New', 'Amateur' AND (order.amount_in_usd >= 30 OR order.custom.mk_internal_model_scoring_bucket >= 90) AND features.user_events_add_card_qty_1d >= 1 return prevent with action('cc_validation_required',{'case_type':'-'}) 'user_qa_whitelist' whitelist_entities.any {entity_type = 'user_qa'} return allow 'accept_order_Users_test' user_id in list('CO_QA-Users-Test') return allow 'accept_order_personal_users_test' user_id in list('CO_QA-Personal-Users-Test') return allow 'WL_USER_DSI_RO' user_id in list('CO_USERS_DSI_RO') return allow 'DELIVERY_RAPPIPAY_CC' order.store_type in 'rappi_pay_credit','rappi_pay' return allow 'Live_ecommerce_dia_sin_iva_prueba' user_id in list('Prueba Ecommerce') return allow 'accept_order_prime_recurrent_users' order.custom.user_is_prime = true and features.is_card_bin_in_anomaly_detector <> true and features.fake_users_user_email_score <= 1 and user.email_verification_status in 'VERIFIED' and (features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) <= 8 and features.crosses_login_device_qty_users_7d <= 3 and features.crosses_registration_device_qty_users_7d < 1 and (features.user_compensations_amount_90d/features.mk_payer_approved_amount_90d) < 0.05 and features.mk_payer_approved_qty_7d >= 1 and features.mk_payer_approved_qty_30d >= 6 and (features.mk_payer_approved_qty_60d >= features.mk_payer_approved_qty_30d + 6) and (features.mk_payer_approved_qty_90d >= features.mk_payer_approved_qty_60d + 6) and features.mk_payer_approved_amount_30d >= 50 and (features.mk_payer_approved_amount_90d >= features.mk_payer_approved_amount_30d + 100) return allow 'accept_order_users_reactivation_0323_temporal' user_id in list('Global_users_reactivation_03_23') and features.crosses_registration_device_qty_users_90d < 5 and features.crosses_registration_device_qty_users_1d < 2 and (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) < 8 and features.is_card_bin_in_anomaly_detector <> true and features.mk_payer_canceled_by_fraud_qty_1h < 5 and features.mk_payer_canceled_by_fraud_qty_6h < 10 and features.mk_fingerprint_distinct_user_id_1d <= 4 return allow 'TEMPORAL_FREEPASS_UNBLOCKED_USERS_JUN2023' 1=0 AND user_id in list('GLOBAL_UNBLOCKED_USERS_JUN2023') AND ('GLOBAL_UNBLOCKED_SMARTLIST_JUN2023' not in matching_smart_lists)AND (features.user_events_login_1d < 2) AND ((features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1d) < 3) AND (features.mk_payer_approved_amount_1d < 100) AND (order.custom.mk_internal_model_scoring_bucket < 95) AND (order.amount_in_usd < 200) return allow 'order_users_test_cash' user_id in list('QA_cash') return prevent with action('disable_cash',{'case_type':'-'}) 'accept_recreated_orders' user_id in list('user_id_recreated_orders') AND (features.mk_payer_approved_qty_6h + features.mk_payer_canceled_by_fraud_qty_6h + features.mk_payer_canceled_by_payment_error_qty_6h + features.mk_payer_canceled_by_user_qty_1d) < 3 return allow 'BUSINESS_RESTRICTION_TURBO' order.store.store_type contains 'turbo' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount >= 1000000 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancellation_rc_colusion_max_ii' (order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type in list('CO_Vertical-Ecommerce-Tech')) AND order.custom.applied_credits >= 100000 AND (order.custom.applied_credits > order.amount*1.5) AND user.maturity in 'None','New','Amateur' AND features.mk_payer_cancel_qty_7d >= 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('cancel_order',{'case_type':'-'}) 'RESTRICTION_cancel_atack_fraud_qty' features.mk_payer_canceled_by_fraud_qty_1h > 15 OR features.mk_payer_canceled_by_fraud_qty_6h > 30 return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'RESTRICTION_discount_attack_geohash_fraud_qty' (features.mk_geohash_cash_canceled_by_fraud_qty_12h > 5 OR features.mk_geohash_cash_canceled_by_fraud_qty_30d > 20 OR features.mk_geohash_canceled_by_fraud_qty_1h > 3) AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (order.custom.discount + order.custom.applied_credits) > 0 AND (user.completed_orders < 2 OR user.customs.account_age = 0 OR user.segment = 'Zero') AND (order.amount < 31000 OR ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) >= 0.55) AND device.device_age = 0 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'limit_discount'}) 'RESTRICTION_cancel_users_down_rappi' user.email_domain in 'down.rappi.com' return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'RESTRICTION_devices_blacklist' blacklist_entities.any {entity_type = 'devices'} return block with action('apply_restriction',{'case_type':'blocked'}) 'RESTRICTION_fingerprints_blacklist' blacklist_entities.any {entity_type = 'fingerprints'} return block with action('redact_all_cards',{'case_type':'-'}) 'RESTRICTION_card_bin_blacklist' blacklist_entities.any {entity_type = 'card_bin'} return block 'RESTRICTION_email_domain_blacklist' blacklist_entities.any {entity_type = 'email_domain'} return block 'RESTRICTION_USER_BLOCKED_WL' user_restrictions.any {restriction == 'blocked' AND reason_code in 'ATO'} AND features.mk_user_is_whitelisted = true return block 'RESTRICTION_user_blocked' user_restrictions.any {restriction == 'blocked'} AND (features.mk_user_is_whitelisted = false OR features.device_is_whitelisted = false) return block 'RESTRICTION_user_blocked_funds' user_restrictions.any {restriction == 'blocked_funds'} AND (order.custom.digital_wallet_amount > 5000 OR (payment_method.payment_type in 'rappi_pay' AND order.amount > 5000)) return block 'RESTRICTION_SAME_PHONE_NUMBER' user.completed_orders < 2 AND 'mismo_telef_diferentes_users' in matching_smart_lists AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'RESTRICTION_SAME_PHONE_NUMBER_2' 1=0 AND user.completed_orders < 2 AND 'mismo_telef_diferentes_users_2' in matching_smart_lists AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'limit_discount'}) 'RESTRICTION_user_limit_discount_cash' user_restrictions.any {restriction == 'limit_discount'} AND ((order.custom.applied_credits + order.custom.discount)/(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.839) AND (features.mk_payer_approved_qty_90d < 2 OR user.customs.account_age = 0 OR user.segment = 'Zero') AND payment_method.payment_type = 'cash' AND (features.mk_user_is_whitelisted = false OR features.device_is_whitelisted = false) AND (features.mk_device_distinct_user_id_90d >= 5 OR features.mk_fingerprint_distinct_user_id_90d >= 5) return prevent with action('disable_cash',{'case_type':'-'}) 'RESTRICTION_user_limit_discount' user_restrictions.any {restriction == 'limit_discount'} AND ((order.custom.applied_credits + order.custom.discount)/(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.839) AND (features.mk_payer_approved_qty_90d < 2 OR user.customs.account_age = 0 OR user.segment = 'Zero') AND (payment_method.payment_type in 'nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (features.mk_user_is_whitelisted = false OR features.device_is_whitelisted = false) AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_devices_blocked' entity_restrictions.any {restriction_id = 'blocked' AND entity_type = 'devices'} return block 'RESTRICTION_devices_blocked_funds' entity_restrictions.any {restriction_id = 'blocked_funds' AND entity_type = 'devices'} AND order.custom.digital_wallet_amount > 0 return block 'RESTRICTION_fingerprints_blocked' entity_restrictions.any {restriction_id = 'blocked' AND entity_type = 'fingerprints'} return block 'RESTRICTION_fingerprints_blocked_funds' entity_restrictions.any {restriction_id = 'blocked_funds' AND entity_type = 'fingerprints'} AND order.custom.digital_wallet_amount > 0 return block 'RESTRICTION_card_bin_blocked' entity_restrictions.any {restriction_id = 'blocked' AND entity_type = 'card_bin'} return block 'RESTRICTION_card_bin_blocked_funds' entity_restrictions.any {restriction_id = 'blocked_funds' AND entity_type = 'card_bin'} AND order.custom.digital_wallet_amount > 0 return block 'RESTRICTION_cancel_order_BIN_blacklisted' payment_method.card_bin in list('CO_BIN-Black-list-WARNING') return block 'RESTRICTION_email_domain_blocked' entity_restrictions.any {restriction_id = 'blocked' AND entity_type = 'email_domain'} return block 'RESTRICTION_email_domain_blocked_funds' entity_restrictions.any {restriction_id = 'blocked_funds' AND entity_type = 'email_domain'} AND order.custom.digital_wallet_amount > 0 return block 'RESTRICTION_MAX_AMOUNT_RESTAURANTS' order.store_type contains 'restaurant' AND payment_method.payment_type <> 'cash' AND order.amount_in_usd >= 1000 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_MAX_AMOUNT_CPGS' order.store_type in list('CO_Vertical-All-CPGs') AND payment_method.payment_type <> 'cash' AND order.amount_in_usd >= 4000 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_MAX_AMOUNT_ECOMMERCE' order.store_type in list('CO_Vertical-All-Ecommerce') AND payment_method.payment_type <> 'cash' AND order.amount_in_usd >= 7000 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_MAX_AMOUNT_RCASH_RFAVOR' order.store_type in 'ultraservicio', 'ultraservice', 'courier_hours' AND payment_method.payment_type <> 'cash' AND order.amount_in_usd >= 1500 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_MAX_AMOUNT_OTHER' payment_method.payment_type <> 'cash' AND order.amount_in_usd >= 10000 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_CANCEL_ORDER_BY_COUNTRY_CODE' (payment_method.country_code in list('Fingerprint_Closed-Countries-ids') AND payment_method.payment_type in 'credit_card' AND features.mk_user_is_whitelisted = false) OR (payment_method.country_code in list('Fingerprint_Closed-Countries-ids') AND payment_method.payment_type in 'credit_card' AND features.mk_device_is_safe_device_60d = 0 AND features.device_is_whitelisted = false) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_CANCEL_ORDER_ASIAN_CONFLICT' payment_method.payment_type in 'credit_card','rappi_pay_gateway','rappi_pay','paypal','google_pay','apple_pay' AND device.ip startswith list('GLOBAL_LIST_IP_RUSIA-BELARUS') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_user_cc_validation_required' user_restrictions.any {restriction == 'cc_validation_required'} AND (payment_method = NULL OR payment_method.payment_type = NULL OR payment_method.payment_type not in 'credit_card' OR payment_method.verification_status = NULL OR payment_method.verification_status not in 'success') AND (payment_method.payment_type = 'credit_card' OR payment_method.payment_type = 'cc') AND (features.mk_user_is_whitelisted = false OR features.device_is_whitelisted = false) AND ((user_restrictions.any {restriction in 'cc_validation_required' AND reason in 'restriction_fingerprint_possible_fake_name'} AND user.maturity not contains 'Pro' AND user.segment not in 'Diamond','Power') OR user_restrictions.any {restriction in 'cc_validation_required' AND reason not in 'restriction_fingerprint_possible_fake_name'}) AND (payment_method.age.days < 7 OR device.user_device_age < 5) AND (order.amount_in_usd > 5 OR (payment_method.country_code not in 'co','CO')) return prevent with action('cc_validation_required',{'case_type':'-'}) 'RESTRICTION_devices_cc_validation_required' entity_restrictions.any {restriction_id == 'cc_validation_required' AND entity_type = 'devices'} AND (payment_method = NULL OR payment_method.payment_type = NULL OR payment_method.payment_type not in 'credit_card' OR payment_method.verification_status = NULL OR payment_method.verification_status not in 'success') AND (payment_method.payment_type = 'credit_card' OR payment_method.payment_type = 'cc') return prevent with action('cc_validation_required',{'case_type':'-'}) 'RESTRICTION_fingerprints_cc_validation_required' entity_restrictions.any {restriction_id == 'cc_validation_required' AND entity_type = 'fingerprints'} AND (payment_method = NULL OR payment_method.payment_type = NULL OR payment_method.payment_type not in 'credit_card' OR payment_method.verification_status = NULL OR payment_method.verification_status not in 'success') AND (payment_method.payment_type = 'credit_card' OR payment_method.payment_type = 'cc') return prevent with action('cc_validation_required',{'case_type':'-'}) 'RESTRICTION_card_bin_cc_validation_required' entity_restrictions.any {restriction_id == 'cc_validation_required' AND entity_type = 'card_bin'} AND (payment_method = NULL OR payment_method.payment_type = NULL OR payment_method.payment_type not in 'credit_card' OR payment_method.verification_status = NULL OR payment_method.verification_status not in 'success') AND (payment_method.payment_type = 'credit_card' OR payment_method.payment_type = 'cc') return prevent with action('cc_validation_required',{'case_type':'-'}) 'RESTRICTION_email_domain_cc_validation_required' entity_restrictions <> NULL AND (entity_restrictions.any {restriction_id == 'cc_validation_required' AND entity_type = 'email_domain'}) AND (payment_method = NULL OR payment_method.payment_type = NULL OR payment_method.payment_type not in 'credit_card' OR payment_method.verification_status = NULL OR payment_method.verification_status not in 'success') AND (payment_method.payment_type = 'credit_card' OR payment_method.payment_type = 'cc') return prevent with action('cc_validation_required',{'case_type':'-'}) 'RT_FRAUD_TURBO_DC_HARD_CAP_AMOUNT' order.store.store_type contains 'turbo' AND payment_method.payment_type = 'cash' AND order.amount > 193000 return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_TURBO_DC_NLVU_RISK' order.store.store_type contains 'turbo' AND payment_method.payment_type = 'cash' AND features.mk_payer_approved_qty_90d < 2 AND order.amount > 40000 return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_TURBO_DC_ACTIVE_STORE_ORDERS_RISK' order.store.store_type contains 'turbo' AND payment_method.payment_type = 'cash' AND (features.mk_payer_active_orders_qty+features.mk_payer_store_qty_1d) > 1 AND order.amount > 10000 AND device.user_agent not contains 'Grability' return prevent with action('disable_cash',{'case_type':'-'}) 'RESTRICTION_BARRANQUILLA_CPGs' user.maturity in 'New', 'None' AND features.mk_payer_approved_qty_90d < 3 AND order.order_type in 'express_picker','market','express' AND (((order.custom.applied_credits + order.custom.discount) - 0.01*(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0 OR order.custom.coupon_type contains 'refered','first_time','any_time') AND (address.geohash_precision7 startswith list('Barranquilla-geohash-sur') OR (address.geohash_precision7 startswith 'd3fy9' AND features.mk_geohash_7_discount_qty_1d >= 5)) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'needs_validation_add_card_velocity' features.user_events_add_card_qty_1d > 3 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_int_bin_decision_tree_v1' (payment_method.country_code not in 'co','CO') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND ((features.user_events_qty_tc_failed< 4 AND features.mk_payer_cc_canceled_by_fraud_qty_30d>12 AND features.mk_device_cc_cancel_qty_90d>30 AND (features.mk_payer_cc_cancel_amount_90d >= features.mk_payer_cc_amount_90d*0.6))OR(features.user_events_qty_tc_failed> 3.5 AND order.custom.mk_internal_model_scoring_bucket > 90)) return prevent with action('cc_validation_required',{'case_type':'-'}) 'RESTRICTION_temp_rt_strike' 1= 0 AND (user.power_user_alike_score < 35 OR user.hvu_prob < 0.1) AND (payment_method.payment_type in 'nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND device.user_agent not contains list('CO_Devices-High-End') AND user.maturity in 'New','None','Amateur' AND address.geohash_precision7 startswith list('CO_rt_strike_geohash') AND features.mk_payer_approved_qty_90d <= 10 AND order.custom.digital_wallet_amount < 5000 AND user.completed_orders <= 10 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_Max_shipping_cost' order.store_type in 'restaurant' AND (order.custom.shipping_cost > 58000 OR order.custom.charges > 150000) AND (order.custom.discount + order.custom.applied_credits) > 0 AND order.is_marketplace = true AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (features.mk_payer_approved_qty_90d <= 10 OR user.completed_orders <= 10) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_max_discount_marketplace' 1=0 AND (order.custom.discount + order.custom.applied_credits) > 82000 AND order.store_type in 'restaurant' AND order.is_marketplace = true AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'accept_order_customer_service' device.user_agent contains list('CO_Customer-Email-Free-Pass') return allow 'ACCEPT_ORDER_APPLE_PAY' 1=0 AND payment_method.payment_type in 'apple_pay' return allow 'TEMPORARY_REACTIVATED_USERS_FREE_PASS_WL' whitelist_entities.responsible = 'york_landero' AND whitelist_entities.reason in 'Reactivated','reactivated' AND features.user_events_login_1d < 2 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1d) < 3 AND features.mk_payer_approved_amount_1d < 100 AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) < 20 AND order.custom.mk_internal_model_scoring_bucket < 95 AND (order.store_type in 'restaurant' OR order.store_type in list('CO_Vertical-All-CPGs')) return allow 'RESTRICTION_last_day_order_total_value_non_travel' features.mk_payer_non_travel_approved_amount_1d > 4250 AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_last_day_order_total_value' payment_method.payment_type in 'credit_card' AND features.mk_payer_approved_amount_1d > 4250 AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type not in 'cash' AND payment_method.verification_status not in 'success','Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'RESTRICTION_device_networks' user_id not contains list('CO_QA-Payment-Method') AND features.mk_device_distinct_user_id_90d > 7 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_New_User_Device_Network' ('User_Multi-New-Accounts-Same-Device' in matching_smart_lists OR 'Device_MultiNewAccounts' in matching_smart_lists) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.maturity in 'None','New' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'RESTRICTION_POSSIBLE_FARMED_ACCOUNT' ('Device_Farming_Fake_Accounts' in matching_smart_lists OR 'User_Possible_FarmedFakeAccount' in matching_smart_lists) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.maturity in 'None','New' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'RESTRICTION_fingerprint_network_new_user' user_id not contains list('CO_QA-Payment-Method') AND features.mk_fingerprint_distinct_user_id_7d >= 5 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type in 'credit_card' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'RESTRICTION_cancel_order_rappifavor_directions' features.rappi_favor_full_directions contains list('CO_Items-Restricted') AND order.store_type in 'courier_hours' AND user.hvu_prob < 0.6 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_cancel_order_rappifavor_address' features.rappi_favor_full_address contains list('CO_Items-Restricted') AND order.store_type in 'courier_hours' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_cancel_order_whim_restricted' order.custom.whim contains list('CO_Items-Restricted') AND order.store_type = 'courier_hours' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_last_day_order_count_rule' order.store_type not in 'courier_sampling' AND features.mk_payer_approved_qty_1d > 15 AND order.custom.mk_user_has_freepass = false AND user_id not in list('CO_user_id_companies_many_orders') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_upper_last_day_order_count_rule' order.store_type not in 'courier_sampling' AND features.mk_payer_approved_qty_1d > 30 AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_NEQUI_ACCOUNT_ABUSE' payment_method.payment_type = 'nequi' AND payment_method.external_reference_id in list ('Nequi accounts') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'RESTRICTION_Nequi_phone_mismatch' 1 = 0 AND payment_method.payment_type = 'nequi' AND payment_method.external_reference_id <> user.phone AND ((order.custom.discount + order.custom.applied_credits) > 0 ) AND (features.mk_payer_approved_qty_90d <= 10 OR user.customs.account_age < 10 OR user.segment = 'Zero') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_rpcash_rc' order.store_type in 'ultraservicio', 'ultraservice' AND order.custom.applied_credits > 0 AND features.mk_user_rappi_cash_is_whitelisted = false return block with action('communications',{'case_type':'rappi_cash_credits_fraud_communication'}) 'RESTRICTION_rcorp_limit' payment_method.payment_type in 'rappicorp', '&rappicorp' AND order.amount >= 1000000 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_registration_networks_1d' features.crosses_registration_device_qty_users_1d > 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_registration_networks_7d' features.crosses_registration_device_qty_users_7d > 3 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_registration_networks_15d' features.crosses_registration_device_qty_users_15d > 5 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_registration_networks_30d' features.crosses_registration_device_qty_users_30d > 7 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_LOGIN_HIGH_NETWORKS' features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (features.crosses_login_device_qty_users_1d >= 7 OR features.crosses_login_device_qty_users_7d >= 7 OR features.crosses_login_device_qty_users_15d >= 7 OR features.crosses_login_device_qty_users_30d >= 7 OR features.crosses_login_device_qty_users_60d >= 7 OR features.crosses_login_device_qty_users_90d >= 7) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_fake_email_normalized' ('fake_emails_normalized' in matching_smart_lists OR 'fake_emails_normalized_device' in matching_smart_lists) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND ((order.custom.applied_credits + order.custom.discount) - 0.839*(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0 AND features.mk_payer_approved_qty_90d <= 2 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_CANCEL_ORDER_BIN_ATTACK_RISK' payment_method.card_bin in list('CO_BIN-Attact-Risk') AND order.custom.mk_internal_model_scoring_bucket >= 70 AND user.customs.account_age = 0 AND features.user_events_add_card_qty_1d >= 1 AND (features.mk_fingerprint_distinct_user_id_90d >=2 OR features.mk_device_distinct_user_id_90d >= 2 OR (features.mk_payer_qty_90d = 0 AND (features.mk_fingerprint_distinct_user_id_90d >=1 OR features.mk_device_distinct_user_id_90d >= 1)) OR features.user_events_add_card_qty_1d >= 3) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_CANCEL_ORDER_INT_BIN_ATTACK_RISK' (payment_method.card_bin in list('CO_BIN-Attact-Risk') OR features.is_card_bin_in_anomaly_detector = true) AND order.custom.mk_internal_model_scoring_bucket >= 80 AND payment_method.country_code not contains 'null','co','CO' AND (user.segment in 'Zero' OR user.customs.account_age = 0) AND order.amount_in_usd >= 15 AND (user.email_verification_status in 'BOUNCED','DENIED' OR features.mk_payer_active_orders_qty > 0 OR (order.items.any { unified_category_name contains list('Global_Risky_Category_Products')} AND order.custom.different_items_quantity <= 3)) return block with action('apply_restriction',{'case_type':'blocked'}) 'BUSINESS_RULE_LOW_VALUE_ORDERS_NO_RUSH' 1=0 AND (user.segment in 'Zero','Low Value' AND user.maturity in 'New','None' AND features.mk_payer_approved_qty_90d < 2 AND order.amount = 0 AND ((order.custom.applied_credits + order.custom.discount)/(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) >= 0.9) OR (order.amount = 0 AND ((order.custom.applied_credits + order.custom.discount)/(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) >= 0.9 AND device.ip in list('CO_IP_NO_RUSH_FRAUD_MAY23')) AND address.geohash_precision7 in list('CO_GEOHASH7_NO_RUSH_FRAUD_MAY23') AND (regex_strip(order.order_id, '(.)(?!$)') IN '1','2','3','4','5') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'free_pass_rappi_card' payment_method.payment_type = 'rappi_pay_gateway' AND features.mk_device_is_safe_device_60d = 1 AND features.user_events_login_3d = 0 AND (features.mk_payer_qty_1h - features.mk_payer_canceled_by_fraud_qty_1h) < 2 AND (features.mk_payer_amount_1h - features.mk_payer_canceled_by_fraud_amount_1h) < 100 AND ((features.mk_payer_canceled_by_user_qty_1d < 3 AND features.mk_payer_canceled_by_user_qty_7d < 7) OR (features.mk_payer_canceled_by_user_amount_1d < 50 AND features.mk_payer_canceled_by_user_amount_7d < 150)) AND address.age.days > 0 return allow 'ATO_ultraservice_last_day_no_safe_device_60d' order.store_type in 'ultraservicio', 'ultraservice' AND device.user_agent not contains list('CO_Devices-High-End') AND features.mk_payer_ultraservicio_approved_qty_1d > 1 AND user.customs.account_age > 30 AND features.user_events_login_7d >= 1 AND features.mk_device_is_safe_device_60d = 0 return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'cancel_order_ATO_no_safe_device_10d_strange_logins' 1=0 AND device.user_agent not contains list('CO_Devices-High-End') AND payment_method.payment_type not in 'cash' AND order.store_type not in 'restaurant' AND features.mk_device_is_safe_device_10d = 0 AND device.user_device_age = 0 AND order.amount > 0 AND user.customs.account_age > 7 AND features.user_events_login_1d >= 2 AND features.mk_geohash_canceled_by_fraud_qty_7d > 5 return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'live_iva_ATO_wl_no safe_device_10d_amount_50k' 1=0 AND device.user_agent not contains list('CO_Devices-High-End') AND payment_method.payment_type not in 'cash' AND order.store_type not in 'restaurant' AND features.mk_device_is_safe_device_10d = 0 AND device.user_device_age = 0 AND order.amount > 50000 AND user.customs.account_age > 7 AND features.user_events_login_7d >= 1 AND order.store_type in list('CO_Vertical-All-Dia-Sin-IVA') return allow with action('manual_review',{'case_type':'HOT_SALE'}) 'cancel_order_ATO_wl_no safe_device_10d_amount_50k' features.mk_user_is_whitelisted = true AND device.user_agent not contains list('CO_Devices-High-End') AND payment_method.payment_type not in 'cash' AND order.store_type not in 'restaurant' AND features.mk_device_is_safe_device_10d = 0 AND device.user_device_age = 0 AND order.amount > 50000 AND user.customs.account_age > 7 AND features.user_events_login_7d >= 1 AND (features.mk_payer_address_qty_90d<6) return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'cancel_order_ATO_wl_no_safe_device_30d_amount_150k' features.mk_device_is_safe_device_30d = 0 AND order.store_type contains list('CO_Vertical-Liquor') AND features.mk_user_is_whitelisted = true AND device.user_agent not contains list('CO_Devices-High-End') AND payment_method.payment_type not in 'cash', 'Cash' AND device.user_agent contains 'Grability', 'Dalvik' AND order.amount > 150000 AND features.user_events_login_1d >= 1 AND features.mk_device_is_safe_device_10d = 0 AND device.user_device_age = 0 return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'ATO_wl_no_safe_device_30d_amount_100k' features.mk_device_is_safe_device_30d = 0 AND order.store_type in 'ultraservicio', 'ultraservice' AND features.mk_user_is_whitelisted = true AND device.user_agent not contains list('CO_Devices-High-End') AND payment_method.payment_type not in 'cash', 'Cash' AND device.user_agent contains 'Grability', 'Dalvik' AND order.amount > 100000 AND features.user_events_login_1d >= 1 AND features.mk_device_is_safe_device_10d = 0 AND device.user_device_age = 0 return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'cancel_order_ATO_no_safe_device_p2p_risk' features.user_events_login_7d >= 1 AND device.user_device_age = 0 AND (features.mk_payer_canceled_by_user_amount_1d / features.mk_payer_canceled_by_user_qty_1d) >350 AND order.store_type not in list('CO_Vertical-All-Dia-Sin-IVA') AND features.device_is_whitelisted = true AND payment_method.payment_type not in 'cash', 'Cash' AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'cancel_order_soat_ato_night_risk' order.store_type in 'Soat','SOAT','soat','soat_webview' AND features.user_events_login_1d >= 1 AND features.mk_payer_mins_since_first_approved_order >= 7200 AND order.store.store_id not contains list('CO_Store-Soat-Safe') AND user.customs.date_time_hour >= 22 AND device.user_device_age = 0 AND device.user_devices_count > 1 return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'cancel_order_geohash_ato_risk_nonlive' address.geohash_precision8 startswith list('Geohash_ATO') AND features.user_events_login_7d > 0 AND order.store_type not in 'restaurant' AND payment_method.payment_type in 'credit_card','rappi_pay','nequi' return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_probable_ato' order.store_type contains list('CO_Vertical-Liquor') AND device.user_agent not contains 'Grability' AND payment_method.payment_type not in 'cash' AND device.user_device_age = 0 AND order.amount > 200000 AND features.user_events_login_7d >= 1 AND user.customs.account_age > 30 return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'cancel_order_ato_risky_order_new_device_&_address' device.user_device_age = 0 AND address.age.days = 0 AND features.user_events_login_1d > 0 AND user.completed_orders > 10 AND ((order.items.any { product_name contains list('Global_Risky-Products')} AND order.custom.different_items_quantity = 1) OR (order.amount_in_usd > 20 AND order.store_type in 'ultraservicio', 'ultraservice') OR (order.amount_in_usd > 30 AND order.items.any { product_name contains list('Global_Risky-Products')} AND order.custom.different_items_quantity <= 3) OR (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) >= 3 OR (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1h) >= 2 OR order.amount_in_usd > 60) AND payment_method.payment_type not in 'cash' return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'cancel_order_2ndscore_probable_ato' device.user_device_age = 0 AND address.age.hours <= 12 AND features.user_events_login_1d >= 2 AND device.user_devices_count >= 2 AND order.amount_in_usd >= 20 AND payment_method.payment_type in 'credit_card' return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'CANCEL_ORDER_ HIGH_AMOUNT_SEGM_ZERO_NOV22' payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 50 AND order.store_type in list('CO_Vertical-All-CPGs') AND user.segment = 'Zero' AND order.amount_in_usd >= 80 AND user.customs.account_age = 0 AND (order.custom.mk_internal_model_scoring_bucket >= 95 OR user.email_verification_status in 'BOUNCED','DENIED') AND (order.items.any { product_name contains list('Global_Risky-Products')} OR order.amount_in_usd >= 150 OR 'Elegible_Geohash_CBK' in matching_smart_lists) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_HIGH_AMOUNT_RP_GIFTS_NOV22' payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 90 AND order.amount_in_usd >= 100 AND user.maturity in 'None','New','Amateur' AND order.store_type in list ('CO_store_type_gifts_liquor') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_HIGH_AMOUNT_HOMESENTRY_NOV22' payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 87 AND order.store_type in list ('CO_Vertical-Ecommerce-HOME') AND order.amount_in_usd >= 90 AND user.maturity in 'None','New' AND user.segment in 'Potential Power','Potential Diamond' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_Normalized_emails_risk' features.normalized_email_events_distinct_user_count > 2 AND user.segment not in 'Diamond','Power','Potential Diamond','Potential Power' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_high_risk_stores' 'CO_high_risk_stores_in' in matching_smart_lists AND dateDiff(hour, order.store.create_at, order.created_at) < 720 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'FAKE_USERS_ANOMALY_EMAIL' features.fake_users_user_anomaly_email_score>=5.5 AND features.mk_user_is_whitelisted = false AND user.email_domain not in 'privaterelay.appleid.com' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'FAKE_USERS_USER_AGENT_ACCOUNTS' order.custom.coupon_type contains 'refered' AND (user.segment = 'Zero' OR user.segment = NULL) AND features.fake_users_user_agent_similar_accounts_created_3d > 4 AND payment_method.payment_type = 'cash' AND features.mk_user_is_whitelisted = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'FAKE_USERS_NORM_MAILS_ACCOUNTS' order.custom.coupon_type contains 'refered' AND (user.segment = 'Zero' OR user.segment = NULL) AND features.fake_users_email_similar_accounts_created_3d > 4 AND payment_method.payment_type = 'cash' AND features.mk_user_is_whitelisted = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'TEMP_VALIDATION_NEW_CC' 1=0 AND payment_method.payment_type = 'credit_card' AND payment_method.verification_status not in 'success' AND payment_method.age.days < 3 AND order.store.store_type NOT contains 'turbo','restaurant' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('cc_validation_required',{'case_type':'-'}) 'TEMP_CANCEL_ORDER_NEW_CC' 1=0 AND payment_method.payment_type = 'credit_card' AND order.store.store_type NOT contains 'turbo','restaurant' AND payment_method.age.days < 7 AND address.age.days < 7 AND user.customs.account_age < 7 AND order.custom.mk_internal_model_scoring_bucket >= 90 AND features.mk_payer_mins_since_last_transaction <= 1440 AND features.mk_payer_qty_1d >= 1 AND features.user_events_add_card_qty_7d >= 1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'TEMP_CASH_RESTRICTION_1H' payment_method.payment_type = 'cash' AND user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0 AND features.mk_payer_cash_canceled_by_fraud_qty_1h > 3 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('disable_cash',{'case_type':'-'}) 'TEMP_CASH_RESTRICTION_6H' payment_method.payment_type = 'cash' AND user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0 AND features.mk_payer_cash_canceled_by_fraud_qty_6h > 5 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('disable_cash',{'case_type':'-'}) 'TEMP_CASH_RESTRICTION_1D' payment_method.payment_type = 'cash' AND user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0 AND features.mk_payer_cash_canceled_by_fraud_qty_1d > 8 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('disable_cash',{'case_type':'-'}) 'restriction_cash_max_amount' payment_method.payment_type in 'cash','rappi_pay_gateway_wallet' AND order.amount >= 500000 return prevent with action('disable_cash',{'case_type':'-'}) 'restriction_cash_max_amount_retail' payment_method.payment_type = 'cash' AND order.amount >= 198000 AND (order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type in list('CO_Vertical-ECommerce')) return block with action('cancel_order',{'case_type':'-'}) 'RT_FRAUD_RESTRICTION_CASH_MAX_AMOUNT' payment_method.payment_type = 'cash' AND order.amount >= 300000 AND order.order_type in 'express_picker','market','express' AND (features.fake_users_user_agent_similar_accounts_created_3d > 1 OR device.user_devices_count >= 3 OR 'User_Multi-New-Accounts-Same-Device' in matching_smart_lists OR features.mk_payer_qty_1h > 2) return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_RESTRICTION_CASH_NLVU' payment_method.payment_type = 'cash' AND order.amount >= 50000 AND order.order_type in 'express_picker','market' AND ((user.customs.account_age < 5 OR features.mk_payer_approved_qty_90d < 4) AND (device.user_devices_count >= 2 OR features.fake_users_email_similar_accounts_created_3d > 1 OR features.fake_users_user_agent_similar_accounts_created_3d > 1 OR order.custom.different_items_quantity < 0.6*(order.custom.items_quantity))) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_CASH_PHARMACY_NLVU' payment_method.payment_type = 'cash' AND order.store_type in list('CO_Vertical-Pharmacy') AND user.completed_orders < 4 AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.amount >88688 return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_LIQUOR_RESTRICTION_CASH' payment_method.payment_type = 'cash' AND order.amount >= 200000 AND order.order_type in 'express_picker','market', 'express' AND order.items.any { unified_category_name contains list('Liquor_&_Cigarette_Products')} AND (user.customs.account_age_in_days = 0 OR features.mk_payer_approved_qty_90d < 3) return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_RESTRICTION_CASH_CCP' payment_method.payment_type = 'cash' AND order.amount >= 180000 AND order.order_type in 'restaurant' AND ((user.customs.account_age <= 5 OR features.mk_payer_approved_qty_90d < 4) AND (device.user_devices_count >= 2 OR features.fake_users_email_similar_accounts_created_3d > 1 OR features.fake_users_user_agent_similar_accounts_created_3d > 1 OR order.custom.items_quantity >= 6)) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'RESTRICTION_geohash8_DNP' 1=0 AND (payment_method.payment_type in 'nequi', 'rappi_pay','bancolombia' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND address.geohash_precision8 startswith list('Restricted_Geohash_DNP') AND features.mk_payer_approved_qty_90d < 10 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in 'restaurant','Restaurant' return allow 'RESTRICTION_Fake_name_anomaly' 'fake-name-users' in matching_smart_lists AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (user.maturity in 'None','New' OR user.completed_orders = 0 OR user.customs.account_age < 30) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'RESTRICTION_SIMULTANEOUS_MULTIPLE_ORDERS_DEVICE_ABUSE' user.segment in 'Zero','Low Value' AND user.completed_orders = 0 AND order.custom.count_devices_user >= 2 AND ( (features.mk_device_active_orders_qty >= 1 AND (features.mk_device_active_orders_qty > features.mk_payer_active_orders_qty)) OR features.crosses_login_device_qty_users_1d >= 2) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user_id not in list('CO_user_id_companies_many_orders') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Nequi_risky_email' 1=0 AND payment_method.payment_type in 'nequi','rappi_pay' AND user.completed_orders <= 5 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (user.user_email contains list('Global_risky_email') OR user.user_email startswith list('CO_Email_Created_Bots') OR user.email_verification_status in 'BOUNCED','DENIED' OR user.email_domain in list('CO_Domain-Risk') OR 'fake-email-domains' in matching_smart_lists) AND user.user_email not contains '@privaterelay.appleid.com' AND order.store_type not in 'restaurant','ultraservicio' AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND order.store_type not in list('CO_Verticals-Ecommerce-Others') AND order.amount <= 60000 AND (features.mk_geohash_approved_qty_1d >= 2 OR features.mk_device_approved_qty_1d >= 2 OR features.mk_fingerprint_distinct_user_id_7d >1 OR mk_device_distinct_user_id_7d > 1) return allow 'DNP_Prepaid_risky_email' 1=0 AND payment_method.payment_type in 'credit_card','bancolombia' AND (payment_method.card_bin in list('CO_BIN-Prepaid-Cards') OR payment_method.country_code not in 'co','CO') AND user.completed_orders <= 5 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (user.user_email contains list('Global_risky_email') OR user.user_email startswith list('CO_Email_Created_Bots') OR user.email_verification_status in 'BOUNCED','DENIED' OR user.email_domain in list('CO_Domain-Risk') OR payment_method.full_name contains list('Global_payment_method_risky_name') OR 'fake-email-domains' in matching_smart_lists) AND user.user_email not contains '@privaterelay.appleid.com' AND order.store_type not in 'restaurant','ultraservicio' AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND order.store_type not in list('CO_Verticals-Ecommerce-Others') AND order.amount <= 60000 AND (features.mk_geohash_approved_qty_1d >= 2 OR features.mk_device_approved_qty_1d >= 2 OR features.mk_fingerprint_distinct_user_id_7d >1 OR mk_device_distinct_user_id_7d > 1) return allow 'DNP_split_hardcap' (user.maturity in 'New','None' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.order_split.count_orders_by_split_id >= 5 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_discount_rest_hardcap' 1=0 AND payment_method.payment_type <> 'cash' AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type = 'restaurant' AND order.amount <= 5000 AND order.custom.discount > 150000 return allow 'DNP_discount_rest_hardcap2' 1=0 AND payment_method.payment_type <> 'cash' AND order.store_type = 'restaurant' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.discount > 100000 AND (order.custom.discount - order.amount)>=80000 AND features.mk_payer_active_orders_qty >= 1 AND order.custom.digital_wallet_amount <= 10000 AND order.custom.applied_credits <= 10000 return allow 'DNP_LV_Rappifavor' 1=0 AND order.store_type in 'courier_hours' AND (payment_method.payment_type in 'nequi','rappi_pay','bancolombia' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND ((device.user_agent not contains list('CO_Devices-High-End') AND user.completed_orders <= 5) OR (user.completed_orders <= 2 AND user.customs.account_age_in_hours <= 6 )) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_amout_0_abusse' 1=0 AND (payment_method.payment_type in 'nequi','rappi_pay','bancolombia' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.amount = 0 AND order.custom.digital_wallet_amount > 0 AND order.store_type not in 'restaurant' AND (user.segment NOT IN 'Power','Diamond' AND user.completed_orders > 10) return allow 'DNP_late_night_abuse' 1 = 0 AND (payment_method.payment_type in 'nequi','bancolombia' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (user.customs.date_time_hour <= 6 OR user.customs.date_time_hour >= 23) AND order.store_type not in 'restaurant', 'ultraservicio','soat_webview' AND (user.maturity in 'New','None' OR user.completed_orders <= 5 OR features.mk_payer_approved_qty_90d <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND order.store_type not in list('CO_Verticals-Ecommerce-Others') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_TURBO_NEQUI' order.store.store_type in list('CO_Vertical-Turbo') AND features.mk_payer_approved_qty_90d <= 2 AND user.completed_orders < 30 AND (payment_method.payment_type in 'cash','nequi','rappi_pay','bancolombia' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (features.mk_payer_active_orders_qty > 1 OR features.mk_payer_store_qty_1h > 1 OR features.mk_payer_qty_1h >1 ) AND order.custom.discount >=18000 AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false AND user.segment NOT IN 'Power','Diamond' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_KILLER_RT' 1=0 AND (user.completed_orders < 5 OR user.customs.account_age_in_hours <= 24) AND (payment_method.payment_type in 'nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.amount_in_usd < 2 AND order.store.store_id in list('STORE_ID_DNP_TIP') AND device.user_agent contains 'Dalvik' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_NEW_USER_CPGS_TIP' 1=0 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type in list('CO_Vertical-All-CPGs') AND payment_method.payment_type <> 'cash' AND order.amount_in_usd < 2 AND features.mk_payer_approved_qty_90d < 4 AND user.maturity in 'New','None' AND user.power_user_alike_score <= 30 AND features.mk_payer_approved_amount_90d < 7 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_29_ORDERS_IN_PROGRESS_SINPRISA' order.store_type = 'restaurant' AND user.maturity in 'New','None' AND order.amount_in_usd <= 2 AND order.custom.different_items_quantity <= 3 AND user.customs.account_age_in_days <= 40 AND features.mk_payer_approved_amount_90d <= 7 AND features.mk_payer_active_orders_qty >= 2 AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0.84 AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'discount_30_new_user_sinprisa' order.store_type = 'restaurant' AND user.maturity in 'New','None' AND user.customs.account_age_in_days <= 30 AND features.mk_payer_approved_amount_90d <= 15 AND order.amount_in_usd <= 3 AND features.mk_payer_discount_ratio_7d > 0.5 AND features.mk_payer_discount_qty_7d >= 3 AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_31_DECISION_TREE_CASH_V1' ((payment_method.payment_type in 'cash' AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0.839 AND features.mk_payer_coupon_qty_90d <= 1.5 AND features.mk_payer_is_safe_user_90d <= 0.5 AND features.mk_geohash_7_coupon_qty_7d <= 35.5 AND features.mk_device_discount_ratio_90d > 0.67709) OR (payment_method.payment_type in 'cash' AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0.8 AND features.mk_payer_coupon_qty_90d <= 1.5 AND features.mk_payer_is_safe_user_90d <= 0.5 AND features.mk_geohash_7_coupon_qty_7d > 35.5 AND features.mk_payer_discount_ratio_7d <= 0.238)) AND (features.mk_device_distinct_user_id_90d >= 3 OR features.mk_fingerprint_distinct_user_id_90d >= 3) return prevent with action('disable_cash',{'case_type':'-'}) 'DISCOUNT_32_DECISION_TREE_PSE_V1' ((payment_method.payment_type in 'pse_avanza','pse','pseavanza' AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.custom.discount + order.amount + order.custom.digital_wallet_amount)) > 0.4946 AND features.mk_payer_approved_qty_90d <= 1.5 AND features.mk_payer_is_safe_user_90d <= 0.5 AND features.user_by_device_events_days_since_first_event <= 10.3185 AND features.mk_device_qty_90d <= 8.5 AND (order.custom.discount / (order.custom.discount + order.amount)) > 0.6376 AND order.custom.applied_credits > 6550 AND user.hvu_prob <= 0.0823) OR (payment_method.payment_type in 'pse_avanza','pse','pseavanza' AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.custom.discount + order.amount + order.custom.digital_wallet_amount)) > 0.4946 AND features.mk_payer_approved_qty_90d <= 1.5 AND features.mk_payer_is_safe_user_90d <= 0.5 AND features.user_by_device_events_days_since_first_event <= 9.3185 AND features.mk_device_qty_90d <= 8.5 AND (order.custom.discount / (order.custom.discount + order.amount)) <= 0.9376 AND order.custom.shipping_cost > 3350 AND order.amount_in_usd > 0.295 AND features.mk_geohash_7_discount_ratio_7d > 0.25) OR (payment_method.payment_type in 'pse_avanza','pse','pseavanza' AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.custom.discount + order.amount + order.custom.digital_wallet_amount)) > 0.4946 AND features.mk_payer_approved_qty_90d <= 1.5 AND features.mk_payer_is_safe_user_90d <= 0.5 AND features.user_by_device_events_days_since_first_event > 9.3185 AND order.custom.charges > 2750 AND features.mk_geohash_7_coupon_qty_7d > 52.2 AND features.mk_device_approved_amount_90d <= 0.125 AND user.hvu_prob <= 0.886)) AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_PRICE_DIFF_DISCOUNT' features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment NOT IN 'Diamond' AND payment_method.payment_type = 'cash' AND (features.mk_payer_discount_amount_1d > 200000 OR features.mk_device_discount_amount_1d > 200000 OR features.mk_geohash_7_discount_amount_1d > 400000 ) AND order.order_type in 'express_picker','market','express' AND device.user_agent NOT contains 'Grability' AND device.user_agent NOT contains list('CO_Devices-High-End') return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_GEOHASH_PRICE_DIFF_DISCOUNT' address.geohash_precision7 startswith 'd2g7' AND features.mk_geohash_7_discount_amount_7d > 1000000 AND user.maturity in 'New','None','Amateur' AND payment_method.payment_type = 'cash' AND device.user_agent not contains list('Global_Devices_iOS-High-End') AND order.order_type in 'express_picker','market','express' return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_ANOMALIE_PRICE_DIFF' ('CO_CPGs-Store-Under-Attack' in matching_smart_lists OR 'CO-Stores-Medium-Risk-Cash' in matching_smart_lists) AND payment_method.payment_type = 'cash' AND order.order_type in 'express_picker','market','express' AND features.mk_payer_approved_qty_90d < 8 AND (order.custom.discount >= 0.40*(order.amount)) AND order.custom.different_items_quantity < 3 return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_50P_DISCOUNT_NLVU' payment_method.payment_type = 'cash' AND (order.custom.discount >= 0.50*(order.amount)) AND order.order_type in 'express_picker','market','express' AND user.maturity in 'New','None' AND features.mk_payer_approved_qty_90d < 10 AND order.amount > 40000 AND order.custom.different_items_quantity <= 2 AND features.mk_payer_active_orders_qty >= 2 return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_30P_DISC_RISKY_PROD_NLVU' payment_method.payment_type = 'cash' AND order.order_type in 'express_picker','market','express' AND (features.mk_payer_approved_qty_90d < 8 OR features.mk_payer_gmv_amount_1d < 40000 OR features.mk_payer_gmv_amount_7d < 100000) AND (order.custom.discount >= 0.30*(order.amount)) AND order.custom.different_items_quantity < 3 AND order.amount >= 70000 AND order.items.any { product_name contains list('Global_Risky-Products')} return prevent with action('disable_cash',{'case_type':'-'}) 'COUPON_1_funky_email_abuse' features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.coupon_type contains 'refered','first_time' AND user.user_email contains list('Global_risky_email') AND user.user_email not contains '@privaterelay.appleid.com' AND order.amount < 31000 AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_2_Risky_Products_abuse' user.completed_orders <= 2 AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 40000 AND features.mk_geohash_qty_7d >= 5 AND order.items.any { product_name contains list('Global_Risky-Products') OR product_name startswith 'Ron '} AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_3_Email_bounced' user.completed_orders <= 2 AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 31500 AND user.email_verification_status in 'BOUNCED','DENIED' AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND user.user_email not contains list('CO_Domain-False-Positive') AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_4_Fingerprint_Network' user.completed_orders <= 2 AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 35000 AND features.mk_fingerprint_distinct_user_id_7d >= 3 AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_5_Device_Network' user.completed_orders <= 2 AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 35000 AND features.mk_device_distinct_user_id_30d >= 3 AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_6_Email_Domain' 1=0 AND user.completed_orders <= 2 AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 35000 AND (user.email_domain in list('CO_Domain-Risk') OR 'fake-email-domains' in matching_smart_lists) AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_7_Prepaid_abuse' payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND user.completed_orders <= 2 AND order.amount < 35000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.coupon_type contains 'refered','first_time' AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND order.store_type not in 'restaurant' AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_7bis_Prepaid_abuse_rest' payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND user.completed_orders <= 3 AND order.amount < 8000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.coupon_type contains 'refered','first_time' AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND order.store_type in 'restaurant' AND order.custom.different_items_quantity <= 2 AND order.custom.items_quantity >= 3 AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_8_multiple_orders_abuse' (features.mk_payer_approved_qty_90d < 2 AND user.segment in 'Zero') AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.custom.coupon_type contains 'refered','first_time','any_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist')AND (order.custom.different_items_quantity <= 5 OR order.amount < 50000) AND(features.mk_payer_active_orders_qty > 1 OR features.mk_geohash_cash_approved_qty_6h >= 4 OR features.mk_geohash_cash_approved_qty_12h >= 6 OR features.mk_geohash_cash_approved_qty_90d >= 20) AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_9_Split' user.completed_orders <= 2 AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.order_split.count_orders_by_split_id >= 2 AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_10_Risky_Name' user.maturity in 'New','None' AND order.amount < 51000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type in 'credit_card' AND payment_method.full_name contains list('Global_payment_method_risky_name') AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.coupon_type contains 'refered','first_time' AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_11_MK_Geohash' user.maturity in 'New','None' AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_geohash_qty_6h > 5 AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND order.store_type not in 'restaurant' AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_12_Email_bots' user.maturity in 'New','None' AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.user_email startswith list('CO_Email_Created_Bots') AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND device.user_agent contains 'Dalvik' AND 'rappicorp_users' not in matching_smart_lists return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_13_Nequi_restaurant' user.completed_orders <= 2 AND order.amount < 5000 AND payment_method.payment_type IN 'rappi_pay','nequi' AND order.store_type = 'restaurant' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.items.any { product_name contains list('Global_Risky-Products')} AND order.custom.coupon_type contains 'refered','first_time' AND order.custom.coupon_type not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_14_Risky_Products_abuse_prepaid' (user.maturity in 'New','None' OR user.completed_orders <= 2) AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 91000 AND order.store_type not in 'restaurant' AND order.items.any { product_name contains list('Global_Risky-Products')} AND features.mk_fingerprint_qty_1d > 1 AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND order.custom.discount > 30000 AND order.custom.coupon_type not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_15_Risky_Products_abuse_nequi' features.mk_payer_approved_qty_90d <= 2 AND order.custom.coupon_type contains 'refered','first_time', 'any_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (order.amount = 0 OR (order.amount < 50000 AND order.custom.discount / (order.custom.discount + order.amount) > 0.6))AND (order.store_type in 'turbo' OR order.store_type in list('CO_Vertical-All-CPGs') )AND order.items.any { product_name contains list('CL_Risky-Products')} AND payment_method.payment_type in 'nequi','rappi_pay' AND order.custom.coupon_type not contains list('R4B_Coupons_whitelist') AND ((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) >= 2 OR features.mk_geohash_approved_qty_1d >=2) AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_16_unique_risky_product_50p' (user.maturity in 'New','None' OR user.completed_orders < 5) AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (order.custom.discount + order.custom.applied_credits) > order.amount AND order.items.any { product_name contains list('Global_Risky-Products')} AND order.custom.different_items_quantity = 1 AND order.order_type in 'express_picker','market','express' AND order.custom.coupon_type not contains list('R4B_Coupons_whitelist') AND device.user_agent contains 'Dalvik' AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_17_abuse_risky_products_80p' (user.maturity in 'New','None' OR user.completed_orders < 5) AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (order.custom.discount + order.custom.applied_credits) >= (4*order.amount) AND order.items.any { product_name contains list('Global_Risky-Products')} AND order.order_type in 'express_picker','market','express' AND order.custom.coupon_type not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_18_RISKY_STORES_DISABLE_CASH' order.store.store_id contains list('CO_RISK_COUPON_STORE') AND order.custom.coupon_type contains 'refered' AND order.custom.coupon_code contains list('CO_Coupon-Promo-Alerts') AND payment_method.payment_type = 'cash' AND user.completed_orders <= 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND device.user_agent not contains list('CO_Devices-High-End') AND (order.custom.discount + order.custom.applied_credits - 4*order.amount) >= 0 AND order.custom.coupon_type not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return prevent with action('disable_cash',{'case_type':'-'}) 'COUPON_19_ABUSE_REST_CROSSES_70P' order.custom.coupon_type = 'first_time' AND payment_method.payment_type = 'cash' AND device.user_agent contains list('CO_Devices-Score-1-2') AND order.custom.micro_zone contains list('CO_MZ-uno-dos') AND device.user_agent not contains 'Grability' AND order.store_type = 'restaurant' AND features.crosses_registration_device_qty_users_30d >= 3 AND ((3*order.custom.discount)+(3*order.custom.applied_credits)-(7*order.amount)) >= 0 AND order.custom.coupon_type not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity <= 5 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists return prevent with action('disable_cash',{'case_type':'-'}) 'COUPON_20_REFERED_ABUSE_RISKY_USER' 1=0 AND (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND order.custom.coupon_type contains 'refered' AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.different_items_quantity = 1 AND user.customs.account_age <= 15 AND user.hvu_prob < 0.1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.amount < 50000 AND device.user_agent not contains 'Grability' AND device.user_agent contains list('CO_Devices-Score-1-2') AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_21_KILLER_WEB_CASH_RULE' (user.maturity in 'New','None' OR user.completed_orders < 5) AND order.custom.coupon_type contains 'refered','first_time' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 300000 AND order.store_type not in 'restaurant' AND order.items.any { product_name contains list('Global_Risky-Products')} AND payment_method.payment_type = 'cash' AND user.customs.account_age <= 2 AND address.age.minutes < 10 AND device.user_agent not contains 'Grability','Dalvik' AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_22_GEOHASH_ABUSER_DC' order.custom.items_quantity >= 10 AND order.custom.different_items_quantity > 5AND user.completed_orders= 0 AND order.items.any { product_name contains list('Global_Risky-Products')} AND order.custom.coupon_type contains 'refered','first_time'AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.hvu_prob = 0 AND user.customs.account_age_in_hours < 10AND (features.mk_geohash_approved_qty_1d < features.mk_geohash_cancel_qty_1d) AND payment_method.payment_type = 'cash' AND device.user_agent contains 'Dalvik' AND device.user_agent contains list('CO_Devices-Score-1-2') AND 'rappicorp_users' not in matching_smart_lists return prevent with action('disable_cash',{'case_type':'-'}) 'COUPON_23_SELF_ONBOARDING_RISK' (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (user.maturity in 'New','None' OR user.segment = 'Zero' OR user.customs.account_age < 20) AND order.custom.coupon_type contains 'refered','first_time' AND order.custom.coupon_code not in 'null' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.is_marketplace = true AND order.store.store_id in list('CO_SelfOnboarding_Stores') AND order.store.store_id not in list('Non_fraud_marketplace_rests') AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) ' COUPON_24_BLACKLIST_STORES_RESTRICTION' 1=0 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (user.maturity in 'New','None' OR user.segment = 'Zero' OR user.customs.account_age < 20) AND order.custom.coupon_type contains 'refered','first_time' AND order.custom.coupon_code not in 'null' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.is_marketplace = true AND order.store.store_id in list('CO_MKP_BL_STORES') AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_25_FAKE_MKP_ALLY' 1=0 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND user.segment = 'Zero' AND order.custom.coupon_type contains 'refered','first_time' AND order.custom.coupon_code not in 'null' AND order.custom.different_items_quantity <= 5 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.is_marketplace = true AND order.store.store_id not in list('Non_fraud_marketplace_rests') AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'COUPON_26_MKP_ALLY_ABUSE' 'CO-coupon-abuse' in matching_smart_lists AND order.is_marketplace = true AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (features.mk_payer_approved_qty_90d < 2 AND user.segment in 'Zero') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_1_funky_email_abuse' features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (order.custom.discount - order.amount)>=6000 AND user.user_email contains list('Global_risky_email') AND user.user_email not contains '@privaterelay.appleid.com' AND order.amount < 31000 AND order.custom.different_items_quantity <= 5 AND device.user_agent contains 'Dalvik' AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_2_Risky_Products_abuse' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND (order.custom.discount - order.amount)>=6000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 31000 AND order.store_type not in 'restaurant' AND (features.mk_geohash_qty_1d> 2 OR user.customs.account_age_in_hours < 6) AND order.items.any { product_name contains list('Global_Risky-Products')} AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_3_Email_bounced' user.maturity in 'New','None' AND (order.custom.discount - order.amount)>=6000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 31500 AND order.store_type not in 'restaurant' AND user.email_verification_status in 'BOUNCED','DENIED' AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND user.user_email not contains list('CO_Domain-False-Positive') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_4_Fingerprint_Network' 0=1 AND user.maturity in 'New','None' AND (order.custom.discount - order.amount)>=6000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 35000 AND features.mk_fingerprint_distinct_user_id_7d >= 3 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_5_Device_Network' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d < 2) AND (order.custom.discount - order.amount)>=10000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 30000 AND features.mk_device_distinct_user_id_30d >= 3 AND 'rappicorp_users' not in matching_smart_lists return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_6_Email_Domain' user.maturity in 'New','None' AND (order.custom.discount - order.amount)>=6000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 35000 AND (user.email_domain in list('CO_Domain-Risk') OR 'fake-email-domains' in matching_smart_lists) AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_7_Prepaid_abuse' payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND user.maturity in 'None','New' AND order.amount < 35000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (order.custom.discount - order.amount)>=6000 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND order.store_type not in 'restaurant' AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_8_multiple_orders_abuse' user.maturity in 'New','None' AND (order.custom.discount - order.amount)>=6000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_payer_active_orders_qty > 1 AND user.completed_orders <= 2 AND features.mk_payer_approved_qty_90d <= 2 AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_9_Split' user.maturity in 'New','None' AND (order.custom.discount - order.amount)>=6000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.order_split.count_orders_by_split_id >= 2 AND order.custom.different_items_quantity <= 5 AND ((order.custom.applied_credits + order.custom.discount)/(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.839) AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_10_Risky_Name' user.maturity in 'New','None' AND order.amount < 51000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type in 'credit_card' AND payment_method.full_name contains list('Global_payment_method_risky_name') AND device.user_agent not contains list('CO_Devices-High-End') AND (order.custom.discount - order.amount)>=6000 AND ((order.custom.applied_credits + order.custom.discount)/(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.839) AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_11_MK_Geohash' user.maturity in 'New','None' AND (order.custom.discount - order.amount)>=6000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_geohash_qty_6h > 5 AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND order.store_type not in 'restaurant' AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_12_Email_bots' user.maturity in 'New','None' AND (order.custom.discount - order.amount)>=6000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.user_email startswith list('CO_Email_Created_Bots') AND order.custom.different_items_quantity <= 5 AND ((order.custom.applied_credits + order.custom.discount)/(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.839) AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_13_DVC_CROSSES' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d < 2) AND features.crosses_registration_device_qty_users_30d >= 2 AND ((order.custom.applied_credits + order.custom.discount)/(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.80) AND order.amount<150000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_14_GOOGLE_LOGIN' order.shipping_address.phone in 'null' AND device.user_agent NOT contains 'Grability' AND device.user_agent not contains list('CO_Devices-High-End') AND user.completed_orders <= 2 AND (2*order.custom.discount + 2*order.custom.applied_credits - order.amount)>0 AND order.custom.different_items_quantity <= 5 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_15_PICKUP_NEW_USER_ABUSE' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND order.delivery_method = 'pickup' AND order.amount < 100000 AND order.store_type in 'restaurant' AND (device.user_devices_count >= 2 OR features.mk_device_distinct_user_id_30d >= 2) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) >= 0.50 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_16_REST_<1USD' device.user_agent not contains list('CO_Devices-High-End') AND order.amount_in_usd <= 1 AND order.custom.items_quantity <= 2 AND features.mk_payer_approved_qty_90d <= 2 AND order.custom.user_is_prime = false AND order.store_type in 'restaurant' AND order.custom.micro_zone in list('CO_MZ_Discount-abuse') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.digital_wallet_amount = 0 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_17_CASH_REST' (user.completed_orders < 2) AND ((3*order.custom.discount)+(3*order.custom.applied_credits)-(7*order.amount)) >= 0 AND order.is_marketplace = true AND order.store_type in 'restaurant','restaurante' AND payment_method.payment_type in 'cash', 'Cash' AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.store.store_id not in list('Non_fraud_marketplace_rests') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists return prevent with action('disable_cash',{'case_type':'-'}) 'DISCOUNT_18_CASH_REST' payment_method.payment_type = 'cash' AND (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND order.custom.different_items_quantity = 1 AND order.store_type = 'restaurant' AND ((3*order.custom.discount)+(3*order.custom.applied_credits)-(7*order.amount)) >= 0 AND device.user_agent not contains list('CO_Devices-High-End') AND (features.crosses_registration_device_qty_users_30d >= 2 OR user.email_verification_status in 'BOUNCED','DENIED' OR order.items.any { product_name contains list('Global_Risky-Products')} OR user.user_email contains list('Global_risky_email') OR features.mk_device_distinct_user_id_7d >= 2 OR device.device_age.hours = 0 OR device.user_devices_count >= 2 OR features.mk_geohash_approved_qty_1d >= 2 ) AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists return prevent with action('disable_cash',{'case_type':'-'}) 'DISCOUNT_19_MINIMUM_AMT_ZERO' 0=1 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND user.completed_orders <= 2 AND order.amount <= 3000 AND order.custom.discount >= 15000 AND user.hvu_prob < 0.1 AND user.customs.account_age > 5 AND user.customs.account_age < 20 AND order.custom.items_quantity < 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_20_GEOHASH_NETWORK_40P' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND order.custom.applied_credits <= 30000 AND user.customs.account_age >= 5 AND user.customs.account_age <= 20 AND (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) > 0 AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0.40 AND order.items.any { product_name contains list('Global_Risky-Products')} AND features.mk_geohash_qty_1d > 1 AND user.hvu_prob < 0.1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND device.user_agent contains 'Dalvik' AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_21_PRECISION_RULE_60P' device.user_devices_count >= 2 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards'))AND((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) >= 0.50 AND device.user_agent not contains 'Grability' AND order.store_type in 'restaurant','restaurante' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND device.device_age.hours < user.customs.account_age_in_hours AND user.customs.account_age < 30 AND (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_22_HARD_CAP_CANCELLATIONS_50P' device.user_devices_count > 2 AND (order.custom.canceled_orders_count / order.custom.finished_orders_count) > 0.6 AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0.839 AND order.store_type in list('CO_Vertical-Super-and-Hiper') AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards'))AND user.customs.account_age <= 15 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_23_RISKY_GEOHASH_65P' (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (user.maturity in 'New','None' OR user.segment = 'Zero' OR user.customs.account_age < 20) AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0.65 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND address.geohash_precision7 startswith list('CO_geohash7_discount') AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'discount_24_device_abuse_high_test' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d < 2) AND 'Devices_discount_abuse' in matching_smart_lists AND ((order.custom.applied_credits + order.custom.discount) - 0.8*(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0 AND payment_method.payment_type in 'cash', 'nequi', 'rappi_pay' AND user_id startswith '19','18','17','16','15' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'limit_discount'}) 'discount_25_rest_device' (user.completed_orders < 2 AND order.custom.finished_orders_count < 2 AND features.mk_payer_approved_qty_90d < 2) AND order.store_type in 'restaurant' AND ((order.custom.applied_credits + order.custom.discount) - 0.839*(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0 AND features.mk_device_discount_qty_90d > 0 AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_26_COSTA_SANTANDER_100' (user.segment in 'Zero','Low Value' AND features.mk_payer_approved_qty_90d = 0) AND address.geohash_precision7 startswith list('Macrozona_costa_santander') AND order.custom.coupon_type contains 'refered','first_time','any_time' AND ((order.custom.applied_credits + order.custom.discount) - 0.99*(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_27A_GEOHASH_ABUSE_DECISION_TREE' user.segment in 'Zero','Low Value' AND features.mk_payer_approved_qty_90d < 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type in 'restaurant' AND ((order.custom.applied_credits + order.custom.discount) - 0.5*(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0 AND features.mk_geohash_7_discount_qty_1d > 15 AND features.mk_geohash_7_discount_ratio_1d > 0.2 AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_27_GEOHASH_ABUSE_HIGH' (user.segment in 'Zero','Low Value' AND features.mk_payer_approved_qty_90d = 0) AND order.store_type in 'restaurant','restaurante' AND order.amount <= 15000 AND ((order.custom.applied_credits + order.custom.discount) - 0.839*(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0 AND features.mk_geohash_7_discount_qty_1d >= 2 AND ((features.mk_geohash_7_discount_amount_1d) - 0.20*(features.mk_geohash_7_discount_amount_1d + features.mk_geohash_7_gmv_amount_1d)) > 0 AND user.customs.account_age <= 80 AND order.custom.items_quantity <= 3 AND device.user_agent not contains 'Grability' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists AND payment_method.payment_type in 'cash','pse_avanza','pse' AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_28_DEVICE_ABUSE_HIGH' (user.segment in 'Zero','Low Value' AND features.mk_payer_approved_qty_90d = 0) AND order.store_type in 'restaurant','restaurante' AND ((order.custom.applied_credits + order.custom.discount) - 0.839*(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0 AND features.mk_device_discount_qty_1d >= 2 AND ((features.mk_device_discount_amount_1d) - 0.67*(features.mk_device_discount_amount_1d + features.mk_device_gmv_amount_1d)) > 0 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_29_LOW_VALUE_ORDERS' user.segment in 'Zero','Low Value' AND user.maturity in 'New','None' AND payment_method.payment_type in 'cash','pse_avanza' AND features.mk_payer_approved_qty_90d = 0 AND device.user_devices_count >= 1 AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.839) AND user.power_user_alike_score <= 10 AND user.hvu_prob <= 0.35 AND order.amount <= 60000 AND (features.mk_geohash_7_discount_qty_1d >= 5 OR features.mk_geohash_7_discount_ratio_1d >= 0.45) AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_RISKY_STORES_ABUSE' (user.segment = 'Zero' OR features.mk_payer_approved_qty_90d < 4) AND order.custom.mk_user_has_freepass = false AND (order.custom.discount + order.custom.applied_credits) > 0 AND 'CO_Stores-discounts-abuse-i-V2' in matching_smart_lists AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DISCOUNT_31_SLEEPING_ACCOUNTS' order.store_type in 'restaurant' AND user.customs.account_age_in_days >= 90 AND user.segment in 'Zero', 'Low Value' AND user.power_user_alike_score <= 30 AND user.maturity in 'None','New' AND (order.custom.applied_credits + order.custom.discount) >= 15000 AND order.amount_in_usd <= 10 AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.90) AND user.hvu_prob <= 0.3 AND features.mk_payer_mins_since_last_transaction = 0 AND features.mk_payer_approved_qty_90d = 0 AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_1_funky_email_abuse_new_user' user.completed_orders <= 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (order.custom.applied_credits - order.amount)>=0 AND (user.user_email contains list('Global_risky_email') OR user.user_email startswith list('CO_Email_Created_Bots') OR user.email_domain in list('CO_Domain-Risk') OR 'fake-email-domains' in matching_smart_lists) AND user.user_email not contains '@privaterelay.appleid.com' AND order.amount < 21000 AND order.custom.digital_wallet_amount = 0 AND order.custom.applied_credits >= 20000 AND order.custom.different_items_quantity < 5 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND 'rappicorp_users' not in matching_smart_lists return block with action('apply_restriction',{'case_type':'limit_discount'}) and action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_2_risky_product_abuse_new_user' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND ((order.custom.applied_credits + order.custom.discount) - 0.50*(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0 AND (device.user_agent not contains 'Grability' OR device.user_devices_count > 1) AND order.items.any { product_name contains list('Global_Risky-Products')} AND (payment_method.payment_type in 'cash' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_3_marketplace_free_shipping_abuse_new_user' user.completed_orders <= 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (order.custom.applied_credits - order.custom.shipping_cost)=0 AND order.amount < 6000 AND order.custom.digital_wallet_amount = 0 AND order.custom.applied_credits >= 5000 AND order.store_type = 'restaurant' AND order.is_marketplace = true AND order.custom.different_items_quantity <= 5 AND order.store.store_id not in list('Non_fraud_marketplace_rests') AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_4_CPGs_abuse_new_user_many_devices' 0=1 AND (user.maturity in 'New','None' OR user.completed_orders <= 2) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (order.custom.applied_credits - order.amount + order.custom.digital_wallet_amount) >=10000 AND order.amount < 15000 AND order.custom.applied_credits >= 20000 AND device.device_age.hours = 0 AND device.user_devices_count >= 2 AND device.user_agent contains 'Dalvik' AND order.order_type in 'express_picker','market','express' AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_5_cpgs_abuse_lvu_reactivation' 0=1 AND order.custom.applied_credits >= 20000 AND order.amount < 40000 AND order.store_type in list('CO_Vertical-All-CPGs') AND user.maturity in 'None','New','Amateur' AND order.items.any { product_name contains list('Global_Risky-Products')} AND order.custom.applied_credits <= 42000 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.custom.different_items_quantity <= 5 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_6_Barranquilla_cpgs_abuse_lvu' features.mk_payer_approved_qty_90d <= 5 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.hvu_prob < 0.1 AND (payment_method.payment_type in 'cash','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.amount < 100000 AND order.order_type in 'express_picker','market','express' AND (2*order.custom.applied_credits + 2*order.custom.discount - order.amount) >= 0 AND address.geohash_precision7 startswith list('Barranquilla-geohash-sur') AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_7_cpgs_new_low_value_75percent' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d < 2) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.amount < 100000 AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) >= 0.839 AND order.order_type in 'express_picker','market','express' AND (features.mk_geohash_approved_qty_1d >= 2 OR device.user_devices_count > 1 OR features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_7d >= 2) AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (device.user_agent not contains 'Grability' OR device.user_agent not contains list('CO_Devices-High-End')) AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_8_activation_new_low_value_66percent' user.completed_orders = 0 AND user.customs.account_age >= 9 AND order.custom.applied_credits >= 5000 AND order.custom.applied_credits <= 42000 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (device.user_agent contains 'Dalvik' AND device.user_agent not contains list('CO_Devices-High-End')) AND device.device_age.hours < 6 AND ((features.mk_device_discount_amount_1d) - 0.77*(features.mk_device_discount_amount_1d + features.mk_device_gmv_amount_1d)) > 0 AND order.custom.different_items_quantity <= 1 AND features.mk_geohash_approved_qty_30d > 3 AND features.mk_geohash_7_discount_qty_1d >= 3 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_9_activation_LV_CPG_killer_rule_38k_cash' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND applied_credits >= 25000 and applied_credits <= 40000 AND device.user_devices_count > 1 AND payment_method.payment_type = 'cash' AND (device.user_agent not contains 'Grability' OR device.user_agent not contains list('CO_Devices-High-End')) AND device.device_age.hours < 24 AND order.order_type in 'express_picker','market','express' AND user.customs.account_age >= 3 AND user.customs.account_age <= 25 AND order.amount <= 150000 AND (features.mk_geohash_approved_qty_7d > 2 OR features.mk_device_distinct_user_id_90d >= 2 OR features.mk_geohash_cash_approved_amount_30d > 0) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists return prevent with action('disable_cash',{'case_type':'-'}) 'RAPPICREDITS_10_LifeMiles_abuse_100k' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND order.custom.applied_credits >= 100000 AND ((order.store_type in 'restaurant','restaurante' AND (order.custom.discount + order.custom.applied_credits) >= (4*order.amount)) OR (order.store_type not in 'restaurant','restaurante' AND (order.custom.discount + order.custom.applied_credits) >= (2.33*order.amount)) OR (order.items.any{product_name contains list('Global_Risky-Products')} AND order.custom.different_items_quantity <= 3 AND (order.custom.discount + order.custom.applied_credits) > order.amount)) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.hvu_prob < 0.3 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_11_RISKY_PRODUCTS_CPGS_ABUSE' 0=1 AND order.order_type in 'express_picker','market','express' AND user.completed_orders < 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (order.custom.applied_credits - order.amount)> 0 AND order.custom.applied_credits > 0 AND order.items.any { product_name contains list('Global_Risky-Products')} AND user.customs.account_age < 30 AND order.custom.applied_credits <= 42000 AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_12_activation_network_75percent' (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND order.custom.applied_credits > 0 AND order.amount < 17650 AND ((order.custom.applied_credits + order.custom.discount)/(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.839) AND (features.mk_device_distinct_user_id_90d > 1 OR device.user_devices_count > 3) AND order.custom.different_items_quantity <= 2 AND order.custom.applied_credits <= 42000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.hvu_prob < 0.1 AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_13_risky_product_abuse_activation_rest' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND device.user_devices_count > 1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.custom.different_items_quantity <= 3 AND order.custom.applied_credits <= 42000 AND order.amount < 9000 AND order.custom.digital_wallet_amount = 0 AND order.custom.applied_credits >= 10000 AND order.store_type in 'restaurant','restaurante' AND user.customs.account_age < 15 AND user.customs.account_age > 2 AND order.items.any { product_name contains list('Global_Risky-Products')} AND user.hvu_prob < 0.3 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_14_max_cancel_activation' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND device.user_devices_count > 1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND user.hvu_prob < 0.3 AND order.custom.applied_credits <= 42000 AND order.amount < 20000 AND order.custom.digital_wallet_amount = 0 AND order.custom.applied_credits >= 5000 AND (features.mk_payer_canceled_by_fraud_qty_1h >= 3 OR features.mk_payer_canceled_by_fraud_qty_6h >= 4 OR features.mk_payer_canceled_by_fraud_qty_1d >= 5 OR features.mk_geohash_canceled_by_fraud_qty_1h >= 5 OR features.mk_geohash_canceled_by_fraud_qty_7d>= 15 OR features.mk_device_canceled_by_fraud_qty_1h >= 5 OR features.mk_device_canceled_by_fraud_qty_1d >= 7) AND user.customs.account_age < 15 AND user.customs.account_age > 2 AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_15_max_geohash_activation' 1=0 AND (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0)AND device.user_devices_count > 1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND user.hvu_prob < 0.1 AND order.custom.applied_credits <= 42000 AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0.40 AND features.mk_geohash_approved_qty_1d >= 2 AND user.customs.account_age < 20 AND user.customs.account_age > 2 AND order.custom.different_items_quantity <= 5 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_16_FAKE_MKP_ALLY' 1 = 0 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND order.custom.applied_credits > 1 AND (order.custom.applied_credits / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount)) >= 0.45 AND device.user_agent contains 'Dalvik' AND device.user_agent contains list('CO_Devices-Score-1-2') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.is_marketplace = true AND order.store.store_id not in list('Non_fraud_marketplace_rests') AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_17_SELF_ONBOARDING_RISK' (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (user.maturity in 'New','None' OR user.segment = 'Zero' OR user.customs.account_age < 20) AND order.custom.applied_credits > 0 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.is_marketplace = true AND order.store.store_id in list('CO_SelfOnboarding_Stores') AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_18_BLACKLIST_STORES_RESTRICTION' 1 = 0 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (user.maturity in 'New','None' OR user.segment = 'Zero' OR user.customs.account_age < 20) AND order.custom.applied_credits > 0 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.is_marketplace = true AND order.store.store_id in list('CO_MKP_BL_STORES') AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_19_MINIMUM_AMT_ZERO' (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND features.mk_payer_approved_qty_90d <= 2 AND order.amount <= 3000 AND order.custom.applied_credits >= 15000 AND user.hvu_prob < 0.1 AND user.customs.account_age > 5 AND user.customs.account_age < 20 AND order.custom.items_quantity < 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_20_KILLER50P' (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND (address.geohash_precision7 startswith 'd3fy' OR address.geohash_precision7 startswith list('Bogota-geohash-galerias') OR features.user_events_login_1h >= 1) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.customs.account_age > 5 AND user.customs.account_age < 20 AND order.custom.applied_credits > 0 AND (order.custom.applied_credits / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount)) > 0.45 AND order.amount < 41000 AND device.user_agent not contains 'Grability' AND 'rappicorp_users' not in matching_smart_lists AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_21_FALLBACK' (user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0) AND device.user_devices_count > 1 AND device.device_age.hours < user.customs.account_age_in_hours AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND user.hvu_prob < 0.1 AND order.custom.items_quantity >= 6 AND (features.mk_geohash_approved_qty_1d >= 2 OR features.mk_device_distinct_user_id_90d >=2 OR features.mk_payer_canceled_by_fraud_qty_6h >= 4 OR address.geohash_precision7 startswith list('Barranquilla-geohash-sur') OR address.geohash_precision7 startswith list('Bogota-geohash-galerias') OR features.user_events_login_1h >= 1) AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_BIN_INT_ATTACK_JUN23' payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('LISTA_BIN_INT_PRELIGROSOS_JUN23') AND device.user_agent not contains 'Grability', 'Dalvik' AND order.custom.mk_internal_model_scoring_bucket > 30 AND (device.user_device_age < 20 OR payment_method.age.days < 30 AND user.customs.account_age < 30) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_22_ALLIED_FRAUD' (user.maturity in 'New','None' OR user.completed_orders <= 5 OR user.customs.account_age <= 30) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type in 'cash','rappi_pay' AND order.is_marketplace = true AND order.custom.different_items_quantity >= 6 AND order.amount < 50000 AND order.custom.applied_credits > 10000 AND order.store_type in 'restaurant','restaurante' AND address.geohash_precision7 startswith list('CO_fraude_aliado_rappicreditos') AND order.store.store_id not in list('Non_fraud_marketplace_rests') AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_23_GEOHASH_ABUSE' user.segment in 'Zero','Low Value' AND payment_method.payment_type = 'cash' AND features.mk_payer_approved_qty_90d <= 1 AND ((((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) >= 0.839) OR ((((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount)) > 0.48)AND(order.store.store_id in list('CO_Stores_High_Risk_CPGS')))) AND user.power_user_alike_score <= 10 AND order.custom.applied_credits >= 10000 AND ( (features.mk_geohash_7_discount_ratio_1d > 0.25 AND features.mk_geohash_7_discount_qty_1d >= 5) OR (features.mk_geohash_7_discount_ratio_7d > 0.25 AND features.mk_geohash_7_discount_qty_7d >= 14) OR (features.fake_users_email_similar_accounts_created_3d >= 5)) AND (features.mk_device_distinct_user_id_90d >= 2 OR features.mk_fingerprint_distinct_user_id_90d >=2) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_24_DEVICE_ABUSE_NEW_USER_BAQ' user.segment in 'Zero','Low Value' AND payment_method.payment_type NOT in 'credit_card','cc' AND user.customs.account_age <= 15 AND features.mk_payer_approved_qty_90d = 0 AND order.custom.applied_credits >=9000 AND address.age.days < 9 AND device.user_devices_count >= 2 AND ((order.custom.applied_credits + order.custom.discount)/(order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.5) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_25_ADDRESS_ABUSE_NEW_USER' user.segment in 'Zero','Low Value','Regular' AND user.maturity in 'None','New' AND payment_method.payment_type in 'cash','rappi_pay_gateway_wallet' AND user.customs.account_age <= 30 AND features.mk_payer_approved_qty_90d <= 1 AND device.user_devices_count >= 2 AND order.custom.applied_credits >= 10000 AND ((order.custom.applied_credits + order.custom.discount) / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 0.50) AND user.power_user_alike_score <= 10 AND user.hvu_prob <= 0.1 AND features.mk_geohash_7_discount_qty_1d >= 2 AND features.mk_geohash_7_discount_ratio_1d >= 0.25 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'ALLIED_DISABLE_CASH_I_SOB_MARKETPLACE' 1=0 AND order.store.self_onboarding = true AND payment_method.payment_type = 'cash' AND order.is_marketplace = true AND user.segment NOT in 'Potential Diamond', 'Power', 'Diamond' AND features.mk_payer_approved_qty_90d < 20 AND device.user_device_age <= 30 AND 'CO_Stores_Whitelist_v2' not in matching_smart_lists return prevent with action('disable_cash',{'case_type':'-'}) 'TEST_ALLIED_DISABLE_CASH_II_HIGH_RISK_CANCELLATIONS' 1=0 AND order.store_type = 'restaurant' AND payment_method.payment_type in 'cash' AND features.mk_allies_store_order_canceled_qty_7d > 4 AND (features.mk_allies_store_order_canceled_amt_7d/features.mk_allies_store_order_finished_amt_7d) > 1AND 'CO_Stores_Whitelist_v2' not in matching_smart_lists return allow 'ALLIED_DISABLE_CASH_II_HIGH_RISK_CANCELLATIONS' 1=0 AND order.store_type = 'restaurant' AND 'co_allied_high_risk_cancellations' in matching_smart_lists AND payment_method.payment_type in 'cash' AND 'CO_Stores_Whitelist_v2' not in matching_smart_lists return prevent with action('disable_cash',{'case_type':'-'}) 'ALLIES_CHARGEBACK_RISKY_STORES' 'CO_Cbks_stores_i' in matching_smart_lists AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type in 'credit_card' return block with action('communications',{'case_type':'cancel_order_store_fraud_communication'}) 'ALLIED_CANCEL_ORDER_CANCELLATION_RISK_I' 1=0 AND user.customs.account_age <= 25 AND payment_method.payment_type in 'cash','rappi_pay_gateway_wallet' AND features.mk_user_global_finished_orders_count_15d <= 1 AND order.custom.items_quantity < 3 AND order.custom.different_items_quantity < 3 AND order.store.self_onboarding = true AND 'CO_Stores_Whitelist_v2' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'Ally_dnp_tip_abuse_i' payment_method.payment_type in 'credit_card','rappi_pay_gateway_wallet','rappi_pay_gateway','cash' AND user.customs.account_age_in_days <= 30 AND order.store.self_onboarding = true AND 'CO_Ally_dnp_tip' in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_store_fraud_communication'}) 'ALLY_CANCEL_ORDER_DNP_WHIM_ABUSE_7D' payment_method.payment_type in 'apple_pay' AND user.customs.account_age_in_days <= 25 AND order.store.self_onboarding = true AND 'CO_Ally_dnp_whim_7d' in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_store_fraud_communication'}) 'ALLY_CANCEL_ORDER_SOB_NEW_USERS_DISCOUNT' user.customs.account_age <= 10 AND order.store.self_onboarding = true AND payment_method.payment_type in 'pse_avanza','pse' AND order.is_marketplace = true AND order.custom.items_quantity <= 3 AND order.custom.different_items_quantity = 1 AND order.amount_in_usd < 1 AND features.mk_allies_store_buy_new_users_7d / features.mk_allies_store_coupon_qty_7d >= 0.95 return block with action('communications',{'case_type':'cancel_order_store_fraud_communication'}) 'ALLY_CANCEL_ORDER_CASH_CCP' user.customs.account_age < 40 AND order.store.self_onboarding not in true AND payment_method.payment_type in 'cash' AND order.custom.different_items_quantity <= 5 AND order.amount_in_usd >= 20 AND user.maturity in 'None','New','Amateur' AND device.user_device_age <= 7 AND order.order_type in 'restaurant' AND device.user_agent contains 'Grability' AND features.mk_allies_store_cash_approved_amount_7d / features.mk_allies_store_order_finished_amt_7d >= 0.9 return block with action('communications',{'case_type':'cancel_order_store_fraud_communication'}) 'ALLY_CANCEL_ORDER_RISKY_USERS_NEW' user.customs.account_age <= 5 AND device.user_device_age <= 5 AND order.amount_in_usd <= 1 AND user.maturity in 'None','New' AND dateDiff(hour, order.store.create_at, order.created_at) < 720 return block with action('communications',{'case_type':'cancel_order_store_fraud_communication'}) 'ALLY_CANCEL_ORDER_RISKY_USERS_NEW_TEST' user.customs.account_age <= 5 AND device.user_device_age <= 5 AND (payment_method.payment_type in 'rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.custom.different_items_quantity = 1 AND order.amount_in_usd <= 1 AND user.maturity in 'None','New' AND 'CO_Stores_Whitelist_v2' not in matching_smart_lists AND (features.mk_payer_scheduled_orders_qty >=2 OR (features.mk_geohash_qty_1h / features.mk_geohash_qty_90d) > 0.2 OR (features.mk_geohash_qty_1d / features.mk_geohash_qty_90d) > 0.4) return block with action('communications',{'case_type':'cancel_order_store_fraud_communication'}) 'ALLY_CANCEL_ORDER_DNP_PHARMACY' user.customs.account_age <= 3 AND device.user_device_age <= 3 AND payment_method.payment_type in 'credit_card' AND order.custom.different_items_quantity = 1 AND order.amount_in_usd <= 1 AND user.maturity in 'None','New' AND order.store_type in list('CO_Vertical-Pharmacy') AND 'CO_Stores_Whitelist_v2' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_store_fraud_communication'}) 'ALLY_CANCEL_ORDER_COMPENSATION_CASH_REST' user.customs.account_age <= 3 AND device.user_device_age <= 3 AND user.maturity in 'New','None' AND payment_method.payment_type = 'cash' AND order.amount_in_usd <= 20 AND order.custom.different_items_quantity <= 3 AND order.store_type in 'restaurant' AND (features.mk_allies_store_cash_approved_amount_1d / features.mk_allies_store_order_finished_amt_1d) >= 0.9 AND (features.mk_allies_store_order_finished_amt_7d - features.mk_allies_store_order_finished_amt_1d) < features.mk_allies_store_order_finished_amt_1d return block with action('communications',{'case_type':'cancel_order_store_fraud_communication'}) 'ALLY_CANCEL_ORDER_COMPENSATION_RAPPI_PAY' user.customs.account_age <= 3 AND device.user_device_age <= 3 AND payment_method.payment_type = 'rappi_pay_gateway_wallet' AND order.amount_in_usd <= 5 AND order.custom.different_items_quantity <= 3 AND user.maturity in 'New','None' AND order.store_type in 'restaurant' AND order.is_marketplace = false AND order.items.any { product_name contains list('CO_Ally_Products_DNP')} AND (features.mk_allies_store_order_finished_amt_7d - features.mk_allies_store_order_finished_amt_1d) < features.mk_allies_store_order_finished_amt_1d return block with action('communications',{'case_type':'cancel_order_store_fraud_communication'}) 'Cancellation_Restaurant_Cpgs_New_User_Apple_users' 1=0 AND (order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type in 'restaurant') AND payment_method.payment_type in 'apple_pay' AND order.amount_in_usd >= 30 AND order.custom.items_quantity >= 3 AND order.custom.different_items_quantity <= 3 AND (features.mk_payer_approved_qty_90d < 5 OR features.mk_payer_approved_amount_90d < 50) AND user.customs.account_age < 30 AND (user.segment = 'Zero' OR user.maturity in 'None','New') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'Cancellation_Rcash_New_User_Apple_users' order.store_type in 'ultraservicio', 'ultraservice' AND payment_method.payment_type in 'apple_pay' AND order.amount_in_usd >= 30 AND order.custom.items_quantity >= 3 AND order.custom.different_items_quantity <= 3 AND (features.mk_payer_approved_qty_90d < 5 OR features.mk_payer_approved_amount_90d < 50) AND user.customs.account_age < 30 AND (user.segment = 'Zero' OR user.maturity in 'None','New') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RAPPICREDITS_23_REACTIVATION_RISKY_PRODUCT' 0=1 AND (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND features.user_events_login_1h >= 1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.customs.account_age > 5 AND features.mk_payer_approved_qty_30d<= 3 AND order.custom.applied_credits >= 5000 AND order.custom.applied_credits <= 20000 AND (order.custom.applied_credits / (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount)) > 0.45 AND order.items.any { product_name contains list('Global_Risky-Products')} AND order.custom.digital_wallet_amount <= 11000 AND order.custom.different_items_quantity <= 3 AND user.hvu_prob < 0.3 AND 'rappicorp_users' not in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_fraud_stores' order.store.store_id in list('CO_Fraud-Stores_V2') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'FREEPASS_SAFE_USER_FINGERPRINT_DEVICE_AND_GEOHASH7_REVIEW_HORUS' payment_method.payment_type in 'credit_card' AND order.amount_in_usd < 150 AND (features.mk_payer_qty_1h < 6 OR features.mk_payer_qty_1d < 9 OR features.mk_payer_qty_7d < 30) AND 'Users_safe_horus' in matching_smart_lists AND 'Fingerprint_safe_horus' in matching_smart_lists AND 'Device_safe_horus' in matching_smart_lists AND 'Geohash7_safe_horus_2' in matching_smart_lists return allow 'live_horus_restriction_cancel_order_international_new_users_non_densif_hv' order.amount_in_usd >= 10 AND order.store.store_type not contains 'turbo','restaurant','soat' AND order.amount_in_usd >= 35 AND (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND ((order.store_type in 'restaurant','restaurante' AND device.user_agent not contains 'Grability') OR order.store_type not in 'restaurant','restaurante') AND order.store_type not in list('CO_Vertical-All-CPGs') AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 0 AND order.custom.micro_zone not in list('CO_MZ-Densified') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Densified') AND (address.age.days <30) AND (features.mk_device_distinct_cc_fingerprint_90d >= 4 OR user.segment not in 'Zero' OR features.crosses_add_card_events_other_fingerprint_qty_fingerprints >= 4) AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE-HIGH_VALUE'}) 'live_horus_restriction_cancel_order_international_new_users_non_densif' order.amount_in_usd >= 10 AND order.store.store_type not contains 'turbo','restaurant' AND (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND ((order.store_type in 'restaurant','restaurante' AND device.user_agent not contains 'Grability') OR order.store_type not in 'restaurant','restaurante') AND order.store_type not in list('CO_Vertical-All-CPGs') AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 0 AND order.custom.micro_zone not in list('CO_MZ-Densified') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Densified') AND (address.age.days <30) AND (features.mk_device_distinct_cc_fingerprint_90d >= 4 OR user.segment not in 'Zero' OR features.crosses_add_card_events_other_fingerprint_qty_fingerprints >= 4) AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'restriction_cancel_order_international_new_users_non_densif' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND order.custom.mk_internal_model_scoring_bucket >= 72 AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND ((order.store_type in 'restaurant','restaurante' AND device.user_agent not contains 'Grability') OR order.store_type not in 'restaurant','restaurante') AND order.store_type not in list('CO_Vertical-All-CPGs') AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 0 AND order.custom.micro_zone not in list('CO_MZ-Densified') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Densified') AND (address.age.days <30) AND (features.mk_device_distinct_cc_fingerprint_90d >= 4 OR user.segment not in 'Zero' OR features.crosses_add_card_events_other_fingerprint_qty_fingerprints >= 4) return prevent with action('cc_validation_required',{'case_type':'-'}) 'live_horus_restriction_cancel_order_international_new_users_densif_hv' order.store.store_type not contains 'turbo','restaurant' AND order.amount_in_usd >= 35 AND order.amount_in_usd >= 10 AND order.custom.mk_internal_model_scoring_bucket >= 90 AND (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND ((order.store_type in 'restaurant','restaurante' AND device.user_agent not contains 'Grability') OR order.store_type not in 'restaurant','restaurante') AND order.store_type not in list('CO_Vertical-All-CPGs') AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 3 AND (order.custom.micro_zone in list('CO_MZ-Densified') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Densified')) AND ((order.store_type in 'restaurant','restaurante' AND order.amount_in_usd >= 10 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.mk_internal_model_scoring_bucket > 70) OR order.store_type not in 'restaurant','restaurante') AND payment_method.country_code not in 'us','US' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE-HIGH_VALUE'}) 'cancel_order_to_live_horus_restriction_cancel_order_international_new_users_densif' order.amount_in_usd >= 10 AND order.store.store_type not contains 'turbo','restaurant' AND order.custom.mk_internal_model_scoring_bucket >= 90 AND (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND ((order.store_type in 'restaurant','restaurante' AND device.user_agent not contains 'Grability') OR order.store_type not in 'restaurant','restaurante') AND order.store_type not in list('CO_Vertical-All-CPGs') AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 3 AND (order.custom.micro_zone in list('CO_MZ-Densified') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Densified')) AND ((order.store_type in 'restaurant','restaurante' AND order.amount_in_usd >= 10 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.mk_internal_model_scoring_bucket > 70) OR order.store_type not in 'restaurant','restaurante') AND payment_method.country_code not in 'us','US' AND order.store_type not in list('CO_Vertical-ECommerce') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_cancel_order_international_new_users_densif' order.custom.mk_internal_model_scoring_bucket >= 90 AND (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND ((order.store_type in 'restaurant','restaurante' AND device.user_agent not contains 'Grability') OR order.store_type not in 'restaurant','restaurante') AND order.store_type not in list('CO_Vertical-All-CPGs') AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 3 AND (order.custom.micro_zone in list('CO_MZ-Densified') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Densified')) AND ((order.store_type in 'restaurant','restaurante' AND order.amount_in_usd >= 10 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.mk_internal_model_scoring_bucket > 70) OR order.store_type not in 'restaurant','restaurante') AND payment_method.country_code not in 'us','US' AND order.custom.mk_internal_model_scoring_bucket > 92 AND order.amount_in_usd > 11 AND (order.custom.mk_internal_model_scoring_bucket > 96 OR features.mk_device_canceled_by_payment_error_qty_7d > 0.5 OR features.mk_device_canceled_by_payment_error_qty_90d > 2) return prevent with action('cc_validation_required',{'case_type':'-'}) 'restriction_cancel_order_international_new_users_cpgs' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_payer_approved_qty_90d <= 17 AND user.completed_orders < 22 AND order.store_type in list('CO_Vertical-All-CPGs') AND order.custom.mk_internal_model_scoring_bucket >= 30 AND user.customs.account_age < 40 AND features.mk_device_is_safe_device_30d = 0 AND features.mk_fingerprint_is_safe_fingerprint_60d = 0 AND user.segment not in 'Diamond','Potential Diamond','Power','Potential Power' AND (order.custom.mk_internal_model_scoring_bucket >= 80 OR order.amount_in_usd >= 20 OR (features.mk_payer_approved_qty_1d+features.mk_payer_active_orders_qty)>=1) return prevent with action('cc_validation_required',{'case_type':'-'}) 'restriction_cancel_order_international_new_users_ios_rest' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND order.custom.mk_internal_model_scoring_bucket >= 85 AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND order.store_type in 'restaurant','restaurante' AND device.user_agent contains 'Grability' AND ((features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1h) >= 1 OR (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) >= 2 OR (order.is_marketplace = true AND order.store.store_id not in list('Non_fraud_marketplace_rests'))) AND (order.custom.mk_internal_model_scoring_bucket >= 80 OR order.amount_in_usd >= 10) AND features.mk_device_canceled_by_payment_error_qty_7d > 0 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_needs_validation_international_new_users_ios_rest' 1= 0 AND (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND order.store_type in 'restaurant','restaurante' AND device.user_agent contains 'Grability' AND ((features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1h) >= 1 OR (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) >= 2 OR (order.is_marketplace = true AND order.store.store_id not in list('Non_fraud_marketplace_rests'))) AND (order.custom.mk_internal_model_scoring_bucket >= 80 OR order.amount_in_usd >= 10) AND payment_method.country_code not in 'us','US','pe','PE' AND order.custom.mk_internal_model_scoring_bucket > 75 AND order.amount_in_usd > 5 return prevent with action('cc_validation_required',{'case_type':'-'}) 'live_horus_restriction_cancel_order_international_high_bucket_users_cpgs_non_densified_hv' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.mk_internal_model_scoring_bucket > 90 AND order.store_type in list('CO_Vertical-All-CPGs') AND (order.custom.mk_internal_model_scoring_bucket > 92 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_fingerprint_distinct_user_id_90d >= 3 OR features.mk_fingerprint_distinct_device_id_90d >= 3 OR features.mk_device_distinct_cc_fingerprint_90d >= 2 OR features.mk_device_is_safe_device_90d = 0 OR order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') OR features.mk_payer_canceled_by_fraud_qty > 0) AND order.custom.micro_zone not in list('CO_MZ-Densified') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Densified') AND (order.custom.mk_internal_model_scoring_bucket >= 98.5 OR features.mk_device_distinct_cc_fingerprint_90d > 2) AND order.amount_in_usd >= 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE-HIGH_VALUE'}) 'live_horus_restriction_cancel_order_international_high_bucket_users_cpgs_non_densified' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.mk_internal_model_scoring_bucket > 90 AND order.store_type in list('CO_Vertical-All-CPGs') AND (order.custom.mk_internal_model_scoring_bucket > 92 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_fingerprint_distinct_user_id_90d >= 3 OR features.mk_fingerprint_distinct_device_id_90d >= 3 OR features.mk_device_distinct_cc_fingerprint_90d >= 2 OR features.mk_device_is_safe_device_90d = 0 OR order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') OR features.mk_payer_canceled_by_fraud_qty > 0) AND order.custom.micro_zone not in list('CO_MZ-Densified') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Densified') AND (order.custom.mk_internal_model_scoring_bucket >= 98.5 OR features.mk_device_distinct_cc_fingerprint_90d > 2) AND order.amount_in_usd >= 10 AND order.amount_in_usd < 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'restriction_cancel_order_international_high_bucket_users_cpgs_non_densified' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.mk_internal_model_scoring_bucket > 90 AND order.store_type in list('CO_Vertical-All-CPGs') AND (order.custom.mk_internal_model_scoring_bucket > 92 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_fingerprint_distinct_user_id_90d >= 3 OR features.mk_fingerprint_distinct_device_id_90d >= 3 OR features.mk_device_distinct_cc_fingerprint_90d >= 2 OR features.mk_device_is_safe_device_90d = 0 OR order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') OR features.mk_payer_canceled_by_fraud_qty > 0) AND order.custom.micro_zone not in list('CO_MZ-Densified') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Densified') AND (order.custom.mk_internal_model_scoring_bucket >= 98.5 OR features.mk_device_distinct_cc_fingerprint_90d > 2) return prevent with action('cc_validation_required',{'case_type':'-'}) 'restriction_cancel_order_international_high_bucket_users_cpgs_densif_hv' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.mk_internal_model_scoring_bucket > 90 AND order.store_type in list('CO_Vertical-All-CPGs') AND (order.custom.mk_internal_model_scoring_bucket > 92 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_fingerprint_distinct_user_id_90d >= 3 OR features.mk_fingerprint_distinct_device_id_90d >= 3 OR features.mk_device_distinct_cc_fingerprint_90d >= 2 OR features.mk_device_is_safe_device_90d = 0 OR order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') OR features.mk_payer_canceled_by_fraud_qty > 0) AND order.amount_in_usd > 30 AND (order.custom.micro_zone in list('CO_MZ-Densified') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Densified')) AND (features.fake_users_user_email_score<20) AND order.amount_in_usd >= 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return prevent with action('cc_validation_required',{'case_type':'-'}) 'live_horus_restriction_cancel_order_international_high_bucket_users_cpgs_densif' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.mk_internal_model_scoring_bucket > 90 AND order.store_type in list('CO_Vertical-All-CPGs') AND (order.custom.mk_internal_model_scoring_bucket > 92 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_fingerprint_distinct_user_id_90d >= 3 OR features.mk_fingerprint_distinct_device_id_90d >= 3 OR features.mk_device_distinct_cc_fingerprint_90d >= 2 OR features.mk_device_is_safe_device_90d = 0 OR order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') OR features.mk_payer_canceled_by_fraud_qty > 0) AND order.amount_in_usd > 30 AND (order.custom.micro_zone in list('CO_MZ-Densified') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Densified')) AND (features.fake_users_user_email_score<20) AND order.amount_in_usd >= 15 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'restriction_cancel_order_international_high_bucket_users_cpgs_densif' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.mk_internal_model_scoring_bucket > 90 AND order.store_type in list('CO_Vertical-All-CPGs') AND (order.custom.mk_internal_model_scoring_bucket > 92 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_fingerprint_distinct_user_id_90d >= 3 OR features.mk_fingerprint_distinct_device_id_90d >= 3 OR features.mk_device_distinct_cc_fingerprint_90d >= 2 OR features.mk_device_is_safe_device_90d = 0 OR order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') OR features.mk_payer_canceled_by_fraud_qty > 0) AND order.amount_in_usd > 30 AND (order.custom.micro_zone in list('CO_MZ-Densified') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Densified')) AND (features.fake_users_user_email_score<20) return prevent with action('cc_validation_required',{'case_type':'-'}) 'restriction_cancel_order_international_high_bucket_user' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in 'restaurant','restaurante' AND order.store_type not in list('CO_Vertical-All-CPGs') AND (user.maturity not in 'Pro' OR user.segment not in 'Diamond', 'Power') AND order.custom.mk_internal_model_scoring_bucket > 96 return prevent with action('cc_validation_required',{'case_type':'-'}) 'live_horus_restriction_cancel_order_international_risky_products_hv' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND order.items.any { product_name contains list('Global_Risky-Products')} AND payment_method.country_code not in 'us','US' AND order.custom.mk_internal_model_scoring_bucket > 80 AND order.amount_in_usd >= 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE-HIGH_VALUE'}) 'cancel_order_to_live_horus_restriction_cancel_order_international_risky_products' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND order.items.any { product_name contains list('Global_Risky-Products')} AND payment_method.country_code not in 'us','US' AND order.custom.mk_internal_model_scoring_bucket > 80 AND order.amount_in_usd >= 10 AND order.amount_in_usd < 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_cancel_order_international_risky_products' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND order.items.any { product_name contains list('Global_Risky-Products')} AND payment_method.country_code not in 'us','US' AND order.custom.mk_internal_model_scoring_bucket > 70 AND order.amount_in_usd > 9 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_geohash_risk_list' features.mk_payer_mins_since_first_approved_order < 131400 AND payment_method.payment_type in 'credit_card' AND address.geohash_precision7 startswith list('Restricted_Geohash_v3') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_scoring_bucket > 80 AND order.amount_in_usd > 5 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_ato_multiple_orders_login_1d' payment_method.payment_type in 'credit_card' AND device.user_device_age = 0 AND features.user_events_login_1d > 0 AND user.completed_orders > 10 AND device.user_devices_count > 1 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) > 2 AND (order.amount_in_usd >= 25 OR order.store_type in 'ultraservicio') AND (order.custom.mk_internal_model_score < 0.85 OR (order.custom.mk_internal_model_score < 0.89 AND order.store_type in 'restaurant')) return prevent with action('cc_validation_required',{'case_type':'-'}) 'RESTRICTION_Max_Order_Value_Restaurant' order.store_type in 'restaurant' AND (order.custom.totalwithtip + order.custom.discount + order.custom.digital_wallet_amount + order.custom.applied_credits) > 1765000 AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_max_order_value_propio' order.vendor.type in 'propio' AND (order.custom.totalwithtip + order.custom.discount + order.custom.digital_wallet_amount + order.custom.applied_credits) > 706000 AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_fingerprint_velocity' payment_method.payment_type in 'credit_card' AND (user.maturity in 'New','None' OR features.mk_payer_approved_qty_90d < 15) AND (features.mk_fingerprint_approved_qty_1h > 4 OR features.mk_fingerprint_approved_qty_6h > 6 OR features.mk_fingerprint_approved_qty_1d > 8) AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false AND user_id not in list('CO_user_id_companies_many_orders') return block with action('apply_restriction',{'case_type':'cc_validation_required'}) and action('redact_all_cards',{'case_type':'-'}) 'restriction_device_velocity' payment_method.payment_type in 'credit_card' AND (user.maturity in 'New','None' OR features.mk_payer_approved_qty_90d < 15) AND (features.mk_device_approved_qty_1h > 4 OR features.mk_device_approved_qty_6h > 6 OR features.mk_device_approved_qty_1d > 8) AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false AND user_id not in list('CO_user_id_companies_many_orders') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_max_velocity' (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) >= 8 AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false AND user_id not in list('CO_user_id_companies_many_orders') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_hardcap_crosses_device_90d' features.crosses_registration_device_qty_users_90d > 7 AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'restriction_hardcap_crosses_android_30d' features.crosses_registration_device_qty_users_30d > 5 AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false AND device.user_agent not contains 'Grability' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'restriction_hardcap_crosses_android_1d' features.crosses_registration_device_qty_users_1d > 2 AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false AND (payment_method.payment_type in 'cash','rappi_pay','nequi' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND device.user_agent not contains 'Grability' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'restriction_hardcap_crosses_ios_30d' features.crosses_registration_device_qty_users_30d > 5 AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false AND (payment_method.payment_type in 'cash','rappi_pay','nequi' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND device.user_agent contains 'Grability' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'restriction_multiple_cancelations_by_user_int_bin' payment_method.payment_type in 'credit_card' AND payment_method.age.days <15 AND (payment_method.country_code not in 'co','CO' OR (payment_method.country_code in 'co','CO' AND order.custom.mk_internal_model_scoring_bucket >= 91)) AND (features.mk_payer_cc_canceled_by_user_qty_1h >=2 OR features.mk_payer_cc_canceled_by_user_qty_1d>=3 ) AND features.mk_user_is_whitelisted = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'needs_validation_multiple_cancelations_by_user_nac_bin' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND payment_method.age.days < 15 AND payment_method.country_code in 'co','CO' AND (features.mk_payer_cc_canceled_by_user_qty_1h >= 3 OR features.mk_payer_cc_canceled_by_user_qty_1d >= 4) AND (features.mk_payer_canceled_by_user_qty_90d > features.mk_payer_qty_90d*0.4) AND features.mk_user_is_whitelisted = false return prevent with action('cc_validation_required',{'case_type':'-'}) 'live_iva_restriction_hardcap_cancellations' features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (features.mk_payer_canceled_by_user_amount_1d > 140 OR features.mk_payer_canceled_by_user_amount_7d > 200 OR features.mk_payer_canceled_by_user_qty_1d > 4 OR features.mk_payer_canceled_by_user_qty_7d > 6 OR (features.mk_payer_cancel_qty_1h - features.mk_payer_canceled_by_fraud_qty_1h - features.mk_payer_canceled_by_payment_error_qty_1h) > 3 OR (features.mk_payer_cancel_amount_1h - features.mk_payer_canceled_by_fraud_amount_1h - features.mk_payer_canceled_by_payment_error_amount_1h) > 105) AND (features.mk_payer_canceled_by_user_amount_30d / (features.mk_payer_approved_amount_30d + features.mk_payer_canceled_by_user_amount_30d)) >= 0.3 AND order.store_type in list('CO_Vertical-All-Dia-Sin-IVA') return allow with action('manual_review',{'case_type':'HOT_SALE'}) 'restriction_hardcap_cancellations' features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (features.mk_payer_canceled_by_user_amount_1d > 140 OR features.mk_payer_canceled_by_user_amount_7d > 200 OR features.mk_payer_canceled_by_user_qty_1d > 4 OR features.mk_payer_canceled_by_user_qty_7d > 6 OR (features.mk_payer_cancel_qty_1h - features.mk_payer_canceled_by_fraud_qty_1h - features.mk_payer_canceled_by_payment_error_qty_1h) > 3 OR (features.mk_payer_cancel_amount_1h - features.mk_payer_canceled_by_fraud_amount_1h - features.mk_payer_canceled_by_payment_error_amount_1h) > 105) AND (features.mk_payer_canceled_by_user_amount_30d / (features.mk_payer_approved_amount_30d + features.mk_payer_canceled_by_user_amount_30d)) >= 0.3 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_fraud_velocity' features.mk_payer_qty_90d > 0 AND (features.mk_payer_canceled_by_fraud_qty_90d / features.mk_payer_qty_90d) >= 0.9 AND (features.mk_payer_canceled_by_fraud_qty_1h >= 10 OR features.mk_payer_canceled_by_fraud_qty_6h >= 20) AND (user.maturity in 'New','None' OR user.completed_orders < 10) AND order.custom.mk_internal_model_scoring_bucket >= 90 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'RESTRICTION_CANCEL_ORDER_RPCASH_RISKY_USER' order.store_type in 'ultraservicio','ultraservice' AND ((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) >= 15 OR ((features.user_events_add_card_failed_qty_90d+features.mk_payer_canceled_by_payment_error_qty_90d) >= 30 AND (features.mk_payer_cancel_qty_90d / features.mk_payer_approved_qty_90d) > 0.6)) AND order.custom.mk_user_has_freepass = false AND payment_method.verification_status not in 'success','Success' AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 90 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'LIVE_IVA_CANCEL_ORDER_NETWORK_RISK_TECH' payment_method.payment_type in 'credit_card' AND features.mk_user_is_whitelisted = false AND order.custom.mk_internal_model_scoring_bucket >= 90 AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) >= 10 AND order.store_type in list('CO_Vertical-Ecommerce-Tech') AND (order.amount_in_usd > 50 OR payment_method.country_code not in 'co','CO') AND (order.custom.mk_internal_model_scoring_bucket >= 95 OR (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 15) AND order.store_type in list('CO_Vertical-All-Dia-Sin-IVA') return allow with action('manual_review',{'case_type':'HOT_SALE'}) 'CANCEL_ORDER_NETWORK_RISK_TECH' payment_method.payment_type in 'credit_card' AND features.mk_user_is_whitelisted = false AND order.custom.mk_internal_model_scoring_bucket >= 90 AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 15 AND order.store_type in list('CO_Vertical-Ecommerce-Tech') AND (order.amount_in_usd > 50 OR payment_method.country_code not in 'co','CO') AND (order.custom.mk_internal_model_scoring_bucket >= 95 OR (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 20) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_CANCEL_ORDER_RPCASH_JUN_JUL_PROF' order.store_type in 'ultraservicio','ultraservice' AND ((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) >= 12 OR device.user_device_age = 0 OR payment_method.country_code not in 'co','CO' OR order.custom.mk_internal_model_scoring_bucket > 80) AND user.maturity contains 'Pro' AND order.amount_in_usd >= 110 AND order.store.store_id in list('CO_RCash-Forensic-Stores') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'restriction_cash_ops_block' payment_method.payment_type = 'cash' AND 'users_cash_restriction2' in matching_smart_lists return prevent with action('disable_cash',{'case_type':'-'}) 'restriction_prepaid_ops_block' (payment_method.payment_type in 'nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND 'users_prepaid_restriction2' in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'TEST_FREEPASS_USER_AND_DEVICE_SAFE_REGEX_10p' payment_method.payment_type in 'credit_card' AND features.mk_device_is_safe_device_90d = 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 1 AND features.mk_user_global_finished_orders_count_90d > 15 AND features.mk_payer_qty_1d < 1 AND order.amount_in_usd < 50 AND order.custom.mk_internal_model_scoring_bucket < 80 AND user.maturity not in 'New','None','Amateur' AND user.segment in 'Diamond','Potential Diamond','Power','Potential Power' AND features.user_events_add_card_qty_30d < 1 AND (device.user_device_age < user.customs.account_age) AND (regex_strip(order.order_id, '(.)(?!$)') IN '1') return allow 'CANCEL_ORDER_MARTILLEO_UNLOG' (features.mk_payer_cc_canceled_by_fraud_qty_30d >= 20) AND (features.mk_payer_cc_canceled_by_fraud_qty_30d/(features.mk_payer_cc_canceled_by_fraud_qty_30d+features.mk_payer_cc_approved_qty_30d+1))>0.8 AND payment_method.payment_type in 'credit_card' AND (features.mk_user_is_whitelisted = false OR features.mk_device_is_safe_device_60d = 0) AND order.custom.mk_user_has_freepass = false AND features.mk_device_cc_canceled_by_fraud_amount_30d >= 250 return block with action('redact_all_cards',{'case_type':'-'}) and action('cancel_probable_ato',{'case_type':'-'}) 'cancel_order_martilleo' (features.mk_payer_cc_canceled_by_fraud_qty_30d >= 20) AND (features.mk_payer_cc_canceled_by_fraud_qty_30d/(features.mk_payer_cc_canceled_by_fraud_qty_30d+features.mk_payer_cc_approved_qty_30d+1))>0.8 AND payment_method.payment_type in 'credit_card' AND (features.mk_user_is_whitelisted = false OR features.mk_device_is_safe_device_60d = 0) AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_martilleo_7d' (features.mk_payer_cc_canceled_by_fraud_qty_7d >= 15) AND (features.mk_payer_cc_canceled_by_fraud_qty_90d/(features.mk_payer_cc_canceled_by_fraud_qty_90d+features.mk_payer_cc_approved_qty_90d+1))>0.7 AND payment_method.payment_type in 'credit_card' AND (features.mk_user_is_whitelisted = false OR features.mk_device_is_safe_device_60d = 0) AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_MARTILLEO_1D_UNLOG' (features.mk_payer_cc_canceled_by_fraud_qty_1d >= 10) AND (features.mk_payer_cc_canceled_by_fraud_qty_90d/(features.mk_payer_cc_canceled_by_fraud_qty_90d+features.mk_payer_cc_approved_qty_90d+1))>0.6 AND payment_method.payment_type in 'credit_card' AND (features.mk_user_is_whitelisted = false OR features.mk_device_is_safe_device_60d = 0) AND order.custom.mk_user_has_freepass = false AND features.mk_device_cc_canceled_by_fraud_amount_30d >= 100 return block with action('redact_all_cards',{'case_type':'-'}) and action('cancel_probable_ato',{'case_type':'-'}) 'cancel_order_martilleo_1d' (features.mk_payer_cc_canceled_by_fraud_qty_1d >= 10) AND (features.mk_payer_cc_canceled_by_fraud_qty_90d/(features.mk_payer_cc_canceled_by_fraud_qty_90d+features.mk_payer_cc_approved_qty_90d+1))>0.6 AND payment_method.payment_type in 'credit_card' AND (features.mk_user_is_whitelisted = false OR features.mk_device_is_safe_device_60d = 0) AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RISKY_RECENT_GMV' payment_method.payment_type not in 'cash','Cash' AND features.user_events_login_1d > 1 AND features.mk_payer_approved_amount_90d > 50 AND user.customs.account_age > 90 AND order.custom.mk_internal_model_scoring_bucket > 70 AND (features.mk_payer_approved_amount_90d - features.mk_payer_approved_amount_7d) < (features.mk_payer_approved_amount_7d+order.amount_in_usd) AND (features.mk_fingerprint_is_safe_fingerprint_10d = 0 OR features.mk_device_is_safe_device_10d = 0 OR address.age.days <= 7) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_TECH_TURBO_RCASH_RISKY_PROF' (order.store.store_type contains 'turbo' OR order.store_type in list('CO_Vertical-Ecommerce-Tech') OR order.store_type in 'ultraservicio', 'ultraservice') AND (order.custom.mk_internal_model_scoring_bucket > 90 OR (features.mk_payer_approved_amount_1d/(features.mk_payer_approved_amount_90d-features.mk_payer_approved_amount_1d)) > 2) AND ((order.amount_in_usd >= 100 AND order.store_type not in list('CO_Vertical-Ecommerce-Tech')) OR order.amount_in_usd >= 700) AND (order.store.store_type not contains 'turbo' OR order.items.any { product_name contains list('Global_Risky-Products')}) AND ((payment_method.verification_status not in 'success' AND payment_method.country_code not in 'co','CO') OR features.mk_fingerprint_is_safe_fingerprint_10d = 0) AND (((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) >= 20 AND order.amount_in_usd >= 200) OR (features.mk_payer_approved_amount_1d/(features.mk_payer_approved_amount_90d-features.mk_payer_approved_amount_1d)) > 1 OR (features.mk_payer_approved_amount_7d/(features.mk_payer_approved_amount_90d-features.mk_payer_approved_amount_7d)) > 2 OR (features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty) >= 3) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'LIVE_SIN_IVA_CANCEL_ORDER_CANCELLATIONS_ATO' (features.mk_payer_amount_1d/(features.mk_payer_amount_90d-features.mk_payer_amount_1d)) > 1 AND features.mk_payer_canceled_by_user_qty_1d > 0 AND order.amount_in_usd >= 80 AND ((features.mk_payer_amount_90d-features.mk_payer_amount_1d) >= 200 OR features.mk_payer_canceled_by_user_amount_1d >= 200) AND order.store_type in list('CO_Vertical-All-Dia-Sin-IVA') return allow with action('manual_review',{'case_type':'HOT_SALE'}) 'CANCEL_ORDER_CANCELLATIONS_ATO' 1=0 AND (features.mk_payer_amount_1d/(features.mk_payer_amount_90d-features.mk_payer_amount_1d)) > 1 AND features.mk_payer_canceled_by_user_qty_1d > 0 AND order.amount_in_usd >= 80 AND ((features.mk_payer_amount_90d-features.mk_payer_amount_1d) >= 200 OR features.mk_payer_canceled_by_user_amount_1d >= 200) return block with action('cancel_probable_ato',{'case_type':'-'}) and action('communications',{'case_type':'ato_fraud_communication'}) 'RT_FRAUD_WLU_TFP_ABUSE_TURBO' order.store.store_type contains 'turbo' AND payment_method.payment_type = 'cash' AND (features.mk_user_is_whitelisted = true OR order.custom.mk_user_has_freepass = true) AND order.amount > 200000 return prevent with action('disable_cash',{'case_type':'-'}) 'RT_FRAUD_HVU_ABUSE_TURBO' order.store.store_type contains 'turbo' AND payment_method.payment_type = 'cash' AND order.amount > 200000 AND user.segment in 'Diamond','Power','Potential Diamond','Potential Power' AND order.custom.count_devices_user > 2 return prevent with action('disable_cash',{'case_type':'-'}) 'RESTRICTION_NEW_FP_OR_ADDRESS_RISKY_PRODUCTS' order.store_type in list('CO_Vertical-All-CPGs') AND payment_method.payment_type in 'credit_card' AND (payment_method.verification_status not in 'success' OR (features.mk_payer_active_orders_qty+features.mk_payer_approved_qty_1h) > 0) AND (features.mk_payer_fingerprint_mins_since_first_approved_order < 1440 OR amount_in_usd >= 140) AND order.items.any { product_name contains list('Global_Risky-Products')} AND amount_in_usd > 50 AND ( order.custom.mk_internal_model_scoring_bucket > 95 OR amount_in_usd > 100 OR order.custom.different_items_quantity = 1) AND (features.mk_fingerprint_is_safe_fingerprint_10d = 0 OR address.age.days = 0) AND order.custom.different_items_quantity <= 5 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_POSIBLE_ATO_RAPPICASH' order.store_type in 'ultraservicio','ultraservice' AND order.custom.mk_internal_model_scoring_bucket >= 95 AND address.age.days < 1 AND features.mk_payer_storetype_approved_qty_90d < 1 AND features.mk_device_is_safe_device_90d = 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 1 AND user.maturity in 'Pro', 'Semi Pro' AND order.amount_in_usd >= 90 return block with action('communications',{'case_type':'ato_fraud_communication'}) and action('cancel_probable_ato',{'case_type':'-'}) 'CANCEL_ORDER_POSIBLE_ATO_RAPPICASH_VELOCITY' order.store_type in 'ultraservicio','ultraservice' AND address.age.days < 1 AND order.custom.mk_internal_model_scoring_bucket >= 85 AND (features.mk_payer_storetype_approved_qty_90d < (features.mk_payer_storetype_approved_qty_30d + features.mk_payer_active_orders_qty)) AND features.mk_device_is_safe_device_90d = 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 1 AND user.maturity in 'Pro', 'Semi Pro' AND order.amount_in_usd >= 30 return block with action('communications',{'case_type':'ato_fraud_communication'}) and action('cancel_probable_ato',{'case_type':'-'}) 'CANCEL_ORDER_RISKY_AMOUNT_RAPPICASH' order.store_type in 'ultraservicio','ultraservice' AND order.custom.mk_internal_model_scoring_bucket >= 85 AND order.amount_in_usd >= 115 AND (order.custom.mk_internal_model_scoring_bucket > 95 OR features.mk_payer_storetype_approved_qty_90d = 0 OR (features.mk_fingerprint_is_safe_fingerprint_90d = 0 AND payment_method.verification_status not in 'success')) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_ATO_MULTIPLE_SOAT' user.maturity contains 'Pro' AND order.custom.mk_internal_model_scoring_bucket >= 65 AND order.amount_in_usd > 100 AND payment_method.verification_status not in 'success','Success' AND features.mk_payer_storetype_approved_qty_90d > 1 AND features.user_events_login_3d > 0 AND (features.mk_payer_storetype_approved_qty_90d - features.mk_payer_storetype_approved_qty_1d) = 0 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_NEW_USER_LIQUOR_GH_FP' payment_method.payment_type in 'credit_card' AND (user.customs.account_age <= 3 OR user.segment in 'Zero') AND order.amount_in_usd >= 50 AND order.items.any { product_name contains list('Liquor_&_Cigarette_Products')} AND order.custom.different_items_quantity <= 3 AND order.custom.mk_internal_model_scoring_bucket >= 80 AND ('Elegible_Geohash_CBK' in matching_smart_lists OR (features_fs.fs_geohash8_cbk_qty_90d/features_fs.fs_geohash8_approved_qty_90d)>=0.4 OR (features.fake_users_fingerprint_first_name_vowels_ratio = 0 AND features.fake_users_fingerprint_last_name_vowels_ratio = 0) OR payment_method.full_name contains list('Global_payment_method_risky_name') OR order.amount_in_usd >= 100 OR payment_method.verification_status in 'success') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_CANCEL_ORDER_RCASH_CANCEL_BY_USER_BEHAVIOUR_ALERT' order.store_type in 'ultraservicio', 'ultraservice' AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 81 AND order.amount_in_usd > 0 AND user.maturity not in 'Pro','Semi Pro' AND user.segment not in 'Diamond','Power' AND payment_method.age.days <= 3 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0 AND (features.mk_payer_fingerprint_device_approved_qty_90d <= 1 OR features.mk_fingerprint_address_approved_qty_90d <= 1 OR features.mk_payer_address_approved_qty_90d <= 1) AND (features.mk_fingerprint_distinct_device_id_30d >= 1 OR features.mk_fingerprint_distinct_user_id_30d >= 1 OR features.mk_payer_distinct_cc_fingerprint_30d >= 1) AND (features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) >= 1 AND (features.user_events_login_1d >= 2 OR features.user_events_login_7d >= 3 OR features.user_events_login_30d >= 4 OR features.mk_payer_storetype_approved_qty_1d >= 1) AND (features.mk_payer_canceled_by_user_qty_1d >= 1 OR features.mk_payer_canceled_by_user_qty_7d >= 3 OR features.mk_payer_storetype_approved_qty_1d >= 1 OR ((features.mk_payer_canceled_by_user_qty_7d + features.mk_payer_canceled_by_payment_error_qty_7d + features.mk_payer_canceled_by_fraud_qty_7d) > features.mk_payer_approved_qty_7d) OR (features.mk_payer_fingerprint_device_approved_qty_90d <= 5 AND features.mk_payer_distinct_device_id_7d >= 1 AND device.user_device_age <= 7 AND features.user_events_login_7d >= 1 AND (order.amount_in_usd > features.mk_payer_max_approved_amount_90d))) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancellation_rc_max_order_colusion' (payment_method.payment_type in 'cash','nequi','bancolombia' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND (order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type in list('CO_Vertical-Ecommerce-Tech')) AND order.custom.applied_credits >= 100000 AND user.maturity in 'None','New','Amateur' AND features.mk_payer_cancel_qty_7d >= 2 return block with action('cancel_order',{'case_type':'-'}) 'cancel_order_to_live_horus_restriction_cancel_order_international_new_users_cpgs_hv' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_payer_approved_qty_90d <= 17 AND user.completed_orders < 22 AND order.store_type in list('CO_Vertical-All-CPGs') AND order.custom.mk_internal_model_scoring_bucket >= 30 AND user.customs.account_age < 40 AND features.mk_device_is_safe_device_30d = 0 AND features.mk_fingerprint_is_safe_fingerprint_60d = 0 AND user.segment not in 'Diamond','Potential Diamond','Power','Potential Power' AND (order.custom.mk_internal_model_scoring_bucket >= 80 OR order.amount_in_usd >= 20 OR (features.mk_payer_approved_qty_1d+features.mk_payer_active_orders_qty)>=1) AND order.amount_in_usd >= 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'live_horus_restriction_cancel_order_international_new_users_cpgs' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_payer_approved_qty_90d <= 17 AND user.completed_orders < 22 AND order.store_type in list('CO_Vertical-All-CPGs') AND order.custom.mk_internal_model_scoring_bucket >= 30 AND user.customs.account_age < 40 AND features.mk_device_is_safe_device_30d = 0 AND features.mk_fingerprint_is_safe_fingerprint_60d = 0 AND user.segment not in 'Diamond','Potential Diamond','Power','Potential Power' AND (order.custom.mk_internal_model_scoring_bucket >= 80 OR order.amount_in_usd >= 20 OR (features.mk_payer_approved_qty_1d+features.mk_payer_active_orders_qty)>=1) AND order.amount_in_usd >= 10 AND order.amount_in_usd < 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'live_horus_restriction_cancel_order_risky_international_bin_hv' payment_method.country_code in list('Global_Risky-International-BIN-Countries') AND device.user_agent not contains list('CO_Devices-High-End') AND (features.mk_user_is_whitelisted = false AND features.mk_device_is_safe_device_30d = 0) AND order.custom.mk_user_has_freepass = false AND order.amount_in_usd >= 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE-HIGH_VALUE'}) 'live_horus_restriction_cancel_order_risky_international_bin' payment_method.country_code in list('Global_Risky-International-BIN-Countries') AND device.user_agent not contains list('CO_Devices-High-End') AND (features.mk_user_is_whitelisted = false AND features.mk_device_is_safe_device_30d = 0) AND order.custom.mk_user_has_freepass = false AND order.amount_in_usd >= 10 AND order.amount_in_usd < 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'RESTRICTION_cancel_order_risky_international_bin' payment_method.country_code in list('Global_Risky-International-BIN-Countries') AND device.user_agent not contains list('CO_Devices-High-End') AND (features.mk_user_is_whitelisted = false AND features.mk_device_is_safe_device_30d = 0) AND order.custom.mk_user_has_freepass = false AND order.custom.mk_internal_model_scoring_bucket > 85 AND order.amount_in_usd > 10 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_non_risky_order_by_wlu_sd' features.mk_user_is_whitelisted = true AND device.user_agent contains 'Dalvik', 'Grability' AND features.mk_device_is_safe_device_60d = 1 AND ((features.mk_payer_approved_amount_90d > 500 AND ((features.mk_payer_approved_amount_1d/(features.mk_payer_approved_amount_90d-features.mk_payer_approved_amount_1d)) > 0.5 OR (features.mk_payer_approved_amount_7d/(features.mk_payer_approved_amount_90d-features.mk_payer_approved_amount_7d)) > 1.5)) OR features.user_events_add_card_qty_7d >= 10 OR features.user_events_add_card_qty_3d >= 5 OR (features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty) >= 3 OR (features.mk_payer_approved_qty_6h + features.mk_payer_active_orders_qty) >= 6 OR (features.mk_payer_approved_qty_1d + features.mk_payer_active_orders_qty) >= 9) AND ((features.mk_fingerprint_is_safe_fingerprint_10d = 0 AND features.mk_fingerprint_is_safe_fingerprint_60d = 0 AND order.custom.mk_internal_model_scoring_bucket >= 95) OR (address.age.days = 0 AND address.age.seconds > 0)) AND order.custom.mk_internal_model_scoring_bucket >= 90 AND order.amount_in_usd > 8 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'TO_HORUS_MANUAL_REVIEW_NON_RISKY_ORDER_BY_WLU_SD_ECOMMERCE' features.mk_user_is_whitelisted = true AND order.store_type in list('CO_Vertical-All-Ecommerce') AND payment_method.payment_type in 'credit_card' AND ( ( order.store_type in list('CO_Vertical-Ecommerce-Tech') AND order.amount_in_usd >= 300 AND order.custom.mk_internal_model_scoring_bucket >= 81) OR ( order.store_type contains list('CO_Vertical-Ecommerce-HOME') AND order.amount_in_usd >= 55 AND order.custom.mk_internal_model_scoring_bucket >= 96) OR ( order.store_type contains list('CO_Vertical-Ecommerce-SERVICES') AND order.amount_in_usd >= 150 AND order.custom.mk_internal_model_scoring_bucket >= 96) OR ( (order.store_type contains list('CO_Vertical-Ecommerce-FASHION') OR order.store_type contains list('CO_Vertical-Ecommerce-HEALTH_BEAUTY')) AND order.amount_in_usd >= 110 AND order.custom.mk_internal_model_scoring_bucket >= 96) OR (order.amount_in_usd >= 500 AND order.custom.mk_internal_model_scoring_bucket >= 71) ) AND ( (((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_payer_cc_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) OR (user.customs.account_age > 90 AND (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.8) < features.mk_payer_cc_approved_amount_30d)) OR payment_method.age.days < 1) AND ( (((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)) ) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) OR (((features.mk_device_approved_amount_90d / (features.mk_device_approved_qty_90d + 1)) - (features.mk_device_approved_amount_30d / (features.mk_device_approved_qty_30d + 1)) ) < (1 * (features.mk_device_approved_amount_30d / (features.mk_device_approved_qty_30d + 1)))) OR order.custom.mk_internal_model_scoring_bucket >= 98) AND (features.mk_device_distinct_user_id_30d + features.mk_payer_distinct_device_id_30d) >= 2 AND features.mk_payer_distinct_address_id_30d >= 1 AND 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'non_risky_order_by_wlu_sd' features.mk_user_is_whitelisted = true AND device.user_agent contains 'Dalvik', 'Grability' AND features.mk_device_is_safe_device_60d = 1 AND whitelist_entities.responsible not in 'york_landero' AND whitelist_entities.reason not in 'Reactivated','reactivated' AND (order.store_type not in 'ultraservicio', 'ultraservice' OR order.custom.mk_internal_model_scoring_bucket <= 95) AND order.custom.mk_internal_model_scoring_bucket <= 98 AND 'User_cbk_ratio_CO' not in matching_smart_lists return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_wlu_wld' features.mk_user_is_whitelisted = true AND features.device_is_whitelisted = true AND user.power_user_alike_score > 15 AND whitelist_entities.responsible not in 'york_landero' AND whitelist_entities.reason not in 'Reactivated','reactivated' return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_wlrcash_sd' features.mk_user_rappi_cash_is_whitelisted = true AND device.user_agent contains 'Dalvik', 'Grability' AND features.mk_device_is_safe_device_60d = 1 AND user.power_user_alike_score > 15 AND whitelist_entities.responsible not in 'york_landero' AND whitelist_entities.reason not in 'Reactivated','reactivated' return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_wlrcash_wld' features.mk_user_rappi_cash_is_whitelisted = true AND features.device_is_whitelisted = true AND whitelist_entities.responsible not in 'york_landero' AND whitelist_entities.reason not in 'Reactivated','reactivated' return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_tfp' order.custom.mk_user_has_freepass = true AND features.mk_payer_approved_qty_1d < 5 return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_temp_pass' order.store_type in 'eventos_ccc' AND order.amount < 400000 AND features.mk_device_distinct_user_id_90d < 4 return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_fully_paid_prime' 'Elegible_Fully_Paid_Prime_Users' in matching_smart_lists AND payment_method.payment_type not in 'cash' AND features.user_events_login_1d = 0 return allow 'accept_order_by_iphone_11' device.user_agent contains 'Iphone 11', 'IPhone 11', 'Iphone11', 'IPhone11', 'iPhone 11', 'iphone 11', 'iPhone11', 'iPhone11', 'Iphone 12', 'IPhone 12', 'Iphone12', 'IPhone12', 'iPhone 12', 'iphone 12', 'iPhone12', 'iPhone12', 'Iphone 13', 'IPhone 13', 'Iphone13', 'IPhone13', 'iPhone 13', 'iphone 13', 'iPhone13', 'iPhone13' AND order.store_type contains 'restaurant' AND features.mk_device_distinct_user_id_90d = 0 AND order.amount < 300000 AND features.mk_payer_active_orders_qty = 0 AND user.email_domain not in list('CO_Domain-Risk') AND 'fake-email-domains' not in matching_smart_lists AND user.segment <> 'Zero' AND features.mk_payer_approved_qty_90d > 0 AND order.custom.mk_internal_model_scoring_bucket < 96 AND payment_method.age.days > 0 AND payment_method.payment_type not in 'cash', 'Cash' return allow 'accept_order_by_click2rappi' device.user_agent contains 'Java/1.8.0_212' AND order.amount < 150000 return allow 'non_risky_order_by_fp_rest' 1=0 AND order.store_type in 'restaurant','Restaurant' AND payment_method.payment_type not in 'cash', 'Cash' AND order.items.product_name not in list('CO_Items-Liquor-Restaurant-Abusse') AND device.user_agent contains list('CO_Devices-High-End') AND order.store.store_id not in list('CO_CBKs-Stores-id-') AND order.amount < 100000 AND user.email_domain not in list('CO_Domain-Risk') return allow with action('not_risky_user',{'case_type':'-'}) 'TEMPORAL_FREEPASS_MOTHERS_DAY_FLOWERS' 1=0 AND user.maturity not in 'New','None' AND order.store.store_id in list('CO_FLORISTERIAS') AND order.amount_in_usd <= 75 AND order.custom.mk_internal_model_scoring_bucket < 90 AND features.mk_payer_approved_qty_1d <=1 AND features.mk_payer_store_approved_qty_1d <1 return allow 'accept_order_qr' order.store_type in 'rappi_pay_store', 'rappi_pay_my_qr' AND order.custom.micro_zone not in list('CO_Microzone-Risk') AND order.amount < 150000 AND featues.mk_payer_approved_qty_1d < 5 return allow 'accept_order_by_b2b' order.store_type in 'eventos_ccc', 'courier_express' return allow 'accept_order_free_pass' order.store_type in 'activations', 'rappi_livestream' return allow 'non_risky_order_by_dv_&_fp_hr' device.user_agent contains 'Grability', 'Dalvik' AND features.is_safe_device = 1 AND features.is_safe_fingerprint = 1 AND features.mk_payer_qty_1h < 3 AND order.custom.mk_internal_model_scoring_bucket < 71 AND payment_method.age.days > 0 AND 'User_cbk_ratio_CO' not in matching_smart_lists AND address.geohash_precision7 not startswith list('GEOHASH_7_non_risky_order_by_dv_&_fp_hr') return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_dv_&_fp_day' device.user_agent contains 'Grability', 'Dalvik' AND features.is_safe_device = 1 AND features.is_safe_fingerprint = 1 AND features.mk_payer_qty_1d < 5 AND order.store_type not in 'ultraservicio', 'ultraservice' AND order.custom.mk_internal_model_scoring_bucket < 80 AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) < 20 AND order.custom.mk_internal_model_scoring_bucket < 91 AND payment_method.age.days > 0 AND 'GEOHASH_7_non_risky_order_by_dv_fp_day' not in matching_smart_lists return allow with action('not_risky_user',{'case_type':'-'}) 'accept_order_by_rest_cash' payment_method.payment_type in 'cash', 'Cash' AND order.store_type in 'restaurant' AND device.user_agent not contains list('CO_Free-Pass-Restaurant-cash-Does-not-contain-User-agent') AND order.store.store_id not in list('CO_Free-Pass-Restaurant-cash-Does-not-contain-Store-id') AND order.amount > 15000 AND features.mk_device_distinct_user_id_90d <= 2 AND features.mk_payer_approved_qty_90d >= 5 AND features.mk_payer_canceled_by_user_qty < 4 AND order.store.store_id NOT in list('CO_Stores-High-Risk-Cash') AND order.store.store_id NOT in list('CO_Stores-Medium-Risk-Cash') AND user.email_verification_status NOT in 'DENIED','BOUNCED','ERROR' AND features.mk_payer_cash_cancel_qty_7d = 0 return allow 'non_risky_order_by_dv_&_fp_wk' device.user_agent contains 'Grability', 'Dalvik' AND features.is_safe_device = 1 AND features.is_safe_fingerprint = 1 AND features.mk_payer_qty_7d < 8 AND order.custom.mk_internal_model_scoring_bucket < 96 AND payment_method.age.days > 0 AND features.mk_payer_is_safe_cc_user_90d = 1 AND features.mk_payer_cc_canceled_by_fraud_qty_30d < 2 AND 'User_cbk_ratio_CO' not in matching_smart_lists AND 'GEOHASH_7_non_risky_order_by_dv_fp_wk' not in matching_smart_lists return allow with action('not_risky_user',{'case_type':'-'}) 'free_pass_hvu' features.mk_device_distinct_user_id_7d < 2 AND features.mk_payer_approved_qty_1d < 5 AND order.amount < 400000 AND device.user_agent contains list('CO_Devices-High-End') AND (order.custom.micro_zone contains list('CO_MZ-Cuatro-Cinco') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Cuatro-Cinco')) AND order.store_type not in 'ultraservicio' AND user.email_verification_status in 'SENT', 'VERIFIED' AND user.email_domain not in list('CO_Domain-Risk') AND 'fake-email-domains' not in matching_smart_lists AND payment_method.country_code contains 'co', 'CO' AND features.mk_payer_active_orders_qty = 0 AND order.custom.micro_zone not contains list('CO_CBKs-Micro-zone-High-risk') AND payment_method.payment_type not in 'cash', 'Cash' AND (order.store_type not in 'courier_hours' OR order.store_type not in list('CO_Vertical-Ecommerce-Tech') OR order.store_type not in list('CO_Vertical-Ecommerce-HOME')) AND order.custom.mk_internal_model_scoring_bucket < 98 AND ( features.mk_payer_mins_since_first_approved_order > 0 OR (features.mk_payer_mins_since_first_approved_order = 0 AND ((order.store_type not in list('CO_Vertical-Super-and-Hiper') OR order.store_type not in list('CO_Vertical-Super') OR order.store_type not in list('CO_Vertical-Express') OR order.store_type not in list('CO_Vertical-Liquor') OR order.store_type not contains 'restaurant' OR order.store.store_type not contains 'turbo' OR order.store_type not in list('CO_Vertical-Turbo')) OR ((order.store_type in list('CO_Vertical-Super-and-Hiper') OR order.store_type in list('CO_Vertical-Super')) AND order.amount_in_usd <= 37) OR (order.store_type in list('CO_Vertical-Liquor') AND order.amount_in_usd <= 20) OR (order.store_type in list('CO_Vertical-Express') AND order.amount_in_usd <= 16) OR ((order.store.store_type contains 'turbo' OR order.store_type in list('CO_Vertical-Turbo')) AND order.amount_in_usd <= 11) OR (order.store_type contains 'restaurant' AND order.amount_in_usd <= 16)))) AND address.geohash_precision7 not startswith list('GEOHASH_7_FREE_PASS_HVU') return allow 'accept_order_rappicorp' payment_method.payment_type in 'rappicorp', '$rappicorp' AND order.store_type in 'restaurant', 'super', 'hiper', 'express' AND features.mk_device_distinct_user_id_90d < 4 AND order.custom.mk_payer_approved_qty_1d < 5 return allow 'non_risky_order_by_verified_he' user.power_user_alike_score > 70 AND payment_method.verification_status = 'SUCCESS' AND device.user_agent contains list('CO_Devices-High-End') AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND features.mk_device_distinct_user_id_90d < 3 AND payment_method.country_code in 'co','CO' AND order.custom.mk_internal_model_scoring_bucket < 96 AND payment_method.age.days > 0 return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_safe_user' payment_method.payment_type in 'credit_card' AND device.user_agent contains 'Grability' AND user.power_user_alike_score >15 AND features.mk_payer_mins_since_first_approved_order > 129000 AND features.user_events_login_7d < 1 AND features.mk_payer_approved_qty_90d > 10 AND (user.power_user_alike_score < 55 OR (user.power_user_alike_score > 56 AND user.power_user_alike_score < 69) OR user.power_user_alike_score > 71) AND order.custom.mk_internal_model_scoring_bucket < 90 AND (features.mk_payer_approved_qty_30d < 20 OR features.mk_payer_approved_qty_7d <= 10 OR features.mk_device_approved_amount_30d < 2700 OR features.mk_device_approved_amount_1d < 150) AND order.store_type not in 'ultraservicio', 'ultraservice' AND features.mk_payer_cc_canceled_by_user_qty_1d < 3 AND order.custom.mk_internal_model_scoring_bucket < 81 AND payment_method.age.days > 0 return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_diamond' user.segment in 'Potential diamond','Diamond','potential diamond','diamond' AND user.power_user_alike_score >= 30 AND order.custom.user_is_prime = true AND order.store_type not in 'ultraservicio' AND features.mk_payer_mins_since_first_approved_order > 129000 AND user.maturity not in 'New' AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) < 15 AND order.custom.mk_internal_model_scoring_bucket < 86 AND payment_method.age.days > 0 return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_gr_diamond' user.segment in 'Diamond' AND user.power_user_alike_score < 30 AND user.prime = false AND order.store_type not in 'ultraservicio', 'ultraservice', 'restaurant' AND features.is_safe_device = 1 AND features.mk_payer_mins_since_first_approved_order > 129000 return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_power' user.segment in 'Power','Potential power','potential power','power' AND user.power_user_alike_score >= 50 AND order.custom.user_is_prime = true AND order.store_type not in 'ultraservicio' AND features.mk_payer_mins_since_first_approved_order > 129000 AND user.maturity not in 'New','None' AND order.custom.mk_internal_model_scoring_bucket < 96 AND payment_method.age.days > 0 return allow with action('not_risky_user',{'case_type':'-'}) 'non_risky_order_by_velocity_approved' device.user_agent contains list('CO_Devices-High-End') AND user.maturity not in 'New','None','Amateur' AND order.custom.mk_internal_model_scoring_bucket < 20 AND order.store_type not contains 'ultraservice','ultraservicio' AND order.items.any {product_name not in list('Global_Risky-Products')} AND (features.mk_payer_approved_qty_1h < 2 OR features.mk_payer_approved_qty_6h < 3 OR features.mk_payer_approved_qty_12h < 4 OR features.mk_payer_approved_qty_1d < 5) AND features.mk_payer_active_orders_qty = 0 return allow with action('not_risky_user',{'case_type':'-'}) 'accept_order_by_1st_ord_amount' device.user_agent contains list('CO_Devices-High-End') AND order.custom.micro_zone not in list('CO_Safe-Behaviour-First-order-Micro-zones') AND payment_method.payment_type not in 'Cash', 'cash' AND features.mk_payer_mins_since_first_approved_order = 0 AND order.amount < 30000 AND payment_method.card_bin not in list('CO_BIN-Prepaid-Cards') AND features.mk_payer_active_orders_qty = 0 AND order.custom.discount < 20000 AND payment_method.country_code contains 'co','CO' AND user.email_domain not in list('CO_Domain-Risk') AND 'fake-email-domains' not in matching_smart_lists AND user.email_verification_status not in 'BOUNCED','DENIED' AND features.mk_device_distinct_user_id_90d < 3 return allow 'free_pass_finance_type' user.finance_user_type contains 'HQ_RET_HIGH_CHURN' AND user.power_user_alike_score > 70 AND features.mk_payer_approved_qty_1d < 5 AND features.mk_payer_active_orders_qty = 0 AND user.maturity not in 'New','None' AND order.custom.micro_zone not contains list('CO_CBKs-Micro-zone-High-risk') AND user.email_domain not in list('CO_Domain-Risk') AND 'fake-email-domains' not in matching_smart_lists return allow 'non_risky_hqu_dv_mz' order.custom.mk_internal_model_scoring_bucket < 90 AND payment_method.payment_type not in 'cash' AND order.store_type not contains 'ultraservice','ultraservicio' AND device.user_agent contains list('CO_Devices-High-End') AND (order.custom.micro_zone contains list('CO_MZ-Cuatro-Cinco') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Cuatro-Cinco')) AND user.maturity not in 'New','None' AND order.amount < 300000 AND features.mk_fingerprint_is_safe_fingerprint_60d = 1 return allow 'accept_order_low_dv_and_mz' device.user_agent contains list('CO_Devices-Low-CBK') AND order.custom.micro_zone contains list('CO_MZ-Low-CBK') AND features.user_events_login_1h < 2 AND features.mk_payer_approved_qty_1d < 3 AND payment_method.payment_type in 'credit_card' AND (payment_method.country_code contains 'co', 'CO' OR user.maturity in 'Pro', 'Semi Pro') AND order.custom.mk_internal_model_scoring_bucket < 96 AND order.store_type not in 'ultraservicio', 'ultraservice' AND payment_method.age.days > 0 return allow 'accept_order_low_dv_or_mz' ((device.user_agent contains list('CO_Devices-High-End') AND order.custom.micro_zone contains list('CO_MZ-Low-CBK')) OR (device.user_agent contains list('CO_Devices-Low-CBK') AND (order.custom.micro_zone contains list('CO_MZ-Cuatro-Cinco') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Cuatro-Cinco')))) AND user.customs.account_age_in_days > 0 AND device.user_device_age > 0 AND features.user_events_login_1h < 2 AND order.amount < 350000 AND features.mk_payer_approved_qty_1d < 3 AND payment_method.payment_type in 'credit_card' AND payment_method.country_code contains 'co', 'CO' AND order.custom.mk_internal_model_scoring_bucket < 96 AND payment_method.age.days > 0 return allow 'temporary_reactivated_users_free_pass' user_id in list('CO_ReActivated-Users') AND features.user_events_login_1d < 2 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1d) <= 3 AND order.amount_in_usd < 150 AND features.mk_payer_approved_amount_1d < 100 AND order.custom.mk_internal_model_scoring_bucket < 95 AND (order.store_type in 'restaurant' OR order.store_type in list('CO_Vertical-All-CPGs')) return allow 'temporary_reactivated_users_free_pass_sl' 'CO-RCT' in matching_smart_lists AND features.user_events_login_1d < 2 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1d) <= 3 AND order.amount_in_usd < 150 AND features.mk_payer_approved_amount_1d < 100 AND order.custom.mk_internal_model_scoring_bucket < 95 AND (order.store_type in 'restaurant' OR order.store_type in list('CO_Vertical-All-CPGs')) return allow 'temporary_reactivated_users_free_pass_hvu' 'CO_RCT_HVU' in matching_smart_lists AND features.user_events_login_1d < 2 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1d) <= 3 AND order.amount_in_usd < 150 AND features.mk_payer_approved_amount_1d < 100 AND order.custom.mk_internal_model_scoring_bucket < 95 AND (order.store_type in 'restaurant' OR order.store_type in list('CO_Vertical-All-CPGs')) return allow 'temporary_reactivated_users_free_pass_hvu_swl' 'CO_RCT_HVU_SWL' in matching_smart_lists AND features.user_events_login_1d < 2 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1d) <= 3 AND order.amount_in_usd < 150 AND features.mk_payer_approved_amount_1d < 100 AND order.custom.mk_internal_model_scoring_bucket < 95 AND (order.store_type in 'restaurant' OR order.store_type in list('CO_Vertical-All-CPGs')) return allow 'temporary_reactivated_users_dia_sin_iva' user_id in list('DIASINIVA') AND features.user_events_login_1d < 2 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1d) <= 3 AND features.mk_payer_approved_amount_1d < 500 AND order.custom.mk_internal_model_scoring_bucket < 95 AND order.store_type in list('CO_Vertical-All-Dia-Sin-IVA') return allow 'accept_order_rappi4business' order.custom.coupon_code contains list('Global_Rappi4business') return allow 'accept_order_non_risky_ios_rest' device.user_agent contains list('CO_Devices-Low-CBK') AND device.user_agent contains 'Grability' AND order.custom.mk_internal_model_scoring_bucket < 90 AND features.mk_payer_active_orders_qty = 0 AND features.mk_payer_approved_qty_6h < 2 AND order.store_type in 'restaurant','restaurante' AND order.amount_in_usd < 40 AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d) < 5 AND (features.mk_payer_is_safe_user_30d + features.mk_device_is_safe_device_30d + features.mk_fingerprint_is_safe_fingerprint_30d) >= 2 return allow 'accept_order_safe_ios_rest' order.store.store_id in list('CO_Rest-Low-CBK') AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d) < 8 AND features.crosses_registration_device_qty_users_90d < 4 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1h) = 0 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) <= 1 AND payment_method.payment_type in 'credit_card' AND order.amount_in_usd < 25 AND payment_method.country_code in 'co','CO' AND device.user_agent contains 'Grability' AND (features.user_events_add_card_failed_qty_90d+features.mk_payer_canceled_by_payment_error_qty_90d) < 2 return allow 'NON_RISKY_USER_AND_SAFE_DV_&_FP_90D' payment_method.payment_type in 'credit_card' AND features.mk_device_is_safe_device_90d = 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 1 AND features.mk_payer_cc_approved_qty_90d >= 30 AND features.mk_payer_cc_approved_amount_90d >= 300 AND user.customs.account_age > 90 AND order.amount_in_usd < 150 AND 'User_cbk_ratio_CO' not in matching_smart_lists AND address.geohash_precision7 not startswith list('GEOHASH_7_non_risky_user_and_safe_dv_&_fp_90d') return allow 'NON_RISKY_USER_AND_SAFE_DV_&_FP_90D_10X100' payment_method.payment_type in 'credit_card' AND features.mk_device_is_safe_device_90d = 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 1 AND features.mk_payer_cc_approved_qty_90d >= 10 AND features.mk_payer_cc_approved_amount_90d >= 100 AND user.customs.account_age > 30 AND (order.amount_in_usd/features.mk_payer_cc_approved_amount_90d) < 0.5 AND features.user_events_login_1d = 0 AND 'User_cbk_ratio_CO' not in matching_smart_lists AND address.geohash_precision7 not startswith list('GEOHASH_7_non_risky_user_and_safe_dv_&_fp_90d_10x100') AND order.custom.mk_internal_model_scoring_bucket < 96 return allow 'FREEPASS_TOTAL_VALUE_LESS_THAN_5_USD' (payment_method.payment_type not in 'cash','Cash') AND (order.store_type contains 'restaurant' ) AND (address.geohash_precision7 not startswith 'd3fy') AND (features.fake_users_user_email_score < 40 OR user.user_email contains '@privaterelay.appleid.com' ) AND(features.mk_payer_approved_qty_1h<=3) AND(features.mk_payer_approved_qty_1d<=3) AND (features.mk_device_distinct_user_new_1d<=1) AND (features.mk_fingerprint_distinct_user_id_1d <=4) AND (features.crosses_login_device_qty_users_90d<=5) AND (order.amount_in_usd<=5) AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty)<=3 OR features.mk_payer_qty_1h <3 OR features.mk_payer_qty_1d<4) AND (features.mk_payer_store_qty_1d < 2) AND address.geohash_precision8 not startswith list('HIGH_RISK_GEOHASH_8') AND features.mk_payer_qty_1d <=2 AND payment_method.card_bin not in list('CO_BIN-High-Risk') AND (payment_method.country_code in 'co','CO') AND (device.user_agent contains 'Grability','Dalvik') return allow 'FREEPASS_CPGS_TOTAL_VALUE_LESS_THAN_5_USD' (payment_method.payment_type not in 'cash','Cash') AND order.store_type in list('CO_Vertical-All-CPGs') AND (address.geohash_precision7 not startswith 'd3fy') AND (features.fake_users_user_email_score < 40 OR user.user_email contains '@privaterelay.appleid.com' ) AND(features.mk_payer_approved_qty_1h<=3) AND(features.mk_payer_approved_qty_1d<=3) AND (features.mk_device_distinct_user_new_1d<=1) AND (features.mk_fingerprint_distinct_user_id_1d <=4) AND (features.crosses_login_device_qty_users_90d<=5) AND (order.amount_in_usd<=5) AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty)<=3 OR features.mk_payer_qty_1h <3 OR features.mk_payer_qty_1d<4) AND (features.mk_payer_store_qty_1d < 2) AND address.geohash_precision8 not startswith list('HIGH_RISK_GEOHASH_8') AND features.mk_payer_qty_1d <=1 AND payment_method.card_bin not in list('CO_BIN-High-Risk') AND (payment_method.country_code in 'co','CO') AND (device.user_agent contains 'Grability','Dalvik') return allow 'FREEPASS_TOTAL_VALUE_LESS_THAN_10_USD_RESTAURANTS' (payment_method.payment_type not in 'cash','Cash') AND (order.store_type contains 'restaurant' ) AND (payment_method.card_bin in list('BINES_CO_BAJO_RIESGO')) AND (payment_method.country_code in 'co','CO') AND (address.geohash_precision7 not startswith 'd3fy') AND (features.fake_users_user_email_score < 40 OR user.user_email contains '@privaterelay.appleid.com') AND(features.mk_payer_approved_qty_1h<=2) AND(features.mk_payer_approved_qty_1d<=2) AND (features.mk_device_distinct_user_new_1d<=3) AND (features.mk_fingerprint_distinct_user_id_1d <=4) AND (features.crosses_login_device_qty_users_90d<=5) AND (order.amount_in_usd<=10) AND (order.custom.mk_internal_model_scoring_bucket <= 95) AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty)<=3 OR features.mk_payer_qty_1h <3 OR features.mk_payer_qty_1d<4) AND address.geohash_precision8 not startswith list('HIGH_RISK_GEOHASH_8') AND features.mk_payer_qty_1d <=2 AND payment_method.card_bin not in list('CO_BIN-High-Risk') AND (device.user_agent contains 'Grability','Dalvik') return allow 'FREEPASS_TOTAL_VALUE_LESS_THAN_10_USD_NON_REST' (payment_method.payment_type not in 'cash','Cash') AND (order.store_type not contains 'restaurant' ) AND (payment_method.card_bin in list('BINES_CO_BAJO_RIESGO')) AND (payment_method.country_code in 'co','CO') AND (address.geohash_precision7 not startswith 'd3fy') AND (features.fake_users_user_email_score < 40 OR user.user_email contains '@privaterelay.appleid.com') AND(features.mk_payer_approved_qty_1h<=2) AND(features.mk_payer_approved_qty_1d<=2) AND (features.mk_device_distinct_user_new_1d<=3) AND (features.mk_fingerprint_distinct_user_id_1d <=4) AND (features.crosses_login_device_qty_users_90d<=5) AND (order.amount_in_usd<=10) AND (order.custom.mk_internal_model_scoring_bucket <= 95) AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty)<=3 OR features.mk_payer_qty_1h <3 OR features.mk_payer_qty_1d<4) AND address.geohash_precision8 not startswith list('HIGH_RISK_GEOHASH_8') AND features.mk_payer_qty_1d <=1 AND payment_method.card_bin not in list('CO_BIN-High-Risk') AND (device.user_agent contains 'Grability','Dalvik') return allow 'FREEPASS_GLOBAL_PCA_BIN_GEOHASH_PRODUCTS_LOW_RISKY' (order.amount_in_usd <=30) AND (order.custom.mk_internal_model_scoring_bucket < 95) AND (((0.861233)*( user.customs.account_age - (1474.1271))+(0.333940)*( device.user_device_age - (588.6051))+(0.383095)*( address.age.days - (432.4445)))>-1350) AND (features.fake_users_user_email_score < 40 OR user.user_email contains '@privaterelay.appleid.com') AND (features.mk_payer_approved_qty_1h <= 2) AND (features.mk_payer_approved_qty_1d <= 2) AND (features.mk_device_distinct_user_new_1d <= 2)AND (features.mk_fingerprint_distinct_user_id_1d <= 2) AND (features.crosses_login_device_qty_users_90d <= 5) AND (payment_method.payment_type not in 'cash','Cash') AND (order.items.any { product_name NOT contains list('Global_Risky-Products')}) AND (address.geohash_precision7 startswith list('GLOBAL:GEOHASH_LOW_RISK')) AND (features.mk_payer_qty_1d<2)AND (features.mk_payer_store_qty_1d = 0)AND (payment_method.card_bin in list('BINES_CO_BAJO_RIESGO'))AND device.user_agent contains 'Grability','Dalvik' AND (payment_method.country_code in 'co','CO') return allow 'TEMPORAL_FREEPASS_MOTHERS_DAY_CPGS_NU' 1=0 AND order.amount_in_usd > 10 AND order.amount_in_usd <=20 AND order.custom.mk_internal_model_scoring_bucket < 80 AND user.customs.account_age < 15 AND (features.fake_users_user_email_score < -30 OR user.user_email contains '@privaterelay.appleid.com') AND features.mk_payer_approved_qty_1h <= 2 AND features.mk_payer_approved_qty_1d <= 2 AND features.mk_device_distinct_user_new_1d <= 1 AND features.mk_fingerprint_distinct_user_id_1d <= 1 AND features.crosses_login_device_qty_users_90d <= 2 AND payment_method.payment_type not in 'cash','Cash' AND order.items.any { product_name NOT contains list('Global_Risky-Products')} AND address.geohash_precision7 startswith list('GLOBAL:GEOHASH_LOW_RISK') AND order.store_type in list('CO_Vertical-All-CPGs') AND (payment_method.card_bin in list('BINES_CO_BAJO_RIESGO')) AND address.geohash_precision7 not startswith 'd3fy' AND payment_method.country_code in 'co','CO' AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty)<=2 OR features.mk_payer_qty_1h <2 OR features.mk_payer_qty_1d<2) return allow 'TEMPORAL_FREEPASS_MOTHERS_DAY_REST_NU' 1=0 AND order.amount_in_usd > 10 AND order.amount_in_usd <=15 AND order.custom.mk_internal_model_scoring_bucket < 80 AND user.customs.account_age < 15 AND (features.fake_users_user_email_score < -30 OR user.user_email contains '@privaterelay.appleid.com') AND features.mk_payer_approved_qty_1h <= 2 AND features.mk_payer_approved_qty_1d <= 2 AND features.mk_device_distinct_user_new_1d <= 1 AND features.mk_fingerprint_distinct_user_id_1d <= 1 AND features.crosses_login_device_qty_users_90d <= 2 AND payment_method.payment_type not in 'cash','Cash' AND address.geohash_precision7 startswith list('GLOBAL:GEOHASH_LOW_RISK') AND (order.store_type contains 'restaurant' ) AND (payment_method.card_bin in list('BINES_CO_BAJO_RIESGO')) AND address.geohash_precision7 not startswith 'd3fy' AND payment_method.country_code in 'co','CO' AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty)<=2 OR features.mk_payer_qty_1h <2 OR features.mk_payer_qty_1d<2) return allow 'TEMPORAL_FREEPASS_MOTHERS_DAY_REST_OLD_USERS' 1=0 AND order.amount_in_usd > 10 AND order.amount_in_usd <=30 AND order.custom.mk_internal_model_scoring_bucket < 90 AND user.customs.account_age > 15 AND (features.fake_users_user_email_score < 0 OR user.user_email contains '@privaterelay.appleid.com') AND features.mk_payer_approved_qty_1h <= 2 AND features.mk_payer_approved_qty_1d <= 2 AND features.mk_device_distinct_user_new_1d <= 1 AND features.mk_fingerprint_distinct_user_id_1d <= 1 AND features.crosses_login_device_qty_users_90d <= 3 AND payment_method.payment_type not in 'cash','Cash' AND address.geohash_precision7 startswith list('GLOBAL:GEOHASH_LOW_RISK') AND (order.store_type contains 'restaurant' ) AND (payment_method.card_bin in list('BINES_CO_BAJO_RIESGO')) AND address.geohash_precision7 not startswith 'd3fy' AND payment_method.country_code in 'co','CO' AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty)<=2 OR features.mk_payer_qty_1h <2 OR features.mk_payer_qty_1d<2) return allow 'TEMPORAL_FREEPASS_MOTHERS_DAY_CPGS_OLD_USERS' 1=0 AND order.amount_in_usd > 10 AND order.amount_in_usd <=35 AND order.custom.mk_internal_model_scoring_bucket < 80 AND user.customs.account_age > 15 AND (features.fake_users_user_email_score < 0 OR user.user_email contains '@privaterelay.appleid.com') AND features.mk_payer_approved_qty_1h <= 2 AND features.mk_payer_approved_qty_1d <= 2 AND features.mk_device_distinct_user_new_1d <= 1 AND features.mk_fingerprint_distinct_user_id_1d <= 1 AND features.crosses_login_device_qty_users_90d <= 3 AND payment_method.payment_type not in 'cash','Cash' AND order.items.any { product_name NOT contains list('Global_Risky-Products')} AND address.geohash_precision7 startswith list('GLOBAL:GEOHASH_LOW_RISK') AND order.store_type in list('CO_Vertical-All-CPGs') AND (payment_method.card_bin in list('BINES_CO_BAJO_RIESGO')) AND address.geohash_precision7 not startswith 'd3fy' AND payment_method.country_code in 'co','CO' AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty)<=2 OR features.mk_payer_qty_1h <2 OR features.mk_payer_qty_1d<2) return allow 'cancel_order_gift_sent_approved_1d' order.store_type in 'social_gifts' AND payment_method.payment_type = 'credit_card' AND features.gifts_sender_approved_qty_1d > 10 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_gift_sent_canceled_by_fraud_1d' order.store_type in 'social_gifts' AND payment_method.payment_type = 'credit_card' AND features.gifts_sender_canceled_by_fraud_qty_1d > 15 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_gift_recipient_approved_1d' order.store_type in 'social_gifts' AND payment_method.payment_type = 'credit_card' AND features.gifts_recipient_approved_qty_1d > 10 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_gift_recipient_canceled_by_fraud_1d' order.store_type in 'social_gifts' AND payment_method.payment_type = 'credit_card' AND features.gifts_recipient_canceled_by_fraud_qty_1d > 15 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_gift_fingerprint_approved_1d' order.store_type in 'social_gifts' AND payment_method.payment_type = 'credit_card' AND features.gifts_fingerprint_approved_qty_1d > 10 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_gift_fingerprint_canceled_by_fraud_1d' order.store_type in 'social_gifts' AND payment_method.payment_type = 'credit_card' AND features.gifts_fingerprint_canceled_by_fraud_qty_1d > 15 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_ZERO_WEB_PHARMACY' order.store_type contains list('CO_Vertical-Pharmacy') AND order.custom.mk_internal_model_scoring_bucket >= 96 AND (user.maturity in 'None','New' OR user.customs.account_age = 0) AND order.amount_in_usd > 80 AND payment_method.verification_status in 'Success','success' AND payment_method.payment_type in 'credit_card' AND device.user_agent not contains 'Grability','Dalvik' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_non_restaurant' payment_method.payment_type in 'credit_card' AND order.store_type not in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.935 AND order.amount_in_usd < 50 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v2.0' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_non_restaurant_v41' payment_method.payment_type in 'credit_card' AND order.store_type not in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.994 AND order.amount_in_usd < 50 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.1' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_non_restaurant_high_amount' payment_method.payment_type in 'credit_card' AND order.store_type not in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.92 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v2.0' AND order.amount_in_usd >= 50 AND ((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 2 OR user.email_verification_status in 'BOUNCED','DENIED' ) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_non_restaurant_high_amount_v41' payment_method.payment_type in 'credit_card' AND order.store_type not in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.995 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.1' AND order.amount_in_usd >= 50 AND ((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 2 OR user.email_verification_status in 'BOUNCED','DENIED' ) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_restaurant' payment_method.payment_type in 'credit_card' AND order.store_type in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.992 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v2.0' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_restaurant_v41' payment_method.payment_type in 'credit_card' AND order.store_type in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.997 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.1' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_non_restaurant_V43' payment_method.payment_type in 'credit_card' AND order.store_type not in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.914 AND order.amount_in_usd < 50 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.3' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_non_restaurant_V4' payment_method.payment_type in 'credit_card' AND order.store_type not in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.986 AND order.amount_in_usd < 50 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.0' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_non_restaurant_high_amount_V43' payment_method.payment_type in 'credit_card' AND order.store_type not in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.908 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.3' AND order.amount_in_usd >= 50 AND ((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 2 OR user.email_verification_status in 'BOUNCED','DENIED' ) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_non_restaurant_high_amount_V4' payment_method.payment_type in 'credit_card' AND order.store_type not in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.97 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.0' AND order.amount_in_usd >= 50 AND ((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 2 OR user.email_verification_status in 'BOUNCED','DENIED' ) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_restaurant_V43' payment_method.payment_type in 'credit_card' AND order.store_type in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.966 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.3' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_model_restaurant_V4' payment_method.payment_type in 'credit_card' AND order.store_type in 'restaurant','restaurante' AND order.custom.mk_internal_model_score > 0.993 AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.0' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RISK_BIN_MAVERAGE_WEB_ANOMALY' features.mk_user_is_whitelisted = false AND payment_method.payment_type in 'credit_card' AND payment_method.age.days < 7 AND device.user_agent not contains 'Grability', 'Dalvik' AND 'RISK_BIN_MAVG_WEB_CO' in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RISK_INTERNATIONAL_BIN_MAVERAGE_ANOMALY' features.mk_user_is_whitelisted = false AND payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND payment_method.age.days < 7 AND 'RISK_BIN_MAVG_2CO' in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RISK_BIN_MAVERAGE_ANOMALY_REGEX' features.mk_user_is_whitelisted = false AND payment_method.payment_type in 'credit_card' AND payment_method.age.days < 7 AND 'RISK_BIN_MAVG_2CO' in matching_smart_lists AND (regex_strip(order.order_id, '(.)(?!$)') IN '1') return allow 'CANCEL_ORDER_RISK_BIN_MAVERAGE_ANOMALY' features.mk_user_is_whitelisted = false AND payment_method.payment_type in 'credit_card' AND payment_method.age.days < 7 AND 'RISK_BIN_MAVG_2CO' in matching_smart_lists return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_TASA_DEVICE_INTERNATIONAL_BIN_MAR23' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND ((-0.176599)*(payment_method.age.days-(207.1500))+(0.201971)*(device.device_age.days -(436.1000))+(-0.872887)*(address.age.days - (300.0000))) > -558 AND features. mk_device_cancel_qty_1d>3 AND ((features.mk_device_cancel_qty_90d) / (features.mk_device_approved_qty_90d + features.mk_device_cancel_qty_90d)) <= 0.94 AND features.mk_fingerprint_storetype_approved_qty_90d<= 1 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_TASA_GEO_INTERNATIONAL_BIN_MAR23' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND ((-0.176599)*(payment_method.age.days-(207.1500))+(0.201971)*(device.device_age.days -(436.1000))+(-0.872887)*(address.age.days - (300.0000))) > -558 AND features.mk_fingerprint_storetype_cancel_amount_1d<= 13.5 AND (features.mk_geohash_cancel_qty_90d) / (features.mk_geohash_qty_90d) > 0.63 AND device.device_age <= 1.5 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_INTERNATIONAL_BIN_MAR23' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND ((-0.176599)*(payment_method.age.days-(207.1500))+(0.201971)*(device.device_age.days -(436.1000))+(-0.872887)*(address.age.days - (300.0000))) <= -558 AND features.mk_fingerprint_storetype_cancel_amount_1d<= 0.57 AND order.amount_in_usd<= 12.5 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_BIN_INTER_HIGH_AMOUNT_MAR23' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND ((-0.176599)*(payment_method.age.days-(207.1500))+(0.201971)*(device.device_age.days -(436.1000))+(-0.872887)*(address.age.days - (300.0000))) <= -558 AND features.mk_fingerprint_storetype_cancel_amount_1d<= 0.57 AND order.amount_in_usd<= 98 AND features.mk_device_is_safe_device_90d = 0 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'NEEDS_VALIDATION_TASA_DEVICE_INTERNATIONAL_BIN_MAR23' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND ((-0.176599)*(payment_method.age.days-(207.1500))+(0.201971)*(device.device_age.days -(436.1000))+(-0.872887)*(address.age.days - (300.0000))) > -558 AND features. mk_device_cancel_qty_1d>4 AND ((features.mk_device_cancel_qty_90d) / (features.mk_device_approved_qty_90d + features.mk_device_cancel_qty_90d)) <= 0.94 AND order.custom.count_devices_user > 2.5 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_BIN_INTER_HIGH_BUCKET_MAR23' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND ((-0.176599)*(payment_method.age.days - (207.1500))+(0.201971)*(device.device_age.days - (436.1000))+(-0.872887)*(address.age.days - (300.0000))) <= -558 AND features.mk_fingerprint_storetype_cancel_amount_1d<= 0.57 AND order.amount_in_usd<= 12 AND order.custom.mk_internal_model_scoring_bucket > 95.6 return prevent with action('cc_validation_required',{'case_type':'-'}) 'cancel_order_by_acc>10_finished_order>5' features.mk_payer_approved_qty_1d > 5 AND user.customs.account_age_in_days < 10 AND payment_method.payment_type in 'credit_card' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'cc_validation_required'}) 'cancel_order_int_bin_decision_tree_v1' (payment_method.country_code not in 'co','CO') AND (payment_method.payment_type in 'credit_card') AND payment_method.verification_status in 'success','Success' AND features.user_events_qty_tc_failed> 3.5 AND features.user_events_qty_tc_failed> 10 AND order.custom.mk_internal_model_scoring_bucket > 80 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_TECH_RULE1' payment_method.payment_type in 'credit_card' and order.store_type in list('CO_Vertical-Ecommerce-Tech') and (features.mk_device_cc_cancel_amount_90d > 1410 and (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d +features.mk_payer_distinct_device_id_90d) >= 9) AND order.custom.mk_internal_model_scoring_bucket > 80 AND order.amount_in_usd>20 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_TECH_AOM_JUL_2022' payment_method.payment_type in 'credit_card' and order.store_type in list('CO_Vertical-Ecommerce-Tech') AND order.custom.mk_internal_model_scoring_bucket >= 98 AND features.mk_geohash_mins_since_last_approved_transaction>1300 AND features.mk_payer_cc_canceled_by_fraud_amount_30d >130 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_RAPPICASH_RULE1' payment_method.payment_type in 'credit_card' and order.store_type in 'ultraservicio', 'ultraservice' and order.custom.mk_internal_model_score > 0.134 and address.age.days < 29 and ( (features.mk_device_cc_amount_6h > 243.965 and features.mk_payer_cc_amount_90d <= 2769.680) or (features.mk_device_cc_amount_6h <= 243.965 and features.mk_fingerprint_amount_90d <= 631.130 and order.custom.mk_internal_model_score > 0.476 and payment_method.country_code not in list('Global_Risky-International-BIN-Countries') )) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_RAPPICASH_RULE2' payment_method.payment_type in 'credit_card' AND order.store_type in 'ultraservicio', 'ultraservice' AND order.custom.mk_internal_model_score <= 0.134 AND address.age.days < 2 AND features.mk_device_cc_cancel_amount_6h > 108.440 AND user.customs.account_age > 715 AND payment_method.card_bin not in list('CO_BIN-Prepaid-Cards') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_RAPPICASH_AOM_JUL_2022' payment_method.payment_type in 'credit_card' AND order.store_type in 'ultraservicio', 'ultraservice' AND features.mk_fingerprint_address_mins_since_first_approved_order<=150AND ((features.user_events_qty_tc<12 AND user.customs.account_age-device.device_age>1500 AND features.crosses_user_fingerprint_qty_users> 0)OR (features.user_events_qty_tc>=12)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_LIQUOR_RULE1' payment_method.payment_type in 'credit_card' and order.store_type contains list('CO_Vertical-Liquor') and order.custom.mk_internal_model_score > 0.11349 and ((features.mk_device_cc_cancel_amount_6h > 80.52 and order.amount_in_usd <= 129 and order.custom.mk_internal_model_score > 0.49)or (features.mk_device_cc_cancel_amount_6h > 80.52 and order.amount_in_usd > 129)or (features.mk_device_cc_cancel_amount_6h <= 80.52 and order.amount_in_usd > 129 and order.custom.mk_internal_model_score > 0.81)or (order.custom.mk_internal_model_score > 0.004 and order.amount_in_usd >157 and (features.mk_payer_cc_cancel_amount_90d/features.mk_payer_cc_amount_90d) > 0.621)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_RESTAURANTS_RULE2' payment_method.payment_type in 'credit_card' and order.store_type in 'restaurant' and order.custom.mk_internal_model_score > 0.06 and features.mk_device_cc_cancel_amount_90d>207and ( ((features.mk_payer_cc_cancel_amount_90d/features.mk_payer_cc_amount_90d)> 0.342 and features.user_events_login_1d>1) or ((features.mk_fingerprint_cancel_amount_90d/features.mk_fingerprint_amount_90d)>=0.022 and features.user_events_login_1d>1)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_PHARMACY_1' payment_method.payment_type in 'credit_card' and order.store_type in list('CO_Vertical-Pharmacy') and (features.mk_device_cc_cancel_qty_90d/features.mk_device_cc_qty_90d) > 0.636 and features.mk_device_cc_amount_6h > 65 and features.user_events_login_1d >= 1 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_PHARMACY_2' payment_method.payment_type in 'credit_card' and order.store_type in list('CO_Vertical-Pharmacy') and order.custom.mk_internal_model_score > 0.019 and order.amount_in_usd > 250 AND user.segment not in 'Diamond' AND features.mk_user_is_whitelisted = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_SUPER_1' payment_method.payment_type in 'credit_card' and order.store_type in list('CO_Vertical-Super-and-Hiper') and order.custom.mk_internal_model_score >= 0.018 and (( order.amount_in_usd >= 218 and user.maturity not in 'Pro') or (device.device_age>316 and features.user_events_login_1d >= 2 and device.user_agent contains 'Linux' and payment_method.card_bin not in list('CO_BIN-Prepaid-Cards'))) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_DECISION_TREE_CPGS_AOM_JUL_2022' payment_method.payment_type in 'credit_card' AND order.store_type in list('CO_Vertical-All-CPGs') AND 'Elegible_Geohash_CBK' in matching_smart_lists AND (((device.device_age<= 1) AND(payment_method.country_code in 'co','CO') AND (features.user_by_device_events_days_since_first_event<= 1) AND (order.amount_in_usd> 10))OR ((device.device_age>1) AND(order.custom.mk_internal_model_scoring_bucket>= 99) AND(features.mk_payer_mins_since_first_approved_order> 153502)AND(user.customs.account_age-device.device_age> 600))OR((device.device_age> 0.5)AND(order.custom.mk_internal_model_scoring_bucket> 99.5)AND(features.mk_payer_mins_since_first_approved_order> 153502)AND(user.customs.account_age-device.device_age<= 600)AND (custom.different_items_quantity<= 1.5) )) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_INT_DECISION_TREE_P6_DIC22' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND ((user.customs.account_age = 0 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) <= 0.55 AND order.amount_in_usd <= 8.5 AND features.mk_geohash_cc_approved_qty_90d<= 4.5 AND device.user_agent not contains 'Grability' AND features.mk_fingerprint_mins_since_last_approved_transaction <= 42.12) OR (user.customs.account_age = 0 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) <= 0.55 AND order.amount_in_usd <= 8.5 AND features.mk_geohash_cc_approved_qty_90d > 4.5 AND features.crosses_user_fingerprint_qty_users_30d> 0.5 AND features.user_events_qty_tc_7d> 1.5)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_INT_DECISION_TREE_P8_DIC22_REGEX' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND ((user.customs.account_age = 0 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) > 0.55 AND order.amount_in_usd <= 14.39 AND order.custom.items_quantity <= 7.5 AND device.user_agent contains 'Dalvik' > 0.5 AND features.mk_geohash_canceled_by_user_qty_90d <= 3.5 AND features.mk_geohash_approved_amount_90d <= 142.24 AND features.user_by_device_events_days_since_first_event <= 0.12) OR (user.customs.account_age = 0 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) <= 0.55 AND order.amount_in_usd <= 8.5 AND features.mk_geohash_approved_amount_90d<= 457.98 AND device.user_agent not contains 'Grability' AND features.mk_geohash_qty_90d <= 70.5 AND features.mk_geohash_cc_approved_qty_90d <= 1.5 AND features.mk_fingerprint_mins_since_last_approved_transaction<= 897.6083374023438) OR (order.custom.mk_internal_model_scoring_bucket > 97.5 AND order.amount_in_usd <= 11.74 AND user.customs.account_age_in_days = 0 AND features.mk_geohash_cc_approved_amount_90d <= 74.80 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) <= 0.59 AND order.custom.different_items_quantity = 1) OR (order.custom.mk_internal_model_scoring_bucket > 80 AND user.customs.account_age_in_days = 0 AND features.mk_geohash_cc_approved_amount_90d<= 74.80499649047852 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) > 0.59 AND features.mk_device_mins_since_last_transaction<= 18.47 AND features.mk_device_cc_cancel_amount_30d<= 68.08)) AND (regex_strip(order.order_id, '(.)(?!$)') IN '1', '2') return allow 'CANCEL_ORDER_INT_DECISION_TREE_P8_DIC22' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND ((user.customs.account_age = 0 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) > 0.55 AND order.amount_in_usd <= 14.39 AND order.custom.items_quantity <= 7.5 AND device.user_agent contains 'Dalvik' > 0.5 AND features.mk_geohash_canceled_by_user_qty_90d <= 3.5 AND features.mk_geohash_approved_amount_90d <= 142.24 AND features.user_by_device_events_days_since_first_event <= 0.12) OR (user.customs.account_age = 0 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) <= 0.55 AND order.amount_in_usd <= 8.5 AND features.mk_geohash_approved_amount_90d<= 457.98 AND device.user_agent not contains 'Grability' AND features.mk_geohash_qty_90d <= 70.5 AND features.mk_geohash_cc_approved_qty_90d <= 1.5 AND features.mk_fingerprint_mins_since_last_approved_transaction<= 897.6083374023438) OR (order.custom.mk_internal_model_scoring_bucket > 97.5 AND order.amount_in_usd <= 11.74 AND user.customs.account_age_in_days = 0 AND features.mk_geohash_cc_approved_amount_90d <= 74.80 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) <= 0.59 AND order.custom.different_items_quantity = 1) OR (order.custom.mk_internal_model_scoring_bucket > 80 AND user.customs.account_age_in_days = 0 AND features.mk_geohash_cc_approved_amount_90d<= 74.80499649047852 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) > 0.59 AND features.mk_device_mins_since_last_transaction<= 18.47 AND features.mk_device_cc_cancel_amount_30d<= 68.08)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_WHISKY_DECISION_TREE_V1' order.items.any { unified_category_name contains 'whiskey','whisky','Whisky','Whiskey'} AND payment_method.payment_type in 'credit_card' AND ((order.custom.mk_internal_model_scoring_bucket > 99.25 AND features.mk_geohash_cancel_qty_90d> 0.5 AND features.user_events_add_card_failed_qty_90d<= 2.5 AND user.segment not in 'Power' AND order.amount_in_usd <= 113.46600341796875 AND order.custom.items_quantity <= 2.5) OR (order.custom.mk_internal_model_scoring_bucket<= 99.25 AND features.user_events_add_card_qty_90d<= 9.5 AND features.crosses_user_fingerprint_qty_users<= 5.5 AND features.mk_payer_orders_qty<= 673.5 AND features.mk_payer_device_mins_since_first_approved_order<= 1470.7833251953125 AND order.custom.mk_internal_model_scoring_bucket> 86.5) OR (order.custom.mk_internal_model_scoring_bucket<= 99.25 AND features.user_events_add_card_qty_90d> 9.5 AND user.maturity not in 'Pro' AND features.mk_geohash_qty_90d> 2.0 AND order.amount_in_usd > 24.5) OR (order.custom.mk_internal_model_scoring_bucket> 99.25 AND features.mk_geohash_cancel_qty_90d> 0.5 AND features.user_events_add_card_failed_qty_90d<= 2.5 AND user.segment not in 'Power' AND order.amount_in_usd > 113.46600341796875) OR (order.custom.mk_internal_model_scoring_bucket> 99.25 AND features.mk_geohash_cancel_qty_90d> 0.5 AND features.user_events_add_card_failed_qty_90d> 2.5) OR (order.custom.mk_internal_model_scoring_bucket<= 99.25 AND features.user_events_add_card_qty_90d<= 9.5 AND features.crosses_user_fingerprint_qty_users> 5.5 AND order.amount_in_usd> 44.5)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_max_rcash' order.store_type in 'ultraservicio', 'ultraservice' AND device.user_agent not contains list('CO_Devices-High-End') AND features.mk_payer_ultraservicio_approved_qty_1d >= 3 return block with action('communications',{'case_type':'rappi_cash_limit_fraud_communication'}) 'cancel_order_rpcash_new_user' order.store_type in 'ultraservicio', 'ultraservice' AND features.mk_payer_approved_qty_90d < 6 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_by_mz_new_user' 1 = 0 AND order.custom.micro_zone contains list('CO_CBKs-Micro-zone-High-risk') AND order.amount > 20000 AND features.mk_payer_mins_since_first_approved_order <= 43200 AND payment_method.payment_type not contains 'Cash', 'cash' AND device.user_agent not contains list('CO_Devices-High-End') AND user.segment not in 'Diamond', 'Power' AND payment_method.verification_status not in 'success','Success' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_fp_crosses_qty' features.crosses_user_fingerprint_qty_users >= 15 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'blocked'}) 'cancel_multiple_orders_in_progress_liquor' 1 = 0 AND payment_method.payment_type not in 'cash','Cash' AND features.mk_payer_active_orders_qty > 1 AND user.segment not in 'Diamond','Potential Diamond','Power','Potential Power' AND device.user_agent not contains list('CO_Devices-High-End') AND features.mk_payer_approved_qty_90d < 15 AND order.store_type contains list('CO_Vertical-Liquor') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_by_domain_risk' (user.email_domain in list('CO_Domain-Risk') OR 'fake-email-domains' in matching_smart_lists) AND payment_method.payment_type not in 'Cash','cash' AND features.mk_payer_approved_qty_90d < 5 AND order.custom.mk_internal_model_scoring_bucket > 70 AND order.amount_in_usd > 9 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_by_stores_fraud' order.store.store_id in list('CO_CBKs-Stores-id-') AND payment_method.payment_type not in 'Cash','cash' AND features.mk_device_is_safe_device_10d = 0 AND features.user_events_login_7d > 1 AND payment_method.payment_type = 'credit_card' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_by_qty_fraud_error_90d' device.user_agent not contains 'grability','Grability' AND payment_method.payment_type = 'credit_card' AND features.mk_payer_approved_qty_90d <= 1 AND (features.mk_payer_canceled_by_fraud_qty_90d + features.mk_payer_canceled_by_payment_error_qty_90d) >= 10 AND (order.custom.mk_internal_model_scoring_bucket > 95 OR (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d) >= 8) AND order.custom.mk_internal_model_scoring_bucket >= 90 AND(features.mk_payer_cc_canceled_by_fraud_qty_90d > 0.6*features.mk_payer_cc_cancel_qty_90d) AND order.amount_in_usd > 12 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_by_mc_hr' payment_method.payment_type <> 'cash' AND user.power_user_alike_score < 30 AND order.custom.micro_zone contains list('CO_CBKs-Micro-zone-High-risk') AND features.mk_device_is_safe_device_10d = 0 AND features.user_events_login_3d > 2 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_CPGS_IP-GEOHASH_FORENSIC_MAY-JUN' order.store_type contains list ('CO_Vertical-All-CPGs') AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 86 AND (features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_device_is_safe_device_90d = 0) AND features.mk_geohash_qty_7d >= 1 AND (features.mk_payer_distinct_cc_fingerprint_30d + features.mk_device_distinct_user_id_30d + features.mk_payer_distinct_device_id_30d) >= 1 AND (payment_method.age.days <= 35 OR address.age.days <= 40) AND features.mk_payer_mins_since_last_approved_transaction <= 44640 AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21') AND order.amount_in_usd >= 15 AND (address.geohash_precision8 in list('CO_GEOHASH8_TOTAL_FORENSIC_OCT20-JUN21') OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_LIQUOR_FORENSIC' order.store_type contains list('CO_Vertical-Liquor') AND payment_method.payment_type in 'credit_card' AND payment_method.country_code in 'co','CO' AND order.custom.mk_internal_model_scoring_bucket > 85 AND user.customs.account_age >= 30 AND address.age.days <= 1 AND ((features.mk_device_distinct_user_id_30d + features.mk_fingerprint_distinct_user_id_30d + features.mk_fingerprint_distinct_device_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_payer_distinct_device_id_30d + features.user_events_add_card_qty_30d)>=3 OR (features.mk_payer_distinct_store_1d + features.mk_device_distinct_store_id_1d + features.mk_fingerprint_distinct_store_1d)>=4) AND features.mk_payer_mins_since_last_approved_transaction <= 44640 AND device.user_agent contains list('CO_Liquor-Forensic-Devices') AND address.geohash_precision8 in list('CO_Liquor-Forensic-GH8') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RAPPICASH_IP-GEOHASH_FORENSIC_MAY-JUN' order.store_type in 'ultraservicio', 'ultraservice' AND payment_method.payment_type in 'credit_card' AND (order.custom.mk_internal_model_scoring_bucket >= 81 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0) AND user.customs.account_age_in_days >= 40 AND features.mk_payer_mins_since_first_approved_order >= 30 AND features.mk_payer_mins_since_last_approved_transaction <= 30 AND (features.mk_payer_canceled_by_payment_error_qty_90d >= 2 OR features.mk_payer_canceled_by_fraud_qty >= 2) AND order.amount_in_usd >= 100 AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21') AND address.geohash_precision8 in list('CO_GEOHASH8_TOTAL_FORENSIC_OCT20-JUN21') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_rcash_forensic' order.store_type in 'ultraservicio', 'ultraservice' AND payment_method.payment_type in 'credit_card' AND payment_method.country_code in 'co','CO','us','US' AND user.customs.account_age >= 60 AND order.custom.mk_internal_model_scoring_bucket >= 64 AND features.mk_payer_mins_since_first_approved_order >= 86400 AND features.mk_payer_mins_since_last_approved_transaction <= 44640 AND ((features.mk_device_distinct_user_id_30d + features.mk_fingerprint_distinct_user_id_30d + features.mk_fingerprint_distinct_device_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_payer_distinct_device_id_30d + features.user_events_add_card_qty_30d) > 2 OR (features.mk_payer_distinct_store_7d + features.mk_device_distinct_store_id_7d + features.mk_fingerprint_distinct_store_7d) > 2) AND device.user_agent contains list('CO_RCash-Forensic-Devices') AND address.geohash_precision8 in list('CO_RCash-Forensic-GH8') AND order.store.store_id in list('CO_RCash-Forensic-Stores') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RPCASH_JUN_JUL_PROF' order.store_type in 'ultraservicio','ultraservice' AND ((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) >= 15 OR device.user_device_age = 0 OR order.custom.mk_internal_model_scoring_bucket > 95) AND order.amount_in_usd >= 110 AND user.maturity contains 'Pro' AND (order.custom.mk_internal_model_scoring_bucket > 90 OR payment_method.country_code not in 'co','CO') AND order.custom.mk_internal_model_scoring_bucket > 75 AND payment_method.card_bin in list('CO_RCash-Forensic-BIN') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RESTRICTION_CANCEL_ORDER_RPCASH_RISKY_NEW_USER' order.custom.finished_orders_count > 0 AND (user.maturity in 'New','None' OR features.mk_payer_approved_qty_90d < 10) AND order.custom.mk_internal_model_scoring_bucket > 80 AND ((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d) >= 10 OR (order.custom.canceled_orders_count / order.custom.finished_orders_count) > 0.7) AND order.store_type in 'ultraservicio','ultraservice' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_ECOMM_IP_GEOHASH_FORENSIC_MAR-JUL' (((order.store_type in list('CO_Vertical-Ecommerce-Tech') OR order.store_type in list('CO_Vertical-Ecommerce-SERVICES') OR order.store_type in list('CO_Vertical-Ecommerce-FASHION') OR order.store_type in list('CO_Vertical-Ecommerce-HOME') OR order.store_type in list('CO_Vertical-Ecommerce-GIFTS')) AND order.amount_in_usd >= 80) OR ((order.store_type in list('CO_Vertical-Ecommerce-SPORTS_OUTDOORS') OR order.store_type in list('CO_Vertical-Ecommerce-BABIES_KIDS') OR order.store_type in list('CO_Vertical-Ecommerce-HEALTH_BEAUTY') OR order.store_type in list('CO_Vertical-Ecommerce-PETS') OR order.store_type in list('CO_Vertical-Ecommerce-OTHER') OR order.store_type in list('CO_Vertical-Ecommerce-BOOKSTORES_STATIONARY')) AND order.amount_in_usd >= 25)) AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 94 AND features.mk_geohash_qty_7d >= 1 AND ((features.mk_geohash_distinct_cc_fingerprint_approved_7d + features.mk_geohash_distinct_device_id_7d) >= 1 OR features.mk_payer_distinct_device_id_30d >= 1) AND device.ip in list('CO_IP_RISK_ECOMM_FORENSIC_JUL') AND (order.custom.micro_zone in list('CO_MZ_RISK_ECOMM_FORENSIC_JUL') OR address.geohash_precision7 contains list('CO_GEOHASH7_RISK_ECOMM_FORENSIC_JUL')) AND (order.store.store_id in list('CO_ECOMM_RISK-STOREID-LIST_FORENSIC_JUL') OR order.store_type in list('CO_ECOMM_RISK-STORETYPE-LIST_FORENSIC_JUL') OR (features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) <= features.mk_payer_cc_approved_amount_30d) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RT_fraud_rappifavor_velocity' (payment_method.payment_type in 'cash','nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.store_type = 'courier_hours' AND (user.maturity in 'New','None','Amateur' OR user.segment = 'Low Value' OR device.user_devices_count >= 2 OR features.mk_payer_distinct_device_id_90d >= 2 OR device.user_device_age < 7) AND (features.mk_payer_distinct_store_type_7d = 1 OR features.mk_payer_store_cancel_qty_7d >= 1) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'RT_FRAUD_PAY_DNP_MOV' payment_method.payment_type = 'rappi_pay_gateway_wallet' AND order.amount < 8000 AND order.order_type in 'express_picker','market','express' AND user.maturity in 'New', 'None' AND features.fake_users_email_similar_accounts_created_3d > 2 AND (features.mk_user_is_whitelisted = false OR features.device_is_whitelisted = false) AND order.store.store_type NOT contains 'turbo' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_ANOMALY_RISKY_STORE' 'CO_Stores-Risky-Behavior' in matching_smart_lists AND payment_method.payment_type in 'credit_card' AND (order.custom.mk_internal_model_scoring_bucket >= 95 OR (user.customs.account_age_in_days < 2 AND (features.mk_payer_active_orders_qty > 0 OR order.amount_in_usd > 30))) AND order.custom.mk_internal_model_scoring_bucket >= 50 AND user.maturity not contains 'Pro' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_ANOMALY_RISKY_GEOHASH' 'CO_Geohash-Risky-Behavior' in matching_smart_lists AND payment_method.payment_type not in 'cash', 'Cash' AND (order.custom.mk_internal_model_scoring_bucket >= 97 OR (user.customs.account_age_in_days = 0 AND ((features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) > 0 OR order.amount_in_usd > 30))) AND (features.mk_device_is_safe_device_90d = 0 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_payer_cc_approved_qty_90d < 10 OR features.mk_payer_cc_approved_amount_90d < 100) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_MAX_AMOUNT_LIQUOR' order.store_type in list ('CO_Vertical-Liquor') AND features.mk_user_is_whitelisted = false AND payment_method.payment_type in 'credit_card' AND (user.maturity not in 'Pro', 'Semi Pro' OR features.mk_payer_approved_qty_90d <= 5) AND order.amount_in_usd >= 200 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_MAX_AMOUNT_TURBO' order.store_type in list ('CO_Vertical-Turbo') AND payment_method.payment_type in 'credit_card' AND (user.maturity not in 'Pro', 'Semi Pro' OR features.mk_payer_approved_qty_90d < 10) AND (user.segment not in 'Diamond', 'Power' OR features.mk_payer_approved_qty_90d < 10) AND order.amount_in_usd >= 95 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_ANOMALY_KILLER_TIP_AC' 1=0 AND 'CO_TIP_FAKE_USERS' in matching_smart_lists AND (payment_method.payment_type in 'nequi','rappi_pay','bancolombia' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false AND user.segment not in 'Power','Diamond' AND device.user_agent not contains list('Global_Devices_iOS-High-End') return allow 'DNP_TIP_PREPAID_NEW_USER' 1=0 AND user.completed_orders = 0 AND ((payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND (features.mk_fingerprint_approved_qty_others_30d > 2 OR features.mk_fingerprint_distinct_user_id_30d >2)) OR (payment_method.payment_type in 'rappi_pay' AND features.mk_payer_store_qty_1h >= 1)) AND user.customs.account_age_in_hours < 5 AND device.user_agent not contains list('Global_Devices_iOS-High-End') AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_CPGS_SEPT_PROF' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 98 AND order.store_type in list('CO_Vertical-All-CPGs') AND (payment_method.verification_status not in 'success' OR payment_method.card_bin in list('CO_CPGs-2ndScore-BIN')) AND order.custom.different_items_quantity <= 5 AND features.user_events_add_card_qty_1d > 0 AND order.items.any { product_name contains list('Global_Risky-Products')} AND ((features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) >= 15 OR order.amount_in_usd > features.mk_payer_approved_amount_90d OR (order.custom.mk_internal_model_scoring_bucket = 100 AND order.custom.different_items_quantity <= 2)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_CPGS_STORE_ATTACK' 'CO_CPGs-Store-Under-Attack' in matching_smart_lists AND (user.customs.account_age < 40 OR order.custom.mk_internal_model_scoring_bucket >= 95) AND order.items.any { product_name contains list('Global_Risky-Products')} AND order.amount_in_usd > 5 AND payment_method.payment_type = 'credit_card' AND (features.mk_device_is_safe_device_90d = 0 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_payer_cc_approved_qty_90d < 10 OR features.mk_payer_cc_approved_amount_90d < 100) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_VELOCITY' payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket > 80 AND (((user.customs.account_age < 30 OR user.maturity in 'New','None' OR user.segment in 'Zero' OR features.mk_payer_approved_qty_90d < 2 OR order.custom.mk_internal_model_scoring_bucket > 95) AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty) >= 3 OR (features.mk_payer_approved_qty_12h + features.mk_payer_active_orders_qty) >= 4 OR (features.mk_payer_approved_qty_1d + features.mk_payer_active_orders_qty) >= 5)) OR ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty) >= 4 OR (features.mk_payer_approved_qty_12h + features.mk_payer_active_orders_qty) >= 5 OR (features.mk_payer_approved_qty_1d + features.mk_payer_active_orders_qty) >= 6)) AND user_id not in list('CO_user_id_companies_many_orders') AND user.segment not in 'Diamond','Power' AND user.maturity not in 'Pro' AND features.mk_user_is_whitelisted = false AND (order.custom.mk_internal_model_scoring_bucket > 95 OR features.crosses_user_fingerprint_qty_users > 1) AND (features.mk_device_is_safe_device_90d = 0 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_payer_cc_approved_qty_90d < 10 OR features.mk_payer_cc_approved_amount_90d < 100) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RAPPICASH_IP_GEO7_OCT' order.store_type in 'ultraservicio','ultraservice' AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 61 AND order.amount_in_usd >= 55 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 30 AND features.mk_payer_distinct_cc_fingerprint_approved_30d >= 1 AND (features.mk_device_distinct_user_id_30d + features.mk_payer_distinct_device_id_30d) >= 1 AND (((features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) > 0 AND features.mk_payer_distinct_cc_fingerprint_approved_30d >= 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0) OR ((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d OR (user.customs.account_age > 90 AND (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d)) OR ((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) AND features.mk_payer_cc_approved_qty_90d > 5)) AND (((address.geohash_precision7 contains list('CO_GEOHASH7_TOTAL_FORENSIC_OCT20-JUN21') OR 'CO_Geohash-Risky-Behavior' in matching_smart_lists) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) OR ( order.custom.mk_internal_model_scoring_bucket >= 86 AND order.amount_in_usd >= 110 AND payment_method.age.days <= 6 AND address.age.days <= 30 AND device.user_device_age <= 30 AND features.mk_fingerprint_is_safe_fingerprint_60d = 0 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 15 AND features.mk_payer_fingerprint_device_approved_amount_90d <= 200 AND features.mk_geohash_cc_approved_qty_90d <= 30 AND (((features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) > 0 AND features.mk_payer_distinct_cc_fingerprint_approved_30d >= 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0) OR ((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) AND features.mk_payer_cc_approved_qty_90d > 5) OR (user.customs.account_age > 90 AND (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d))))) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_soat_bin_401093' order.store_type in 'Soat','SOAT','soat','soat_webview' AND payment_method.card_bin in '401093' AND payment_method.payment_type in 'credit_card' AND order.amount_in_usd >140 AND order.custom.mk_internal_model_scoring_bucket > 93 AND (user.maturity not in 'Pro', 'Semi Pro' OR features.mk_payer_store_qty_1d >= 1) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_soat_high_bucket_new_users' (order.store_type in 'Soat','SOAT','soat','soat_webview' )AND (payment_method.payment_type in 'credit_card' )AND(order.amount_in_usd >100) AND (user.maturity in 'None','New','Amateur') AND (order.custom.mk_internal_model_scoring_bucket >= 99) AND (features.crosses_add_card_events_other_fingerprint_qty_fingerprints>1 OR features.user_events_qty_tc >=4 OR features.mk_payer_store_qty_1d > 0) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_FRAUD_SOAT-WEB_OCT' order.store_type contains 'Soat','soat','soat_webview' AND payment_method.payment_type in 'credit_card' AND ((device.user_agent not contains 'Grability' AND payment_method.age.days <= 5 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 3 AND (features.user_by_device_events_is_known_device_for_login = 0 OR features.mk_device_is_safe_device_90d = 0)) OR (device.user_agent contains 'Grability' AND payment_method.age.days <= 60 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 10 AND features.user_by_device_events_is_known_device_for_login = 0)) AND order.custom.mk_internal_model_scoring_bucket >= 86 AND order.amount_in_usd >= 82 AND (features.user_by_device_events_is_known_device_for_login = 0 OR features.mk_device_is_safe_device_90d = 0) AND address.age.days <= 15 AND device.user_device_age <= 15 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0 AND features.mk_payer_is_safe_user_cc_90d = 0 AND (features.user_events_add_card_qty_7d - features.user_events_add_card_failed_qty_7d) >= 1 AND ((address.geohash_precision7 contains list('CO_GEOHASH7_RISK_ECOMM_FORENSIC_JUL') OR 'CO_Geohash-Risky-Behavior' in matching_smart_lists) OR ((address.geohash_precision7 startswith list('CO_GEOHASH5_ECOMM_FORENSIC_OCT') OR 'CO_Geohash-Risky-Behavior' in matching_smart_lists) AND features.mk_geohash_cc_approved_qty_90d <= 5 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 3 AND order.custom.mk_internal_model_scoring_bucket >= 99 AND payment_method.age.days <= 1 AND address.age.days <= 1 AND device.user_device_age <= 1 AND features.mk_fingerprint_is_safe_fingerprint_60d = 0 AND (features.mk_device_is_safe_device_60d = 0 OR features.user_by_device_events_is_known_device_for_login = 0) AND features.mk_device_cc_approved_amount_90d <= 350 AND features.mk_fingerprint_approved_amount_90d <= 350 AND features.mk_payer_cc_approved_amount_90d <= 350 AND features.mk_payer_mins_since_first_approved_order <= 1 AND features.mk_payer_mins_since_last_approved_transaction <= 1 AND order.amount_in_usd >= 120 )) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_SOAT_NEW_HIGH_BUCKET' order.custom.mk_internal_model_scoring_bucket >= 99 AND order.store_type in 'soat','soat_webview' AND order.amount_in_usd >= 100 AND (user.customs.account_age = 0 OR user.segment = 'Zero' OR order.custom.mk_internal_model_scoring_bucket = 100) AND payment_method.card_bin in '483101','401093','411759','539238','512645','483161','409744','530372' AND features.mk_geohash_qty_1h > 0 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_CPGS_DEC_JAN_PROF' (order.store_type in 'turbo' OR order.store_type in list('CO_Vertical-All-CPGs')) AND user.segment not in 'Diamond','Power' AND user.maturity not in 'Pro' AND (order.custom.different_items_quantity < 5 AND order.amount_in_usd > 50) AND order.custom.different_items_quantity < 15 AND(payment_method.verification_status not in 'success' OR payment_method.card_bin in '483101','428261','438857','428392','518664','530691','455986','434258','427088','434257','483312','527515','442549') AND order.amount_in_usd > 15 AND order.custom.mk_internal_model_scoring_bucket >= 90 AND order.items.any { product_name contains list('Global_Risky-Products')} AND ((user.segment in 'Zero' AND order.custom.different_items_quantity = 1 AND order.custom.mk_internal_model_scoring_bucket >= 97) OR (order.custom.mk_internal_model_scoring_bucket >= 98 AND order.custom.different_items_quantity = 1 AND (features.mk_fingerprint_is_safe_fingerprint_10d = 0 OR address.age.days = 0) AND (features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty) > 0) OR (order.amount_in_usd > 65 AND order.custom.different_items_quantity <= 2 AND (features.mk_fingerprint_is_safe_fingerprint_10d = 0 OR address.age.days = 0) AND order.custom.mk_internal_model_scoring_bucket > 95) OR (order.store_type not in list('CO_Vertical-Super-and-Hiper') AND order.custom.different_items_quantity < 3 AND(features.mk_fingerprint_is_safe_fingerprint_10d = 0 OR address.age.days = 0) AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty) > 0 OR features.mk_device_active_orders_qty > 0 OR features.mk_fingerprint_active_orders_qty > 0 OR order.amount_in_usd > 75))) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_TCI_IP_GEO8_FORENSIC_MAR2022_REGEX_FEB23' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND (order.store_type contains 'restaurant' OR order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type in list('CO_Vertical-All-Ecommerce') OR order.store_type in 'ultraservicio', 'ultraservice' ) AND order.custom.mk_internal_model_scoring_bucket >= 96 AND (payment_method.age.days <= 1 OR (((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) OR (user.customs.account_age > 90 AND (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d))) AND (features.mk_payer_fingerprint_device_approved_qty_90d <= 10 OR features.mk_fingerprint_address_approved_qty_90d <= 7) AND (features.mk_device_distinct_user_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_device_distinct_address_id_30d + features.mk_device_distinct_store_type_1d) >= 3 AND (features.mk_payer_distinct_address_id_7d + features.mk_fingerprint_distinct_address_id_7d + features.mk_device_distinct_address_id_7d) >= 2 AND order.amount_in_usd >= 6 AND (features.mk_payer_mins_since_first_approved_order > 0 OR (features.mk_payer_mins_since_first_approved_order = 0 AND order.amount_in_usd > 12 AND order.custom.mk_internal_model_scoring_bucket >= 86)) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21') AND (address.geohash_precision8 in list('CO_GEOHASH8_TOTAL_FORENSIC_OCT20-JUN21') OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) AND (regex_strip(order.order_id, '(.)(?!$)') IN '1', '2') return allow 'CANCEL_ORDER_TCI_IP_GEO8_FORENSIC_MAR2022' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND (order.store_type contains 'restaurant' OR order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type in list('CO_Vertical-All-Ecommerce') OR order.store_type in 'ultraservicio', 'ultraservice' ) AND order.custom.mk_internal_model_scoring_bucket >= 96 AND (payment_method.age.days <= 1 OR (((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) OR (user.customs.account_age > 90 AND (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d))) AND (features.mk_payer_fingerprint_device_approved_qty_90d <= 10 OR features.mk_fingerprint_address_approved_qty_90d <= 7) AND (features.mk_device_distinct_user_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_device_distinct_address_id_30d + features.mk_device_distinct_store_type_1d) >= 3 AND (features.mk_payer_distinct_address_id_7d + features.mk_fingerprint_distinct_address_id_7d + features.mk_device_distinct_address_id_7d) >= 2 AND order.amount_in_usd >= 6 AND (features.mk_payer_mins_since_first_approved_order > 0 OR (features.mk_payer_mins_since_first_approved_order = 0 AND order.amount_in_usd > 12 AND order.custom.mk_internal_model_scoring_bucket >= 86)) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21') AND (address.geohash_precision8 in list('CO_GEOHASH8_TOTAL_FORENSIC_OCT20-JUN21') OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RAPPIFAVOR_BLOCK_NEW_FRAUD_USERS' order.store_type in 'courier_hours' AND user.customs.account_age < 5 AND (features.fake_users_user_agent_similar_accounts_created_3d > 2 OR features.fake_users_email_similar_accounts_created_3d > 2 OR user.email_verification_status in 'BOUNCED' OR address.geohash_precision7 startswith list ('CO_Geohash-RFavor-RT-Fraud')) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RAPPIFAVOR_NEW_FRAUD_USERS' order.store_type in 'courier_hours' AND payment_method.payment_type in 'rappi_pay_gateway_wallet','apple_pay' AND user.customs.account_age <= 1 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_SERVICES_FORENSIC_JUN-2022' order.store_type in list('CO_Vertical-Ecommerce-SERVICES') AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 99 AND order.amount_in_usd >= 160 AND user.maturity in 'None','New','Amateur' AND ( payment_method.age.days <= 1 OR (((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) OR order.custom.mk_internal_model_scoring_bucket = 100 OR (payment_method.age.days > 1 AND (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d))) AND features.mk_payer_fingerprint_device_approved_qty_90d <= 4 AND features.mk_fingerprint_address_approved_qty_90d <= 3 AND features.mk_device_mins_since_last_approved_transaction <= 120 AND (features.mk_payer_distinct_cc_fingerprint_30d >= 1 OR (order.custom.mk_internal_model_scoring_bucket = 100 AND features.mk_payer_fingerprint_device_approved_qty_90d < 1 AND user.customs.account_age <= 1)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_TECH_FORENSIC_JUN-2022' order.store_type in list('CO_Vertical-Ecommerce-Tech') AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 96 AND order.amount_in_usd >= 300 AND payment_method.age.days <= 2 AND (features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_payer_is_safe_user_cc_90d = 0) AND ( (((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) OR (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d) OR ((features.mk_payer_canceled_by_user_qty_7d + features.mk_payer_canceled_by_payment_error_qty_7d + features.mk_payer_canceled_by_fraud_qty_7d) > features.mk_payer_approved_qty_7d) ) AND (features.mk_payer_distinct_address_id_30d + features.mk_payer_distinct_store_type_1d + features.mk_payer_distinct_device_id_30d + features.mk_payer_distinct_store_1d + features.mk_payer_distinct_cc_fingerprint_30d) >= 4 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 3 AND features.mk_fingerprint_address_approved_qty_90d <= 1 AND (features.user_events_add_card_qty_7d - features.user_events_add_card_failed_qty_7d) >= 1 AND (features.mk_device_distinct_user_id_30d >= 1 OR features.mk_payer_distinct_device_id_30d >= 1) AND (features.mk_payer_distinct_cc_fingerprint_30d >= 1 OR order.custom.mk_internal_model_scoring_bucket = 100) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_TECH_new_user_high_value' payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 95 AND order.amount_in_usd > 1000 AND order.store_type in list('CO_Vertical-Ecommerce-Tech') AND user.maturity in 'None','New','Amateur' AND features.crosses_registration_device_qty_users_90d>= 3 AND features.user_events_login_90d >= 3 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RPRODUCT_US_USER' payment_method.payment_type in 'credit_card' AND payment_method.country_code in 'US','us' AND user.customs.account_age = 0 AND order.custom.mk_internal_model_scoring_bucket > 90 AND order.custom.different_items_quantity <= 3 AND (order.custom.mk_internal_model_scoring_bucket > 95 OR user.email_verification_status in 'BOUNCED','DENIED' OR device.user_agent not contains list('Global_Devices_iOS-Low-CBK-Ratio')) AND order.items.any { unified_category_name contains list('Global_Risky_Category_Products')} return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_NEW_LIQ_OR_CIGRR' payment_method.payment_type in 'credit_card' AND order.store.store_type contains 'turbo','express_picker','market','express' AND order.custom.mk_internal_model_scoring_bucket >= 97 AND order.items.any{product_name contains list('Liquor_&_Cigarette_Products')} AND order.amount_in_usd > 20 AND user.maturity in 'New','None' AND device.user_agent not contains list('Global_Devices_iOS-Low-CBK-Ratio') AND features.mk_payer_approved_qty_1d <= 1 AND order.custom.different_items_quantity <= 5 AND (order.custom.mk_internal_model_scoring_bucket = 100 OR order.custom.different_items_quantity = 1 OR (order.custom.different_items_quantity <= 3 AND order.amount_in_usd > 30)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_ECOMMERCE_PDIAMOND_MAT_NEW' payment_method.payment_type in 'credit_card' AND (order.store_type in list('CO_Vertical-Ecommerce-Tech') OR order.store_type in list('CO_Vertical-Turbo') OR order.store_type in list('CO_Vertical-Pharmacy') OR order.store_type in list('CO_Vertical-Ecommerce-FASHION')) AND ((order.store_type in list('CO_Vertical-Turbo') OR order.store_type in list('CO_Vertical-Pharmacy')) AND order.items.any { unified_category_name contains list('Global_Risky_Category_Products')} AND order.custom.different_items_quantity <= 3) AND order.custom.mk_internal_model_scoring_bucket > 95 AND user.segment in 'Potential Diamond' AND user.maturity in 'New','None' AND order.amount_in_usd >= 50 AND user.customs.account_age < 10 AND device.user_agent not contains list('CO_Devices-High-End') AND (order.amount_in_usd >= 80 OR order.custom.mk_internal_model_scoring_bucket > 97 OR features.mk_payer_approved_qty_1d > 0) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_NEW_BOUNCED_USER_RPRODUCT' payment_method.payment_type in 'credit_card' AND order.store.store_type contains 'turbo','express_picker','market','express' AND order.custom.mk_internal_model_scoring_bucket >= 95 AND order.items.any{product_name contains list('Liquor_&_Cigarette_Products')} AND order.amount_in_usd > 15 AND user.maturity in 'New','None' AND device.user_agent not contains list('Global_Devices_iOS-Low-CBK-Ratio') AND features.mk_payer_approved_qty_1d <= 1 AND order.custom.different_items_quantity < 10 AND user.email_verification_status in 'BOUNCED','DENIED' AND (payment_method.country_code in 'us','US' OR (order.custom.different_items_quantity < 5 AND order.amount_in_usd > 50)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_SOAT_ATTACK' order.store_type in 'Soat','SOAT','soat','soat_webview' AND order.custom.mk_internal_model_scoring_bucket >= 92 AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) >= 8 AND features.mk_payer_storetype_approved_qty_7d >= 1 AND (features.mk_payer_approved_qty_30d <= 28 OR features.mk_device_approved_qty_30d <= 28) AND features.mk_payer_distinct_cc_fingerprint_30d > 0 AND features.mk_payer_distinct_device_id_30d > 0 AND features.mk_device_distinct_user_id_30d > 0 AND features.mk_device_is_safe_device_30d = 0 AND features.mk_fingerprint_is_safe_fingerprint_30d = 1 AND (user.customs.account_age > 90 OR device.user_device_age >= 1) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_WHISKY_ZERO_USER' payment_method.payment_type in 'credit_card' AND order.custom.different_items_quantity <= 8 AND order.custom.mk_internal_model_scoring_bucket >= 85 AND order.amount_in_usd >= 10 AND (user.customs.account_age = 0 OR order.custom.mk_internal_model_scoring_bucket > 95) AND user.maturity not contains 'Pro' AND (features.mk_device_cc_qty_1d >= 4 OR payment_method.verification_status in 'success', 'Success') AND order.items.any { unified_category_name contains 'whiskey','whisky','Whisky','Whiskey'} return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_fraud_whisky_x_value_80' order.store_type in list('CO_Vertical-All-CPGs') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status in 'success', 'Success' AND order.custom.mk_internal_model_scoring_bucket >= 98 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0 AND order.custom.different_items_quantity <= 8 AND user.maturity in 'New','None' AND order.items.any { unified_category_name contains list('Liquor_&_Cigarette_Products')} AND order.amount_in_usd >= 80 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_fraud_whisky_x_value_60' order.store_type in list('CO_Vertical-All-CPGs') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status in 'success', 'Success' AND order.custom.mk_internal_model_scoring_bucket >= 94 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0 AND order.custom.different_items_quantity <= 8 AND user.maturity in 'New','None' AND order.items.any { unified_category_name contains list('Liquor_&_Cigarette_Products')} AND order.amount_in_usd >= 60 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_FRAUD_NEW_POT_DIAMOND_CPGS_TURBO' payment_method.payment_type in 'credit_card' AND order.store_type in list ('CO_Vertical-Turbo') AND order.custom.mk_internal_model_scoring_bucket >= 75 AND order.amount_in_usd >= 20 AND user.maturity in 'None','New', 'Amateur' AND ((payment_method.verification_status in 'success', 'Success' AND user.maturity in 'New','None' AND (user.segment in 'Potential Diamond' OR (user.segment in 'Zero' AND features.mk_payer_approved_amount_90d >= 30)) AND order.custom.mk_internal_model_scoring_bucket >= 98 AND features.crosses_add_card_events_other_fingerprint_qty_fingerprints >=1) OR (user.email_verification_status in 'BOUNCED' AND order.custom.mk_internal_model_scoring_bucket >= 87 AND user.customs.account_age = 0 AND features.user_events_add_card_qty_1d >= 1)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RCASH_FORENSIC_NOV2022_FS' order.store_type in 'ultraservicio', 'ultraservice' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status in 'success', 'Success' AND order.custom.mk_internal_model_scoring_bucket >= 80 AND order.amount_in_usd >= 65 AND payment_method.age.days <= 90 AND (((features.mk_device_approved_amount_90d / (features.mk_device_approved_qty_90d + 1)) - (features.mk_device_approved_amount_30d / (features.mk_device_approved_qty_30d + 1))) < (1 * (features.mk_device_approved_amount_30d / (features.mk_device_approved_qty_30d + 1)))) AND (payment_method.card_franchise contains 'american_express' OR (features.mk_fingerprint_is_safe_fingerprint_90d = 0 AND order.custom.mk_internal_model_scoring_bucket >= 91 AND payment_method.age.days <= 60 AND (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d))) AND (features.mk_device_distinct_user_id_30d + features.mk_fingerprint_distinct_user_id_30d + features.mk_fingerprint_distinct_device_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_payer_distinct_device_id_30d + features.mk_payer_distinct_cc_fingerprint_30d) >= 6 AND (features.mk_payer_distinct_address_id_30d + features.mk_fingerprint_distinct_address_id_30d + features.mk_device_distinct_address_id_30d) >= 3 AND (((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0 OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) OR device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_SOAT_FORENSIC_NOV2022_FS' order.store_type contains 'Soat','SOAT','soat','soat_webview' AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 80 AND order.amount_in_usd >= 92 AND (features.mk_payer_fingerprint_device_approved_qty_90d <= 1 OR features.mk_fingerprint_address_approved_qty_90d <= 2) AND features.mk_fingerprint_approved_qty_90d <= 6 AND (((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1))) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) AND features.mk_device_mins_since_last_approved_transaction <= 1920 AND (user.customs.account_age <= 1 OR (user.customs.account_age > 1 AND user.customs.account_age < 300 AND features.mk_payer_cc_approved_qty_30d <= 3) OR (user.customs.account_age >= 300 AND features.mk_payer_cc_approved_qty_90d <= 10)) AND user.maturity not in 'Pro' AND user.segment not in 'Diamond' AND (((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0 OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) OR ((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0 OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) AND order.custom.mk_internal_model_scoring_bucket >= 98)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RAPPI_PAY_HIGH_CBK' payment_method.payment_type in 'rappi_pay','rappi_pay_gateway_wallet' AND device.user_agent contains 'Grability' AND order.amount_in_usd >= 20 AND user.customs.account_age > 60 AND user.segment in 'Diamond','Potential Diamond' AND (features.mk_payer_distinct_device_id_30d >0 OR features.mk_device_distinct_user_id_30d >0) AND (device.user_devices_count >1 OR features.user_events_add_card_qty_7d > 1 OR features.user_events_add_card_qty_30d > 2) AND (address.age.days < 30 OR device.user_device_age < 30 OR features.mk_geohash_canceled_by_fraud_qty_30d > 0 OR features.user_events_login_3d > 0) AND ((features_fs.fs_geohash7_cbk_qty_30d/features_fs.fs_geohash7_approved_qty_30d) >= 0.3 OR features.user_by_device_events_days_since_first_event < 30) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_SOAT_FORENSIC_FEB2023_FS' payment_method.payment_type in 'credit_card' AND order.store_type contains 'Soat','SOAT','soat','soat_webview','Soat web view Bogot' AND ((order.custom.mk_internal_model_scoring_bucket >= 70 AND order.amount_in_usd >= 75) OR (order.custom.mk_internal_model_scoring_bucket >= 86 AND order.amount_in_usd >= 55) OR order.amount_in_usd >= 150 ) AND (payment_method.age.days <= 15 OR features.mk_fingerprint_approved_qty_90d <= 1) AND (device.user_device_age <= 1 OR address.age.days <= 1) AND user.maturity not in 'Pro','Semi Pro' AND user.segment not in 'Diamond','Power' AND features.mk_payer_fingerprint_device_approved_qty_90d <= 3 AND (features.mk_fingerprint_address_approved_qty_90d <= 1 OR features.mk_payer_address_approved_qty_90d <= 1) AND (features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) >= 1 AND features.mk_payer_storetype_approved_qty_30d <= 5 AND (user.social_provider contains 'twilio','whatsapp' OR order.custom.mk_internal_model_scoring_bucket >= 99) AND (features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_device_is_safe_device_90d = 0) AND ((((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_payer_cc_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) OR ((features.mk_payer_canceled_by_user_qty_7d + features.mk_payer_canceled_by_payment_error_qty_7d + features.mk_payer_canceled_by_fraud_qty_7d) > features.mk_payer_approved_qty_7d) OR payment_method.age.days < 1 ) AND (((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0) AND (device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21'))) OR (((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0) OR (device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21'))) AND payment_method.age.days < 1 AND address.age.days < 1 AND device.user_device_age < 1 AND order.custom.mk_internal_model_scoring_bucket >= 97 AND features.mk_payer_fingerprint_device_approved_qty_90d < 1 AND features.mk_device_approved_qty_90d < 1 AND features.mk_geohash_cc_approved_qty_90d < 1 AND features.mk_payer_storetype_approved_qty_30d < 1 AND (features.mk_payer_distinct_address_id_7d >= 1 OR features.mk_payer_distinct_address_id_30d >= 2) AND features.user_by_device_events_is_known_device_for_login = 0 AND (order.custom.user_is_prime not in true OR user.prime = false) AND order.amount_in_usd >= 200)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_E-COMMERCE_GEOHASH_7_CHANGE_DEVICE_AND_CARD_MAR2023' order.store_type in list('CO_Vertical-All-Ecommerce') AND payment_method.payment_type in 'credit_card' AND order.amount_in_usd > 10 AND order.custom.mk_internal_model_scoring_bucket > 80 AND user.customs.account_age > 100 AND payment_method.age.days < 27 AND features.mk_payer_distinct_device_id_7d > 0 AND address.geohash_precision7 contains list('CO_GEOHASH_7_ECOMMERCE_MAR23') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_CPGS_BIN_CHANGE_CARD_WHISKYS_MAR2023' order.store_type in list('CO_Vertical-All-CPGs') AND payment_method.payment_type in 'credit_card' AND order.amount_in_usd > 22 AND order.custom.mk_internal_model_scoring_bucket > 79 AND user.customs.account_age > 250 AND payment_method.age.days < 7AND payment_method.card_bin in list('CO_BIN_HIGH_RISK_WHISKYS_MAR23') AND order.items.any {item_id in list ('CO_HIGH_RISK_WHISKYS_MAR23')} return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_TECH_TCI_FORENSIC_MAR2023' order.store_type in list('CO_Vertical-Ecommerce-Tech') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status in 'success', 'Success' AND payment_method.country_code not in 'co','CO' AND (payment_method.age.days <= 3 OR order.custom.mk_internal_model_scoring_bucket >= 97) AND (address.age.days <= 1 OR user.customs.account_age_in_days <= 1) AND order.amount_in_usd >= 80 AND order.custom.mk_internal_model_scoring_bucket >= 90 AND ((features.mk_payer_fingerprint_device_approved_qty_90d <= 5 AND features.mk_payer_distinct_device_id_7d >= 1 AND device.user_device_age <= 7 AND (features.user_events_login_7d >= 1 OR features.user_by_device_events_is_known_device_for_login = 0) AND (order.amount_in_usd > features.mk_payer_max_approved_amount_90d) AND (features.mk_payer_distinct_address_id_30d >= 2 OR features.mk_fingerprint_address_approved_qty_90d <= 2)) OR (features.mk_device_distinct_user_id_30d + features.mk_fingerprint_distinct_user_id_30d + features.mk_fingerprint_distinct_device_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_payer_distinct_device_id_30d + features.mk_payer_distinct_cc_fingerprint_30d) >= 6) AND (features.mk_payer_canceled_by_fraud_qty_7d >= 1 OR features.mk_payer_canceled_by_user_qty_7d >= 1 OR order.custom.mk_internal_model_scoring_bucket >= 97) AND (((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) OR ((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0 OR device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) AND order.custom.mk_internal_model_scoring_bucket >= 95)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_LIQUORS-IOS_FORENSIC_MAR2023' (order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type in list('CO_Vertical-Turbo')) AND payment_method.payment_type in 'credit_card' AND (payment_method.verification_status in 'success','Success' OR payment_method.verification_status not in 'success','Success') AND user.customs.account_age_in_days >= 120 AND payment_method.age.days <= 30 AND order.custom.mk_internal_model_scoring_bucket >= 87 AND (order.amount_in_usd >= 15 OR order.custom.mk_internal_model_scoring_bucket >= 94) AND ( order.items.any { unified_category_name contains 'whiskys','whiskey','whiskeys','Whiskey','cerveza','cervezas','Cerveza','tequila','tequilas','rones','aguardiente','Equipos mdicos','Equipos medicos','equipos mdicos','equipos medicos' } OR order.custom.mk_internal_model_scoring_bucket >= 94) AND ( device.user_agent contains 'Grability' OR order.custom.mk_internal_model_scoring_bucket >= 94) AND ( user.segment not in 'Diamond','Power' OR order.custom.mk_internal_model_scoring_bucket >= 94) AND features.mk_payer_fingerprint_device_approved_qty_90d <= 2 AND features.mk_fingerprint_address_approved_qty_90d <= 1 AND features.mk_payer_distinct_address_id_7d >= 1 AND (((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) OR ((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0 OR device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) AND order.custom.mk_internal_model_scoring_bucket >= 97 AND payment_method.age.days < 1 AND address.age.days < 4 AND features.mk_payer_fingerprint_device_approved_qty_90d < 1 AND (((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1))) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) AND order.amount_in_usd >= 100)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'cc_validation_required'}) 'CANCEL_ORDER_TECH_FORENSIC_HIGH_BUCKET_&_CANCELED_ABR2023' payment_method.payment_type in 'credit_card' AND (payment_method.verification_status in 'success','Success' OR payment_method.verification_status not in 'success','Success') AND order.store_type in list('CO_Vertical-Ecommerce-Tech') AND order.custom.mk_internal_model_scoring_bucket >= 91 AND address.age.days <= 30 AND order.amount_in_usd >= 100 AND ((features.mk_device_distinct_user_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_device_distinct_address_id_30d + features.mk_device_distinct_store_type_1d ) >= 8 OR (features.mk_device_distinct_user_id_30d + features.mk_fingerprint_distinct_user_id_30d + features.mk_fingerprint_distinct_device_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_payer_distinct_device_id_30d + features.mk_payer_distinct_cc_fingerprint_30d) >= 10 ) AND((((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_payer_cc_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) OR (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.75) < features.mk_payer_cc_approved_amount_30d)) AND ( features.user_events_login_7d >= 2 OR (((features.mk_payer_canceled_by_user_qty_7d + features.mk_payer_cc_canceled_by_fraud_qty_7d) > features.mk_payer_cc_approved_qty_7d) AND features.mk_payer_cc_approved_qty_7d > 0)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_CPGS_FORENSIC_HIGH_BUCKET_ABR2023_FS' (order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type in list('CO_Vertical-Turbo')) AND payment_method.payment_type in 'credit_card' AND (payment_method.verification_status in 'success','Success' OR payment_method.verification_status not in 'success','Success') AND ((order.custom.mk_internal_model_scoring_bucket >= 99 AND order.amount_in_usd >= 100) OR (payment_method.age.days <= 1 AND order.custom.mk_internal_model_scoring_bucket >= 91 AND order.amount_in_usd >= 70)) AND (features.mk_fingerprint_address_approved_qty_90d <= 1 OR features.mk_payer_address_approved_qty_90d <= 1) AND (((features.mk_payer_cc_approved_amount_90d / (features.mk_payer_cc_approved_qty_90d + 1)) - (features.mk_payer_cc_approved_amount_30d / (features.mk_payer_cc_approved_qty_30d + 1))) < (1 * (features.mk_payer_cc_approved_amount_30d / (features.mk_payer_cc_approved_qty_30d + 1)))) AND (features.mk_payer_distinct_address_id_7d >= 1 OR features.mk_payer_distinct_address_id_30d >= 2) AND ((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0) OR ((((features.mk_device_approved_amount_90d / (features.mk_device_approved_qty_90d + 1)) - (features.mk_device_approved_amount_30d / (features.mk_device_approved_qty_30d + 1))) < (1 * (features.mk_device_approved_amount_30d / (features.mk_device_approved_qty_30d + 1)))) AND (features.mk_payer_distinct_address_id_7d > 1 OR features.mk_payer_distinct_address_id_30d > 2) AND address.age.days <= 3 AND device.user_device_age <= 7 AND order.amount_in_usd >= 200)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_CBK_USERS_GREATER_THAN_5_PER_100_ABR2023' 'User_cbk_ratio_CO' in matching_smart_lists AND (payment_method.verification_status not in 'success','Success' OR payment_method.verification_status in 'success','Success') AND (( payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 71 AND payment_method.age.days <= 30 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 5) OR ( payment_method.payment_type in 'paypal','apple_pay','google_pay' AND (((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_payer_cc_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) AND features.mk_payer_address_approved_qty_90d <= 5)) AND order.amount_in_usd >= 10 AND features.mk_payer_mins_since_first_approved_order > 0 AND (user.customs.account_age <= 3 OR address.age.days <= 30 OR device.user_device_age <= 30) AND ((features_fs.fs_geohash7_cbk_qty_120d > 0 OR features_fs.fs_geohash7_cbk_user_qty_120d > 0) OR ((((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1))) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) AND order.amount_in_usd >= 15 AND (address.age.days <= 1 OR device.user_device_age <= 1))) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_TURBO_ALERT_LOW_AMOUNT' payment_method.payment_type in 'credit_card' AND payment_method.verification_status in 'success','Success' AND (order.store.store_type contains 'turbo' OR order.store_type contains 'restaurant' OR order.store_type in list('CO_Vertical-All-CPGs')) AND (user.maturity not in 'Pro','Semi Pro' OR order.custom.mk_internal_model_scoring_bucket >= 97) AND (user.segment not in 'Diamond','Power' OR order.custom.mk_internal_model_scoring_bucket >= 97) AND payment_method.age.days <= 7 AND order.amount_in_usd >= 2 AND order.amount_in_usd <= 10 AND order.custom.mk_internal_model_scoring_bucket >= 81 AND features.mk_payer_distinct_address_id_7d >= 1 AND (address.age.days <= 15 OR device.user_device_age <= 40) AND (address.geohash_precision7 startswith list('CO_Geohash6_fraud_Turbo_bajos_montos') OR ( payment_method.card_bin in '409355' AND order.custom.mk_internal_model_scoring_bucket >= 89 AND payment_method.age.days < 1)) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'cc_validation_required'}) 'CANCEL_ORDER_TCI_MAY2023_DV' payment_method.payment_type in 'credit_card' AND (payment_method.verification_status in 'success','Success' OR payment_method.verification_status not in 'success','Success' ) AND payment_method.country_code not in 'CO','co' AND (user.segment not in 'Diamond' OR order.custom.mk_internal_model_scoring_bucket >= 99) AND 'DEVICE_cbk_CO' in matching_smart_lists AND payment_method.age.days <= 120 AND order.amount_in_usd >= 3 AND features.mk_user_is_whitelisted = false AND ((order.items.any { unified_category_name contains 'whiskys','whiskey','whiskeys','Whiskey','cerveza','cervezas','Cerveza','tequila','tequilas','rones','aguardiente','vodka' } AND order.custom.mk_internal_model_scoring_bucket >= 61) OR ((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0) AND order.custom.mk_internal_model_scoring_bucket >= 86)) AND (device.user_device_age <= 60 OR address.age.days <= 30) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_LIQUORS_EGGS_MAY23' payment_method.payment_type in 'credit_card','paypal','apple_pay','google_pay' AND order.items.any { unified_category_name contains list('Global_Risky_Category_Products')} AND order.custom.mk_internal_model_scoring_bucket > 75.25 AND features.user_events_add_card_qty_7d > 1 AND features.crosses_add_card_events_other_fingerprint_qty_fingerprints_30d > 1 AND features.crosses_add_card_events_other_fingerprint_qty_fingerprints_failed > 0 AND (features.mk_geohash_cancel_qty_90d > 0.15*features.mk_geohash_qty_90d) AND order.amount_in_usd > 4 AND features.mk_fingerprint_amount_90d > 3.5 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_ECOMMERCE_TECH_RISK_GEOHASH_MAY23' payment_method.payment_type in 'credit_card','paypal','apple_pay','google_pay' AND order.store_type in list('CO_Vertical-Ecommerce-Tech') AND features.mk_payer_amount_1d > 120.019 AND (features.mk_geohash_cancel_qty_90d > 0.1538*features.mk_geohash_qty_90d) AND order.custom.mk_internal_model_score > 0.6045 AND order.amount_in_usd > 54 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_RISK_BINS_PRODUCTS_DV' payment_method.payment_type in 'credit_card' AND ((payment_method.card_bin in list('CO_BIN_ANOMALY_JEAN_2023') OR 'BIN_cbk_ratio_CO_2' in matching_smart_lists OR payment_method.card_bin in list('CO_BIN-Attact-Risk') OR 'CO_BINES_CBK_BAJA_TRANSACCIONALIDAD' in matching_smart_lists) OR (order.custom.mk_internal_model_scoring_bucket >= 98 AND order.amount_in_usd >= 15 AND (((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_payer_cc_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) AND payment_method.age.days < 1 AND device.user_device_age < 1 AND address.age.days < 1 )) AND payment_method.card_bin not in '-99999' AND order.custom.mk_internal_model_scoring_bucket >= 85 AND payment_method.age.days <= 3 AND (user.segment not in 'Diamond' OR order.custom.mk_internal_model_scoring_bucket >= 98) AND (device.user_device_age <= 3 OR address.age.days <= 3) AND (features.mk_payer_fingerprint_device_approved_qty_90d <= 2 OR features.mk_fingerprint_address_approved_qty_90d <= 2 OR features.mk_payer_address_approved_qty_90d <= 2 ) AND (((device.device_id in list('CO_DEVICE_ID_CBK_TOTAL_1') OR device.device_id in list('CO_DEVICE_ID_CBK_TOTAL_2') OR device.device_id in list('CO_DEVICE_ID_CBK_TOTAL_3')) AND order.amount_in_usd >= 3) OR ((((features_fs.fs_geohash7_cbk_qty_120d > 0 OR features_fs.fs_geohash7_cbk_user_qty_120d > 0) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21') AND order.amount_in_usd >= 6 ) OR ((order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type contains 'restaurant') AND order.amount_in_usd >= 10 AND order.items.any { unified_category_name contains 'whiskys','whiskey','whiskeys','Whiskey','tequila','tequilas','rones','aguardiente','vodka' } ) OR ( order.store_type in list('CO_Vertical-All-CPGs') AND order.amount_in_usd >= 4 AND order.items.any { unified_category_name contains 'cerveza','cervezas','Cerveza' } )) AND order.custom.mk_internal_model_scoring_bucket >= 98 AND (((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1))) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))))) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) and action('apply_restriction',{'case_type':'cc_validation_required'}) 'TO_HORUS_live_ecommerce_high_value' user.maturity in 'New','None', 'Amateur' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND device.user_agent not contains list('CO_Devices-High-End') AND payment_method.payment_type in 'credit_card','nequi','rappipay' AND features.is_safe_device = 0 AND order.store_type in list('CO_Vertical-Ecommerce-Tech') AND order.amount_in_usd >= 160 AND payment_method.verification_status in 'success','Success' return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'live_2ndscore_ecommerce' payment_method.payment_type = 'credit_card' AND payment_method.verification_status in 'success', 'Success' AND order.store.store_id in list ('CO_ECommerce-2ndScore-Stores') AND payment_method.card_bin in list('CO_ECommerce-2ndScore-BIN') AND order.custom.micro_zone contains list('CO_ECommerce-2ndScore-MZ') AND order.custom.mk_internal_model_scoring_bucket > 70 AND order.amount > 350000 AND features.mk_device_qty_90d >= 2 return allow with action('manual_review',{'case_type':'MARKET_LIVE'}) 'live_2ndscore_rest' payment_method.payment_type = 'credit_card' AND payment_method.verification_status in 'success', 'Success' AND order.store.store_id in list ('CO_Rest-2ndScore-Stores') AND payment_method.card_bin in list('CO_Rest-2ndScore-BIN') AND order.custom.micro_zone contains list('CO_Rest-2ndScore-MZ') AND order.custom.mk_internal_model_scoring_bucket > 70 AND (order.amount + order.custom.discount) > 35000 AND device.user_device_age <= 30 AND 1= 0 return allow with action('manual_review',{'case_type':'MARKET_LIVE'}) 'live_2ndscore_cpgs' 1=0 AND payment_method.payment_type = 'credit_card' AND payment_method.verification_status in 'success', 'Success' AND order.store.store_id in list ('CO_CPGs-2ndScore-Stores') AND payment_method.card_bin in list('CO_CPGs-2ndScore-BIN') AND order.custom.micro_zone contains list('CO_CPGs-2ndScore-MZ') AND order.custom.mk_internal_model_scoring_bucket > 70 AND order.amount > 90000 return allow with action('manual_review',{'case_type':'MARKET_LIVE'}) 'TO_HORUS_live_ato_high_amount_1d' device.user_device_age = 0 AND features.user_events_login_1d > 0 AND device.user_devices_count > 1 AND user.maturity not in 'New','None' AND ((order.amount_in_usd > 100 AND order.items.any{product_name contains list('Global_Risky-Products')}) OR (order.amount_in_usd > 80 AND order.store_type in 'restaurant')) AND order.store_type not in list('CO_Vertical-Super-and-Hiper') AND payment_method.country_code in 'co','CO' AND features.mk_payer_approved_qty_90d > 15 AND payment_method.payment_type not in 'cash','Cash' return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'TO_HORUS_live_ato_multiple_orders_login_1d' device.user_device_age = 0 AND features.user_events_login_1d > 0 AND user.maturity not in 'New','None' AND device.user_devices_count > 1 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) = 2 AND (order.amount_in_usd >= 25 OR order.store_type in 'ultraservicio') AND payment_method.country_code in 'co','CO' AND features.mk_payer_approved_qty_90d > 15 AND payment_method.payment_type not in 'cash','Cash' return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'live_coupon_abuse_cigar_liquor' payment_method.payment_type not in 'cash','Cash' AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.coupon_code not in 'null' AND (order.custom.discount / order.amount) > 2 AND user.maturity in 'New','None' AND (order.items.any{category in 'Cigarros','Cerveza','Whisky'} OR order.items.any{brand contains 'Marlboro','Pall Mall','Chesterfield','Benson&hedges','Rothmans'}) AND order.custom.discount > 17650 return allow with action('manual_review',{'case_type':'MARKET_LIVE'}) 'live_scheduled_liquor' payment_method.payment_type = 'credit_card' AND order.store_type in list('CO_Vertical-Liquor') AND order.custom.mk_internal_model_score > 0.5 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v1.1' AND order.status = 'scheduled' AND payment_method.payment_type not in 'cash','Cash' return allow with action('manual_review',{'case_type':'MARKET_LIVE'}) 'live_scheduled_super' payment_method.payment_type = 'credit_card' AND order.store_type in list('CO_Vertical-Super-and-Hiper') AND order.custom.mk_internal_model_score > 0.5 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v1.1' AND order.status = 'scheduled' AND payment_method.payment_type not in 'cash','Cash' return allow with action('manual_review',{'case_type':'MARKET_LIVE'}) 'TO_HORUS_live_scheduled_ecomm' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.7 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v2.0' AND order.store_type not in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND order.status = 'scheduled' AND order.store_type in list('CO_Vertical-Ecommerce-Tech') AND payment_method.payment_type not in 'cash','Cash' return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'live_scheduled_other' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.7 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v2.0' AND order.store_type not in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND order.status = 'scheduled' AND payment_method.payment_type not in 'cash','Cash' AND user.segment not in 'Diamond','Power','Potential Diamond' AND payment_method.verification_status in 'success','Success' return allow with action('manual_review',{'case_type':'MARKET_LIVE'}) 'needs_validation_model_restaurant' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.96 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v2.0' AND order.store_type in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model_restaurant_v41' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.995 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.1' AND order.store_type in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.98 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v2.0' AND order.store_type not in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model_v41' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.996 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.1' AND order.store_type not in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model_express' order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND payment_method.payment_type = 'credit_card' AND order.order_type in 'express_picker','express' AND order.custom.mk_internal_model_score > 0.82 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v2.0' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model_express_v41' order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND payment_method.payment_type = 'credit_card' AND order.order_type in 'express_picker','express' AND order.custom.mk_internal_model_score > 0.994 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.1' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model_restaurant_V43' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.928 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.3' AND order.store_type in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model_restaurant_V4' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.99 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.0' AND order.store_type in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model_V43' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.945 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.3' AND order.store_type not in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model_V4' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.97 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.0' AND order.store_type not in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model_express_V43' order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND payment_method.payment_type = 'credit_card' AND order.order_type in 'express_picker','express' AND order.custom.mk_internal_model_score > 0.881 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.3' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_model_express_V4' order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND payment_method.payment_type = 'credit_card' AND order.order_type in 'express_picker','express' AND order.custom.mk_internal_model_score > 0.96 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.0' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_new_users_finished_order>1' features.mk_payer_approved_qty_1d > 1 AND user.customs.account_age_in_days = 0 AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_acc>10_finished_order>3' features.mk_payer_approved_qty_1d > 3 AND user.customs.account_age_in_days < 10 AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND features.mk_device_is_safe_device_30d = 0 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_DECISION_TREE_TECH_RULE1' payment_method.payment_type in 'credit_card' and order.store_type in list('CO_Vertical-Ecommerce-Tech') and payment_method.verification_status not in 'success','Success'and ((features.mk_device_cc_cancel_amount_90d <= 1410 and order.amount_in_usd > 500 and address.age.days <=44) or (features.mk_device_cc_cancel_amount_90d > 1410)) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEED_VALIDATION_DECICION_TREE_RESTAURANT_RULE3' payment_method.payment_type in 'credit_card' and order.store_type in 'restaurant' and payment_method.verification_status not in 'success','Success' and order.custom.mk_internal_model_score <=0.235741 and order.custom.mk_internal_model_score >=0.06 and (device.user_agent not contains 'Grability/7.6.1','Grability/7.7') and ((features.mk_device_cc_cancel_qty_90d - 1.731)/5.384 > 14.444) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_ANDROID_ANDWEB_BIN_ATTACK_JUN23 ' payment_method.payment_type in 'credit_card' and payment_method.verification_status not in 'success','Success' AND ((device.user_agent contains 'Dalvik') OR (device.user_agent not contains 'Grability','Dalvik' AND device.user_agent contains 'Android')) AND user.email_verification_status in 'BOUNCED' AND ((payment_method.age.days < 30 AND user.customs.account_age < 30)) AND payment_method.card_bin in list('LISTA_BINES_ANDROID_ANDWEB_CVV_JUN23') return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_ATTACK_BIN_ANDROID_WEB_JUN_23' payment_method.payment_type in 'credit_card' and payment_method.verification_status not in 'success','Success' AND device.user_agent not contains 'Grability' AND order.custom.mk_internal_model_scoring_bucket > 30 AND (device.user_device_age < 30 OR (payment_method.age.days < 30 AND user.customs.account_age < 30) ) AND payment_method.card_bin in list('LISTA_BIN_INT_WARNING_ANDROID_JUN23') return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_ATTACK_BIN_IOS_JUN_23' payment_method.payment_type in 'credit_card' and payment_method.verification_status not in 'success','Success' AND device.user_agent contains 'Grability' AND order.custom.mk_internal_model_scoring_bucket > 30 AND (device.user_device_age < 30 OR (payment_method.age.days < 30 AND user.customs.account_age < 30) ) AND payment_method.card_bin in list('LISTA_BIN_INT_WARNING_IOS_JUN23') return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_DECISION_TREE_RESTAURANT_RULE1' payment_method.payment_type in 'credit_card' and order.store_type in 'restaurant' and order.custom.mk_internal_model_score > 0.06 and features.mk_device_cc_cancel_amount_90d>207 and payment_method.verification_status not in 'success','Success'and ((features.mk_device_cc_cancel_qty_90d >=74.5 and (features.mk_fingerprint_cancel_amount_90d/features.mk_fingerprint_amount_90d) <= 0.021 and order.custom.mk_internal_model_score > 0.18 and features.mk_payer_distinct_cc_fingerprint_90d >4)) return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_international_bin_high_risk_geo' (payment_method.country_code not in 'co','CO') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND order.custom.mk_internal_model_scoring_bucket > 85 AND 'CO_BIN_INT_RISK_geo7' in matching_smart_lists return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_rcash_no_vf_baq' order.shipping_address.city = 'Barranquilla' AND order.store_type in 'ultraservicio', 'ultraservice' AND payment_method.verification_status not in 'success', 'Success' AND features.mk_device_is_safe_device_10d = 0 AND payment_method.payment_type = 'credit_card' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_rfa_no_vf' order.store_type in 'courier_hours' AND payment_method.verification_status not in 'success' AND order.amount > 750000 AND payment_method.payment_type = 'credit_card' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_rcash_atm_hr' payment_method.payment_type in 'credit_card' AND order.store_type in 'ultraservice', 'ultraservicio' AND order.store.store_id contains list('CO_Stores-ATM-High-Risk') AND features.mk_device_is_safe_device_10d = 0 AND order.custom.applied_credits = 0 AND payment_method.verification_status not in 'success', 'Success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_rcash_atm_mr' payment_method.payment_type in 'credit_card' AND order.store_type in 'ultraservice', 'ultraservicio' AND order.store.store_id contains list('CO_Stores-ATM-Medium-Risk') AND features.mk_device_is_safe_device_10d = 0 AND order.custom.applied_credits = 0 AND payment_method.verification_status not in 'success', 'Success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_LIST_RISKY_BIN_INT_MAY_23' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND payment_method.card_bin in list('Lista_Bin_INT_May_CO_May') AND device.user_agent not contains 'Grability', 'Dalvik' AND order.custom.mk_internal_model_scoring_bucket > 33 AND (device.user_device_age < 42 OR payment_method.age.days < 55) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_ATTACK_INTERNATIONAL_BIN_MAY_23' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND payment_method.country_code not in 'co','CO' AND device.user_agent not contains 'Grability', 'Dalvik' AND (order.custom.mk_internal_model_scoring_bucket > 30 OR user.email_verification_status in 'BOUNCED' ) AND (device.user_device_age < 33 OR payment_method.age.days < 33 OR user.customs.account_age < 33) return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_rcash_no_vf' order.store_type in 'ultraservicio', 'ultraservice' AND payment_method.verification_status not in 'success' AND user.segment not in 'Diamond', 'Power' AND order.custom.user_is_prime = false AND payment_method.payment_type = 'credit_card' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_rfavor_no_vf' order.store_type in 'courier_hours' AND payment_method.verification_status not in 'success' AND user.segment not in 'Diamond', 'Power' AND user.power_user_alike_score < 75 AND payment_method.payment_type = 'credit_card' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND (features.mk_payer_is_safe_user_90d = 0 OR device.user_device_age <= 120) AND order.amount_in_usd > 3 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_dev_am_>_7dt' payment_method.verification_status not in 'success' AND payment_method.payment_type = 'credit_card' AND order.store_type not in 'rappi_livestream' AND user.segment not in 'Diamond', 'Power' AND user.power_user_alike_score < 70 AND features.is_safe_device = 0 AND features.mk_device_amount_7d > 400 AND features.is_safe_fingerprint = 0 AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND order.custom.mk_internal_model_scoring_bucket >= 96 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_bin_hr' payment_method.card_bin in list('CO_BIN-High-Risk') AND payment_method.payment_type = 'credit_card' AND features.mk_payer_mins_since_first_approved_order < 129000 AND features.mk_payer_approved_qty_90d < 15 AND user.power_user_alike_score < 30 AND user.maturity in 'New','None' AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_scoring_bucket >= 80 AND order.amount_in_usd >= 4 AND (order.custom.mk_internal_model_scoring_bucket >94 OR (features.mk_device_cc_cancel_amount_90d>=features.mk_device_cc_amount_90d*0.5)) return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_bin_mr' payment_method.card_bin in list('CO_BIN-Medium-Risk') AND payment_method.payment_type = 'credit_card' AND features.mk_payer_mins_since_first_approved_order < 129000 AND features.mk_payer_approved_qty_90d < 10 AND user.maturity in 'New','None' AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_scoring_bucket >= 90 AND order.amount_in_usd >= 5 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_bin_anomalies' user.power_user_alike_score < 70 AND features.is_card_bin_in_anomaly_detector = true AND user.maturity in 'New', 'None' AND payment_method.payment_type = 'credit_card' AND features.user_events_add_card_qty_3d >= 1 AND payment_method.verification_status not in 'success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_bin_anomalies_new_users_networks_devices' features.is_card_bin_in_anomaly_detector = true AND user.maturity in 'New','None','Amateur' AND (features.mk_geohash_approved_qty_1d >= 2 OR features.mk_device_approved_qty_1d >= 3 OR features.mk_fingerprint_distinct_user_id_7d >1 OR features.mk_device_distinct_user_id_7d > 1 OR features.mk_device_qty_1h > 3) AND features.mk_payer_mins_since_first_approved_order < 115000 AND payment_method.payment_type = 'Credit_card' AND order.amount > 110000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_high_value_ecommerce' order.store_type in list('CO_Vertical-Ecommerce-Tech') AND order.amount > 600000 AND payment_method.verification_status not in 'success' AND payment_method.payment_type = 'credit_card' AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_by_cpgs_ecom' order.store.store_id in list('CO_Vertical-CPGs-and-Ecommerce') AND payment_method.card_bin in list('CO_Bancolombia-BINs') AND order_amount > 376000 AND features.mk_device_is_safe_device_30d = 0 AND features.user_events_add_card_qty_1d > 6 AND payment_method.verification_status not in 'success' AND payment_method.payment_type = 'credit_card' return prevent with action('cc_validation_required',{'case_type':'-'}) 'live_horus_needs_validation_low_e_liquor_hv' device.user_agent not contains list('CO_Devices-High-End') AND order.store_type contains list('CO_Vertical-Liquor') AND payment_method.verification_status not in 'Success', 'success' AND order.amount > 130000 AND user.segment not in 'Diamond','Potential Diamond','Power' AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 80 AND order.amount_in_usd >= 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE-HIGH_VALUE'}) 'live_horus_needs_validation_low_e_liquor' device.user_agent not contains list('CO_Devices-High-End') AND order.store_type contains list('CO_Vertical-Liquor') AND payment_method.verification_status not in 'Success', 'success' AND order.amount > 130000 AND user.segment not in 'Diamond','Potential Diamond','Power' AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 80 AND order.amount_in_usd >= 15 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'needs_validation_low_e_liquor' device.user_agent not contains list('CO_Devices-High-End') AND order.store_type contains list('CO_Vertical-Liquor') AND payment_method.verification_status not in 'Success', 'success' AND order.amount > 130000 AND user.segment not in 'Diamond','Potential Diamond','Power' AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 80 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_high_e_liquor' device.user_agent contains list('CO_Devices-High-End') AND order.store_type contains list('CO_Vertical-Liquor') AND payment_method.verification_status not in 'Success', 'success' AND order.amount > 400000 AND user.segment not in 'Diamond','Potential Diamond','Power' AND payment_method.payment_type in 'credit_card' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_highe_liq_item' device.user_agent contains list('CO_Devices-High-End') AND order.items.any{product_name in list('CO_Items-Liquor-Restaurant-Abusse')} AND payment_method.verification_status not in 'Success', 'success' AND payment_method.payment_type in 'credit_card' AND order.items.all{product_name not contains list('CO_False-Positive-Meal-with-liquor')} AND order.amount > 400000 AND user.segment not in 'Diamond','Potential Diamond','Power' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_liq_and_item' payment_method.payment_type in 'credit_card' AND device.user_agent contains 'Dalvik' AND order.items.any{product_name in list('CO_Items-Liquor-Restaurant-Abusse')} AND payment_method.payment_type not in 'Cash', 'cash' AND order.items.all{product_name not contains list('CO_False-Positive-Meal-with-liquor')} AND payment_method.verification_status not in 'success' AND user.segment not in 'Diamond','Potential Diamond','Power' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_rest_qty' order.store_type contains 'restaurant', 'restaurante' AND payment_method.payment_type in 'credit_card' AND order.custom.items_quantity > 40 AND payment_method.verification_status not in 'success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_fast_acc_cre' payment_method.payment_type in 'credit_card' AND user.customs.account_age_in_minutes < 2 AND features.mk_device_distinct_user_id_90d > 3 AND payment_method.verification_status not in 'success', 'Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_no_volwes' device.user_agent not contains list('CO_Devices-High-End') AND payment_method.payment_type in 'credit_card' AND features.account_email_username_fraction_vowels = 0 AND user.power_user_alike_score < 30 AND payment_method.verification_status not in 'success','Success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND user.user_email not contains '@privaterelay.appleid.com' AND user.maturity not in 'Pro', 'Semi Pro' AND (order.custom.mk_internal_model_scoring_bucket > 90 OR features.normalized_email_events_distinct_user_count > 1 OR features.fake_users_email_similar_accounts_created_3d > 1) AND (order.custom.mk_internal_model_scoring_bucket > 90 OR features.fake_users_user_len >10) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_RISKY_BIN_INTERNACIONAL_MAY_23' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND order.custom.mk_internal_model_scoring_bucket > 59 AND payment_method.card_bin in list('Lista_Bin_AltoRiesgo_CO_May23') AND features.mk_user_is_whitelisted = false return prevent with action('cc_validation_required',{'case_type':'-'}) 'live_horus_needs_validation_vowels_low_hv' payment_method.payment_type in 'credit_card' AND features.account_email_username_fraction_vowels < 0.2 AND user.customs.account_age < 15 AND user.power_user_alike_score < 30 AND payment_method.verification_status not in 'success','Success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND user.user_email not contains '@privaterelay.appleid.com' AND device.user_agent not contains list('CO_Devices-High-End') AND user.email_verification_status in 'BOUNCED' AND order.amount_in_usd >= 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE-HIGH_VALUE'}) 'live_horus_needs_validation_vowels_low' payment_method.payment_type in 'credit_card' AND features.account_email_username_fraction_vowels < 0.2 AND user.customs.account_age < 15 AND user.power_user_alike_score < 30 AND payment_method.verification_status not in 'success','Success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND user.user_email not contains '@privaterelay.appleid.com' AND device.user_agent not contains list('CO_Devices-High-End') AND user.email_verification_status in 'BOUNCED' AND order.amount_in_usd >= 10 AND order.amount_in_usd < 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'needs_validation_vowels_low' payment_method.payment_type in 'credit_card' AND features.account_email_username_fraction_vowels < 0.2 AND user.customs.account_age < 15 AND user.power_user_alike_score < 30 AND payment_method.verification_status not in 'success','Success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND user.user_email not contains '@privaterelay.appleid.com' AND device.user_agent not contains list('CO_Devices-High-End') AND user.email_verification_status in 'BOUNCED' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_vowels_upper' payment_method.payment_type in 'credit_card' AND features.account_email_username_fraction_vowels > 0.9 AND user.customs.account_age < 15 AND user.power_user_alike_score < 30 AND payment_method.verification_status not in 'success','Success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND user.user_email not contains '@privaterelay.appleid.com' AND device.user_agent not contains list('CO_Devices-High-End') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_invalid_email' user.email_verification_status in 'BOUNCED','DENIED' AND payment_method.payment_type in 'credit_card' AND features.mk_payer_approved_qty_90d <= 1 AND user.power_user_alike_score < 30 AND payment_method.verification_status not in 'success','Success' AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND user.user_email not contains list('CO_Domain-False-Positive') AND order.custom.mk_internal_model_scoring_bucket > 70 AND order.amount_in_usd > 5 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_new_android' user.power_user_alike_score < 80 AND device.user_agent not contains list('CO_Devices-High-End') AND device.user_agent contains 'Dalvik' AND payment_method.payment_type in 'credit_card' AND features.mk_device_distinct_user_id_90d >= 5 AND payment_method.verification_status not in 'success','Success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_new_velocity' payment_method.payment_type in 'credit_card' AND features.mk_payer_qty_1d > 4 AND user.customs.account_age <= 1 AND payment_method.verification_status not in 'success','Success' AND user_id not in list('CO_user_id_companies_many_orders') AND order.custom.mk_internal_model_scoring_bucket >= 71 AND payment_method.age.days <= 7 AND order.amount_in_usd >= 6 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_6_orders' user.power_user_alike_score < 20 AND payment_method.payment_type in 'credit_card' AND order.store_type not in 'restaurant','rappibox' AND device.user_agent not contains list('CO_Devices-High-End') AND features.mk_payer_approved_qty_1d > 6 AND payment_method.verification_status not in 'success','Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_2da_order' device.user_agent not contains list('CO_Devices-High-End') AND order.store_type not in 'grin','rappi_prime','restaurant','rappibox' AND user.segment not in 'Diamond','Potential Diamond','Power','Potential Power' AND payment_method.payment_type in 'credit_card' AND device.user_agent contains 'Grability','Dalvik' AND features.mk_payer_mins_since_first_approved_order < 90 AND features.mk_payer_active_orders_qty > 1 AND features.mk_payer_approved_qty_90d <= 1 AND payment_method.verification_status not in 'success','Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_multiple_orders_in_progress' payment_method.payment_type in 'credit_card' AND features.mk_payer_active_orders_qty > 1 AND payment_method.verification_status not in 'success','Success' AND user.maturity not contains 'Pro','Semi Pro' AND device.user_agent not contains list('CO_Devices-High-End') AND features.mk_payer_approved_qty_90d < 15 AND (order.custom.mk_internal_model_scoring_bucket > 70 OR features.mk_payer_active_orders_qty > 2) AND order.custom.mk_internal_model_scoring_bucket > 90 return prevent with action('cc_validation_required',{'case_type':'-'}) 'live_horus_needs_validation_international_hv' payment_method.country_code not contains 'null','co','CO','MX','CL','us','US','AR','ar','NL','nl','ES','es','PT','pt','GB','gb','IT','it','FR','fr','DE','de',false AND payment_method.verification_status not in 'success','Success' AND device.user_agent not contains list('CO_Devices-High-End') AND features.mk_payer_approved_qty_90d <= 20 AND payment_method.payment_type in 'credit_card', 'cc' AND order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') AND features.mk_payer_orders_qty <=20 AND (order.custom.mk_internal_model_scoring_bucket > 96 OR features.mk_device_distinct_cc_fingerprint_90d >= 2) AND order.amount_in_usd >= 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE-HIGH_VALUE'}) 'live_horus_needs_validation_international' payment_method.country_code not contains 'null','co','CO','MX','CL','us','US','AR','ar','NL','nl','ES','es','PT','pt','GB','gb','IT','it','FR','fr','DE','de',false AND payment_method.verification_status not in 'success','Success' AND device.user_agent not contains list('CO_Devices-High-End') AND features.mk_payer_approved_qty_90d <= 20 AND payment_method.payment_type in 'credit_card', 'cc' AND order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') AND features.mk_payer_orders_qty <=20 AND (order.custom.mk_internal_model_scoring_bucket > 96 OR features.mk_device_distinct_cc_fingerprint_90d >= 2) AND order.amount_in_usd >= 10 AND order.amount_in_usd < 35 AND order.store_type not in 'restaurant','turbo' AND order.store_type not in list('CO_Vertical-ECommerce') return allow with action('manual_review',{'case_type':'MARKET_LIVE_HIGH'}) 'needs_validation_international' payment_method.country_code not contains 'null','co','CO','MX','CL','us','US','AR','ar','NL','nl','ES','es','PT','pt','GB','gb','IT','it','FR','fr','DE','de',false AND payment_method.verification_status not in 'success','Success' AND device.user_agent not contains list('CO_Devices-High-End') AND features.mk_payer_approved_qty_90d <= 20 AND payment_method.payment_type in 'credit_card', 'cc' AND order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') AND features.mk_payer_orders_qty <=20 AND (order.custom.mk_internal_model_scoring_bucket > 96 OR features.mk_device_distinct_cc_fingerprint_90d >= 2) return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_risky_address' order.shipping_address.address contains list('CO_Confirmed-fraud-addresses') AND payment_method.verification_status not in 'success','Success' AND payment_method.payment_type in 'credit_card' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_risky_mz' order.custom.micro_zone contains list('CO_Microzone-Risk') AND payment_method.payment_type in 'credit_card' AND features.mk_payer_approved_qty_90d < 15 AND order.custom.mk_internal_model_scoring_bucket > 70 AND payment_method.verification_status not in 'success','Success' AND device.user_agent not contains list('CO_Devices-High-End') AND user.segment not in 'Diamond', 'Power' AND user.power_user_alike_score < 30 AND order.custom.mk_internal_model_scoring_bucket >= 85 AND features.is_safe_fingerprint = 0 AND address.age.days < 120 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_by_soat' payment_method.payment_type in 'credit_card' AND order.store_type in 'soat','soat_webview' AND user.segment in 'Regular','Zero','Low Value','Low value' AND payment_method.verification_status not in 'success','SUCCESS','Success' AND device.user_agent not contains list('CO_Devices-High-End') AND payment_method.card_bin not in list('CO_BIN_SAFE_SOAT') AND user.power_user_alike_score < 30 AND order.custom.mk_payer_mins_since_first_approved_order < 129000 AND order.custom.micro_zone not contains list('CO_MZ-Soat-Cinco-Cuatro') AND 1 = 0 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_tech_high_amount' order.amount > 400000 AND user.segment not in 'Diamond', 'Power' AND order.store.store_id in list('CO_Tech-Stores-Validation') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND (features.mk_payer_approved_qty_90d < 5 OR (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d) >= 8) return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_multiple_orders_new_login_1h' device.user_device_age = 0 AND features.user_events_login_1h > 0 AND features.mk_payer_active_orders_qty >= 3 AND user.maturity in 'New','None' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_2ndscore_ecommerce' payment_method.payment_type = 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND order.store.store_id in list ('CO_ECommerce-2ndScore-Stores') AND payment_method.card_bin in list('CO_ECommerce-2ndScore-BIN') AND order.custom.micro_zone contains list('CO_ECommerce-2ndScore-MZ') AND order.custom.mk_internal_model_scoring_bucket > 70 AND order.amount > 350000 AND features.mk_device_qty_90d >= 2 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_2ndscore_rest' payment_method.payment_type = 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND order.store.store_id in list ('CO_Rest-2ndScore-Stores') AND payment_method.card_bin in list('CO_Rest-2ndScore-BIN') AND order.custom.micro_zone contains list('CO_Rest-2ndScore-MZ') AND order.custom.mk_internal_model_scoring_bucket > 70 AND (order.amount + order.custom.discount) > 35000 AND device.user_device_age <= 30 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_SEPT_REST_PROF' order.store_type in 'restaurant','restaurante' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND order.custom.mk_internal_model_scoring_bucket >= 87 AND order.amount_in_usd >= 10 AND features.mk_payer_approved_qty_90d < 15 AND ((user.customs.account_age = 0 AND order.custom.mk_internal_model_scoring_bucket <= 99 AND order.amount_in_usd > 15 AND (features.user_events_add_card_failed_qty_90d+features.mk_payer_canceled_by_payment_error_qty_90d) >= 2) OR features.user_events_add_card_qty_90d >= 11 OR features.user_events_add_card_failed_qty_90d >= 20 OR (features.mk_payer_approved_qty_1d + features.mk_payer_active_orders_qty) >= 4) AND order.custom.mk_internal_model_scoring_bucket > 95 AND order.amount_in_usd > 11 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_2NDSCORE_CPGS_V2' (order.store_type in list('CO_Vertical-Super-and-Hiper') OR order.store_type in 'super', 'hiper', 'express' OR order.store_type in list('CO_Vertical-Express') OR order.store_type contains list('CO_Vertical-Liquor') OR order.store_type in list('CO_Vertical-Pharmacy')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND device.user_device_age <= 30 AND order.custom.mk_internal_model_scoring_bucket >= 80 AND order.amount_in_usd >= 25 AND payment_method.card_bin in list('CO_Fraud_BIN_CPGS_2doScore_Mayo') AND order.store.store_id in list('CO_Fraud_Stores_CPGS_2doScore_Mayo') AND address.geohash_precision7 contains list('CO_Fraud_GH7_CPGS_2doScore_Mayo') return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_2NDSCORE_RCASH_V2' order.store_type in 'ultraservicio','ultraservice' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND address.age.days <= 7 AND order.custom.mk_internal_model_scoring_bucket >= 70 AND order.amount_in_usd >= 30 AND order.store.store_id in list('CO_Fraud_Stores_RAPPICASH_2doScore_Mayo') AND address.geohash_precision7 contains list('CO_Fraud_GH7_RAPPICASH_2doScore_Mayo') return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_high_amount_login_1d' device.user_device_age = 0 AND features.user_events_login_1d > 0 AND order.amount_in_usd > 150 AND user.maturity in 'New','None' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_geohash_new_login' device.user_device_age = 0 AND features.user_events_login_6h > 0 AND device.user_devices_count > 1 AND address.geohash_precision8 startswith list('CO_Geohash-Probable-ATO') AND order.amount_in_usd > 20 AND order.store_type not in list('CO_Vertical-Super-and-Hiper') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_multiple_orders_login_1d' device.user_device_age = 0 AND features.user_events_login_1d > 0 AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) > 2 AND device.user_devices_count > 1 AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_rest_liq' payment_method.payment_type in 'credit_card' AND order.store_type in 'restaurant' AND order.items.any {product_name in list('CO_Items-Liquor-type')} AND order.items.all{product_name not contains list('CO_False-Positive-Meal-with-liquor')} return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_risky_soat' order.store_type in 'Soat','SOAT','soat','soat_webview' AND features.user_events_login_7d >= 1 AND order.store.store_id not contains list('CO_Store-Soat-Safe') AND user.customs.date_time_hour >= 22 AND order.custom.mk_internal_model_scoring_bucket > 95 AND user.segment not in 'Diamond' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_forensic_liquor_super' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND (order.store_type contains list('CO_Vertical-Super-and-Hiper') OR order.store_type contains list('CO_Vertical-Liquor')) AND features.mk_fingerprint_is_safe_fingerprint_60d = 1 AND features.mk_device_is_safe_device_60d = 1 AND order.custom.mk_internal_model_scoring_bucket >= 75 AND user.customs.account_age >= 60 AND (features.mk_device_qty_1d >= 1 OR features.mk_device_qty_7d >= 1) AND (features.mk_fingerprint_distinct_device_id_7d >= 1 OR features.user_events_add_card_qty_30d >= 1) AND device.user_agent contains 'IPHONE 6S', 'IPHONE12,5', 'IPHONE11,2', 'IPHONE12,1', 'IPHONE13,2', 'IPHONE11,8', 'SM-A207M', 'IPHONE 7 PLUS' AND address.geohash_precision7 contains 'd3fy9wk1','d2g6d1p7','d2g6dbpc','d2g6cv1b','d3fy8cke','d2g64qr8','d2g62bvf','d2g60ge6','d2f92dy3','d2g630g7','d2g64nrs','d2f92b9x','d347078k','d2g68djk','d2g63e6e','d2g64q0m','d2g68gbw','d2g64nrg','d2g63wvp','d2fkcfkt','d3f70y87','d2g6fku3','d2g7grkx','d2g66sk2','d2g6fv8x','d2g63uc8' return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_REST_IP-GEOHASH_FORENSIC_MAR2023_FS' order.store_type contains 'restaurant' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND order.custom.mk_internal_model_scoring_bucket >= 96 AND order.amount_in_usd >= 6 AND user.customs.account_age_in_days <= 3 AND (features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_device_is_safe_device_90d = 0 OR features.mk_payer_is_safe_user_cc_90d = 0) AND address.age.days <= 3 AND payment_method.age.days <= 7 AND (features.mk_device_distinct_user_id_7d + features.mk_fingerprint_distinct_user_id_7d + features.mk_fingerprint_distinct_device_id_7d + features.mk_device_distinct_cc_fingerprint_7d + features.mk_payer_distinct_device_id_7d + features.mk_payer_distinct_cc_fingerprint_7d) >= 2 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 2 AND (features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21') return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_INTER_REST_FORENSIC' order.store_type contains 'restaurant' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND payment_method.country_code not in 'co','CO' AND order.custom.mk_internal_model_scoring_bucket >= 90 AND user.customs.account_age >= 20 AND address.age.days = 0 AND features.mk_payer_mins_since_last_approved_transaction <= 108000 AND user.completed_orders <= 30 AND (features.mk_device_distinct_user_id_30d + features.mk_fingerprint_distinct_user_id_30d + features.mk_fingerprint_distinct_device_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_payer_distinct_device_id_30d + features.user_events_add_card_qty_30d)>=1 AND address.geohash_precision8 in list('CO_Inter-Rest-Forensic-GH8') return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_CPGS_FORENSIC' (order.store_type in list('CO_Vertical-Express') OR order.store_type in list('CO_Vertical-Super-and-Hiper')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND order.custom.mk_internal_model_scoring_bucket >= 90 AND user.customs.account_age_in_days >= 60 AND device.user_device_age <= 60 AND features.mk_payer_mins_since_first_approved_order >= 86400 AND features.mk_payer_mins_since_last_approved_transaction <= 30240 AND order.amount_in_usd >= 21 AND (features.mk_payer_canceled_by_fraud_qty >= 1 OR order.items.any { product_name contains list('Global_Risky-Products')}) AND address.geohash_precision8 contains list('CO_CPGs-Forensic-GH8') return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_STORE_HIGH_SCORING_BUCKET' payment_method.payment_type in 'credit_card' AND 'CO_Restaurants-High-Scoring-Bucket' in matching_smart_lists AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_ECOMMERCE' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND order.store_type in list('CO_Vertical-All-Ecommerce') AND order.custom.mk_internal_model_scoring_bucket > 98 AND payment_method.age.days <= 30 AND order.amount_in_usd > 250 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_EXPRESS_RISKY_STORE_HIGH_AMT' payment_method.payment_type in 'credit_card' AND order.store.store_id in 'CO_Stores-Express-High-Risk' AND order.amount_in_usd > 100 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('cc_validation_required',{'case_type':'-'}) 'live_bin_liquor_prepaid_cards' user.power_user_alike_score < 30 AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND payment_method.verification_status in 'Success','success' AND 1 = 0 AND order.store_type contains list('CO_Vertical-Liquor') AND user.segment not in 'Diamond','Potential Diamond','Power','Potential Power' AND order.amount > 400000 return allow with action('manual_review',{'case_type':'MARKET_LIVE'}) 'live_vertical_anomalies' user.power_user_alike_score < 30 AND order.store.store_id in list ('CO_Stores-Anomalies-Medium-Risk') AND payment_method.payment_type not in 'Cash','cash' AND user.segment not in 'Diamond','Power' return allow with action('manual_review',{'case_type':'MARKET_LIVE'}) 'cancel_coupon_cc_abusse' features.coupon_abuse_vector_coupon_approved_qty >= 2 AND order.custom.coupon_type contains 'refered','first_time' return block with action('communications',{'case_type':'coupon_fraud_communication'}) 'live_sin_iva_cbk_concentration' user.power_user_alike_score < 40 AND user.segment in 'Regular','Low Value','Potential Diamond','Potential Power' AND order.amount > 400000 AND order.store_type in list('CO_Vertical-All-Dia-Sin-IVA') AND payment_method.card_bin not in list('CO_BIN_SAFE_SINIVA') AND payment_method.payment_type not in 'cash','Cash' return allow with action('manual_review',{'case_type':'HOT_SALE'}) 'live_sin_iva_cbk_hqu' user.segment in 'Diamond','Potential Diamond','Power','Potential Power' AND user.maturity not in 'None','New' AND order.amount > 500000 AND order.store_type in list('CO_Vertical-All-Dia-Sin-IVA') AND features.user_events_login_7d >= 1 AND payment_method.payment_type not in 'cash','Cash' return allow with action('manual_review',{'case_type':'HOT_SALE'}) 'live_ecommerce_dia_sin_iva' order.store_type in list('CO_Vertical-All-Dia-Sin-IVA') AND order.amount > 2000000 AND payment_method.card_bin not in list('CO_BIN_SAFE_SINIVA') AND (features.is_safe_device = 0 OR features.mk_fingerprint_is_safe_fingerprint_10d = 0) AND payment_method.payment_type not in 'cash','Cash' return allow 'live_sin_iva_new_users' (user.segment in 'Zero' OR user.maturity in 'None','New') AND order.amount > 300000 AND order.store_type in list('CO_Vertical-All-Dia-Sin-IVA') AND payment_method.card_bin not in list('CO_BIN_SAFE_SINIVA') AND payment_method.payment_type not in 'cash','Cash' return allow with action('manual_review',{'case_type':'HOT_SALE'}) 'needs_validation_model_nr' payment_method.payment_type = 'credit_card' AND order.store_type not in 'restaurant','restaurante','soat','soat_webview' AND order.custom.mk_internal_model_score > 0.7 AND order.store_type not in 'social_gifts' AND payment_method.verification_status not in 'Success','success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v1.1' return prevent with action('cc_validation_required',{'case_type':'-'}) 'live_emails_created_by_bots' user.user_email startswith list('CO_Email_Created_Bots') AND user.maturity in 'New','None' AND order.amount > 50000 AND payment_method.payment_type not in 'cash','Cash' AND 1= 0 return allow with action('manual_review',{'case_type':'MARKET_LIVE'}) 'NEEDS_VALIDATION_ANOMALY_RISKY_STORE' 'BR_Stores-Risky-Behavior' in matching_smart_lists AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND (order.custom.mk_internal_model_scoring_bucket >= 90 OR user.maturity in 'New','None' OR user.customs.account_age < 5) AND features.mk_fingerprint_is_safe_fingerprint_10d = 0 AND order.amount_in_usd > 5 AND device.user_agent not contains list('BR_Devices-High-End') AND order.custom.mk_internal_model_scoring_bucket >= 89 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_ANOMALY_RISKY_GEOHASH' 'BR_Geohash-Risky-Behaviour' in matching_smart_lists AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND (order.custom.mk_internal_model_scoring_bucket >= 90 OR user.maturity in 'New','None' OR user.customs.account_age < 2) AND features.mk_device_qty_1d > 0 AND features.mk_geohash_qty_1d > 0 AND features.mk_fingerprint_is_safe_fingerprint_10d = 0 AND features.mk_device_distinct_user_id_7d > 0 AND order.custom.mk_internal_model_scoring_bucket >= 85 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_CC_POSSIBLE_FAKE_NAME' ('AR_Fingerprint-Possible-Fake-Name' in matching_smart_lists OR 'BR_Fingerprint-Possible-Fake-Name' in matching_smart_lists OR 'CO_Fingerprint-Possible-Fake-Name' in matching_smart_lists OR 'MX_Fingerprint-Possible-Fake-Name' in matching_smart_lists OR 'PE_Fingerprint-Possible-Fake-Name' in matching_smart_lists OR 'CR_Fingerprint-Possible-Fake-Name' in matching_smart_lists OR 'CL_Fingerprint-Possible-Fake-Name' in matching_smart_lists OR 'EC_Fingerprint-Possible-Fake-Name' in matching_smart_lists) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND user.segment not in 'Diamond','Power' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('cc_validation_required',{'case_type':'-'}) and action('apply_restriction',{'case_type':'cc_validation_required'}) 'NEEDS_VALIDATION_CC_MULTI_NEW_USERS' 'Fingerprint_Multiple_New_Users' in matching_smart_lists AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND user.segment not in 'Diamond','Power' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('redact_all_cards',{'case_type':'-'}) and action('apply_restriction',{'case_type':'cc_validation_required'}) 'NEEDS_VALIDATION_MAX_AMOUNT_RESTAURANT' order.store_type contains 'restaurant' AND payment_method.verification_status not in 'success', 'Success' AND features.mk_user_is_whitelisted = false AND payment_method.payment_type in 'credit_card' AND(user.maturity not in 'Pro', 'Semi Pro' OR features.mk_payer_approved_qty_90d <= 5) AND order.amount_in_usd >= 180 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_MAX_AMOUNT_PHARMACY' order.store_type in list ('CO_Vertical-Pharmacy') AND payment_method.verification_status not in 'success', 'Success' AND features.mk_user_is_whitelisted = false AND payment_method.payment_type in 'credit_card' AND (user.maturity not in 'Pro', 'Semi Pro' OR features.mk_payer_approved_qty_90d <= 5) AND order.amount_in_usd >= 210 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_MAX_AMOUNT_SUPER' order.store_type in list ('CO_Vertical-Super') AND payment_method.verification_status not in 'success', 'Success' AND features.mk_user_is_whitelisted = false AND payment_method.payment_type in 'credit_card' AND (user.maturity not in 'Pro', 'Semi Pro' OR features.mk_payer_approved_qty_90d <= 5) AND order.amount_in_usd >= 400 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_MAX_AMOUNT_EXPRESS' order.store_type in list ('CO_Vertical-Express') AND payment_method.verification_status not in 'success', 'Success' AND features.mk_user_is_whitelisted = false AND payment_method.payment_type in 'credit_card' AND (user.maturity not in 'Pro', 'Semi Pro' OR features.mk_payer_approved_qty_90d <= 5) AND order.amount_in_usd >= 190 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_MAX_AMOUNT_TURBO' order.store_type in list ('CO_Vertical-Turbo') AND payment_method.verification_status not in 'success', 'Success' AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 85 AND order.amount_in_usd >= 110 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_CPGS_STORE_ATTACK' 'CO_CPGs-Store-Under-Attack' in matching_smart_lists AND (user.customs.account_age < 40 OR order.custom.mk_internal_model_scoring_bucket >= 90 OR user.maturity in 'New','None' OR features.mk_payer_approved_qty_90d <= 1) AND order.amount_in_usd > 5 AND payment_method.payment_type in 'credit_card' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.mk_internal_model_scoring_bucket >= 80 AND features.mk_device_qty_90d >= 2 AND order.amount_in_usd >= 25 AND features.mk_payer_approved_qty_90d = 0 AND (order.custom.items_quantity/order.custom.different_items_quantity) >= 2 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_VELOCITY' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND order.custom.mk_internal_model_scoring_bucket >= 90 AND (((user.customs.account_age < 30 OR user.maturity in 'New','None' OR user.segment in 'Zero' OR features.mk_payer_approved_qty_90d < 2 OR order.custom.mk_internal_model_scoring_bucket >= 95) AND ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty) >= 2 OR (features.mk_payer_approved_qty_12h + features.mk_payer_active_orders_qty) >= 3 OR (features.mk_payer_approved_qty_1d + features.mk_payer_active_orders_qty) >= 4)) OR ((features.mk_payer_approved_qty_1h + features.mk_payer_active_orders_qty) >= 3 OR (features.mk_payer_approved_qty_12h + features.mk_payer_active_orders_qty) >= 4 OR (features.mk_payer_approved_qty_1d + features.mk_payer_active_orders_qty) >= 5)) AND user_id not in list('CO_user_id_companies_many_orders') AND order.amount_in_usd > 5 AND user.segment not in 'Power','Diamond' AND user.maturity not contains 'Pro' return prevent with action('cc_validation_required',{'case_type':'-'}) 'CANCEL_ORDER_FAKE_RAPPICARD_USER' payment_method.card_bin in '491626' AND (user.customs.account_age = 0 OR (user.completed_orders = 0 AND features.mk_payer_approved_qty_90d = 0) OR user.segment in 'Zero') AND order.amount_in_usd > 10 AND (features.mk_fingerprint_distinct_user_id_7d > 1 OR features.mk_geohash_approved_qty_1d > 0) AND features.user_events_add_card_qty_1d > 0 AND order.custom.mk_internal_model_scoring_bucket > 90 AND ((order.items.any { product_name contains list('Global_Risky-Products')} AND order.custom.different_items_quantity < 5) OR order.custom.mk_internal_model_scoring_bucket >= 98 OR user.email_verification_status in 'BOUNCED','DENIED' OR order.store_type in 'courier_hours') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'CANCEL_ORDER_FAKE_RAPPICARD_USER_2' payment_method.payment_type in 'rappi_pay_gateway' AND user.customs.account_age = 0 AND order.amount_in_usd > 35 AND order.store_type not in 'restaurant','restaurante' AND order.items.any { product_name contains list('Global_Risky-Products')} AND order.custom.different_items_quantity <= 3 AND (user.customs.account_age_in_hours = 0 OR order.amount_in_usd > 100 OR order.custom.different_items_quantity = 1 OR features.mk_geohash_qty_6h > 0 OR features.mk_payer_distinct_store_1d >= 3) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'NEEDS_VALIDATION_SCHEDULED_OTHER' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.7 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v2.0' AND order.store_type not in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND order.status = 'scheduled' AND payment_method.payment_type not in 'cash','Cash' AND user.segment not in 'Diamond','Power','Potential Diamond' AND payment_method.verification_status not in 'success','Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_SCHEDULED_OTHER_v41' payment_method.payment_type = 'credit_card' AND order.custom.mk_internal_model_score > 0.993 AND payment_method.verification_status not in 'success' AND order.custom.mk_internal_model_name ='mk-xgb-co-mi-v4.1' AND order.store_type not in 'restaurant','restaurante' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') AND order.status = 'scheduled' AND payment_method.payment_type not in 'cash','Cash' AND user.segment not in 'Diamond','Power','Potential Diamond' AND payment_method.verification_status not in 'success','Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_ECOMMERCE_HIGH_VALUE' user.maturity in 'New','None', 'Amateur' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND device.user_agent not contains list('CO_Devices-High-End') AND payment_method.payment_type in 'credit_card','nequi','rappipay' AND features.is_safe_device = 0 AND order.store_type in list('CO_Vertical-Ecommerce-Tech') AND order.amount_in_usd >= 160 AND payment_method.verification_status not in 'success','Success' return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_SOAT_RISK_AGO2022' order.store_type in 'soat','soat_webview' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND payment_method.card_franchise contains 'visa','Visa','master','Master' AND (order.custom.mk_internal_model_scoring_bucket >= 95 OR (order.custom.mk_internal_model_scoring_bucket >= 81 AND order.custom.mk_internal_model_scoring_bucket < 95 AND order.amount_in_usd >= 150)) AND (((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_payer_cc_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) AND user.customs.account_age >= 60 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 2 AND features.mk_fingerprint_address_approved_qty_90d <= 3 AND user.maturity not in 'Pro' AND user.segment not in 'Diamond','Power','Potential Diamond' AND device.user_device_age <= 135 AND (features.mk_device_distinct_user_id_30d + features.mk_payer_distinct_device_id_30d) >= 1 AND (payment_method.age.days < 1 OR device.user_device_age < 1 OR address.age.days < 1 OR features.user_by_device_events_is_known_device_for_login = 0 OR features.mk_device_is_safe_device_90d = 0 OR features.mk_payer_is_safe_user_cc_90d = 0 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0) AND features.mk_fingerprint_approved_qty_90d <= 3 AND ( 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists OR ( (((features.mk_payer_cc_approved_amount_90d / (features.mk_payer_cc_approved_qty_90d + 1)) - (features.mk_payer_cc_approved_amount_30d / (features.mk_payer_cc_approved_qty_30d + 1)) ) < (1 * (features.mk_payer_cc_approved_amount_30d / (features.mk_payer_cc_approved_qty_30d + 1)))) AND (((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)) ) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) AND order.custom.mk_internal_model_scoring_bucket >= 98 AND features.mk_payer_distinct_address_id_7d >= 1 AND features.mk_fingerprint_address_approved_qty_90d < 1 AND features.mk_payer_fingerprint_device_approved_qty_90d < 1 AND payment_method.age.days < 1 AND device.user_device_age < 1)) return prevent with action('cc_validation_required',{'case_type':'-'}) 'CANCEL_ORDER_TURBO_RISK_FORENCSIC_AGO2022' order.store_type in list('CO_Vertical-Turbo') AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 91 AND (order.amount_in_usd >= 30 OR (order.amount_in_usd < 30 AND order.amount_in_usd >= 16 AND order.custom.mk_internal_model_scoring_bucket >= 99)) AND ( order.items.any { unified_category_name contains list('Global_Risky_Category_Products') } OR (((features.mk_device_approved_amount_90d / (features.mk_device_approved_qty_90d + 1)) - (features.mk_device_approved_amount_30d / (features.mk_device_approved_qty_30d + 1)) ) < (1 * (features.mk_device_approved_amount_30d / (features.mk_device_approved_qty_30d + 1)))) OR order.custom.mk_internal_model_scoring_bucket >= 99 OR order.amount_in_usd >= 70 ) AND ( (user.maturity not in 'Pro' AND user.segment not in 'Diamond','Potential Diamond') OR order.custom.mk_internal_model_scoring_bucket >= 99) AND ((((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)) ) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) OR order.custom.mk_internal_model_scoring_bucket >= 99) AND ( (((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_payer_cc_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) OR (payment_method.age.days < 1 AND order.custom.mk_internal_model_scoring_bucket >= 96) OR (address.age.days < 1 AND order.custom.mk_internal_model_scoring_bucket >= 96)) AND 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists return prevent with action('cc_validation_required',{'case_type':'-'}) 'TEST_BN_RESTRICTION_HIGH_RISK_STORES' 'CO_high_risk_stores_bname' in matching_smart_lists return allow 'NEEDS_VALIDATION_CPGS_FORENSIC_AGO2022' (order.store_type in list('CO_Vertical-All-CPGs') OR order.store.store_type in list('CO_Vertical-Turbo')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND (order.store_type in list('CO_Vertical-All-CPGs') OR order.store.store_type in list('CO_Vertical-Turbo')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND order.amount_in_usd >= 4 AND order.custom.mk_internal_model_scoring_bucket >= 91 AND user.maturity not in 'Pro', 'Semi Pro' AND user.segment not in 'Diamond','Potential Diamond','Power' AND ((((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_payer_cc_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) OR ((features.mk_payer_canceled_by_user_qty_7d + features.mk_payer_canceled_by_payment_error_qty_7d + features.mk_payer_canceled_by_fraud_qty_7d) > features.mk_payer_approved_qty_7d) OR (payment_method.age.days < 1 OR user.customs.account_age < 1 OR address.age.days < 1) OR ((((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1))) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) AND (((features.mk_payer_cc_approved_amount_90d / (features.mk_payer_cc_approved_qty_90d + 1)) - (features.mk_payer_cc_approved_amount_30d / (features.mk_payer_cc_approved_qty_30d + 1))) < (1 * (features.mk_fingerprint_approved_amount_30d / (features.mk_fingerprint_approved_qty_30d + 1)))))) AND (features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_device_is_safe_device_90d = 0 OR features.mk_payer_is_safe_user_cc_90d = 0 OR (features.user_by_device_events_is_known_device_for_login = 0 AND user.customs.account_age >= 2)) AND (features.mk_payer_fingerprint_device_approved_qty_90d <= 6 OR features.mk_fingerprint_address_approved_qty_90d <= 4 OR features.mk_payer_address_approved_qty_90d <= 4) AND ( order.items.any { unified_category_name contains list('Global_Risky_Category_Products') } OR order.custom.mk_internal_model_scoring_bucket >= 99 OR order.amount_in_usd >= 70 ) AND ((address.geohash_precision8 contains list('CO_GEOHASH8_TOTAL_FORENSIC_OCT20-JUN21') AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) OR ('CO_Geo8_Cbk__Maduration_def' in matching_smart_lists AND (((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1))) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) AND (((features.mk_device_approved_amount_90d / (features.mk_device_approved_qty_90d + 1)) - (features.mk_device_approved_amount_30d / (features.mk_device_approved_qty_30d + 1))) < (1 * (features.mk_device_approved_amount_30d / (features.mk_device_approved_qty_30d + 1)))) AND (((features.mk_payer_cc_approved_amount_90d / (features.mk_payer_cc_approved_qty_90d + 1)) - (features.mk_payer_cc_approved_amount_30d / (features.mk_payer_cc_approved_qty_30d + 1))) < (1 * (features.mk_payer_cc_approved_amount_30d / (features.mk_payer_cc_approved_qty_30d + 1)))) AND payment_method.age.days < 1 AND order.custom.mk_internal_model_scoring_bucket >= 96)) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_TURBO_FAKE_HIGH_BUCKET_USER' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND (order.store.store_type in list('CO_Vertical-Turbo') OR order.store_type in 'express') AND user.email_verification_status in 'BOUNCED','ERROR' AND order.custom.mk_internal_model_scoring_bucket >= 99 AND user.customs.account_age = 0 AND order.items.any { unified_category_name contains list('Global_Risky_Category_Products')} AND order.amount_in_usd >= 20 AND order.custom.different_items_quantity < 10 return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_geo_high_cancelation_rate_v1' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND (features.mk_geohash_cancel_qty_90d>features.mk_geohash_qty_90d*0.8)AND (mk_geohash_qty_90d>3)AND (order.custom.mk_internal_model_scoring_bucket > 93) AND (order.amount_in_usd > 10)AND (user.customs.account_age < 60) return prevent with action('cc_validation_required',{'case_type':'-'}) 'needs_validation_fraud_whisky_x_value_40' order.store_type in list('CO_Vertical-All-CPGs') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND order.custom.mk_internal_model_scoring_bucket > 70 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0 AND order.custom.different_items_quantity <= 8 AND user.maturity in 'New','None' AND order.items.any { unified_category_name contains list('Liquor_&_Cigarette_Products')} AND order.amount_in_usd >= 40 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_NEW_PRIME_USER_SOAT' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND order.store_type in 'Soat','SOAT','soat','soat_webview' AND user.maturity in 'None','New' AND order.custom.user_is_prime = true AND order.custom.mk_internal_model_scoring_bucket > 90 AND order.amount_in_usd > 70 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_NEW_USERS_DISTINCT_ADDRESS_SOAT' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND order.store_type in 'Soat','SOAT','soat','soat_webview' AND user.maturity in 'None','New' AND user.customs.account_age < 30 AND order.amount_in_usd > 55 AND features.crosses_user_fingerprint_qty_users> 0 AND features.mk_device_distinct_user_new_90d > 0 AND features.mk_payer_distinct_address_id_7d > 1 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_CPGS_RESTAURANTES_HIGH_RISK_BIN_INTERNATIONAL_FEB2023' (order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type contains 'restaurant') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND user.maturity in 'None','New','Amateur' AND order.custom.mk_internal_model_scoring_bucket > 80 AND device.user_device_age <= 6.5 AND payment_method.age.days <= 12.5 AND payment_method.card_bin in list('CO_BIN_INT_HIGH_RISK_FEB23') AND address.geohash_precision7 in list('CO_GEOHASH7_BIN_INT_FEB23') return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_SOAT_NEW_AMATEUR_USERS_GEO_FS_TEST' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND order.store_type in 'Soat','SOAT','soat','soat_webview' AND order.custom.mk_internal_model_scoring_bucket > 60 AND user.maturity in 'None','New','Amateur' AND payment_method.age.days < 30 AND (features_fs.fs_geohash7_cbk_qty_90d/features_fs.fs_geohash7_approved_qty_90d) > 0.2 AND address.geohash_precision7 startswith list('CO_GEOHASH6_SOAT_FEB23') return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_CPGS_REST_NEW_AMATEUR_USERS_POTENTIAL_FRAUD_LOCALIZATION_FEB023' (order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type contains 'restaurant') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND user.maturity in 'None','New','Amateur' AND order.custom.mk_internal_model_scoring_bucket > 95 AND features.mk_payer_approved_qty_90d < 3 AND payment_method.age.days <= 3 AND address.geohash_precision7 in list('CO_GEOHASH_7_POTENTIAL_FRAUD_LOCALIZATION_FEB23') AND order.amount_in_usd > 11 return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_PHARMACY-IOS_FORENSIC_MAR2023' order.store_type in list('CO_Vertical-Pharmacy') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND payment_method.age.days <= 7 AND (( device.user_agent contains 'Grability' AND order.custom.mk_internal_model_scoring_bucket >= 61 AND order.custom.mk_internal_model_scoring_bucket <= 70) OR order.custom.mk_internal_model_scoring_bucket >= 92) AND order.amount_in_usd >= 6 AND ( user.segment not in 'Diamond' OR order.custom.mk_internal_model_scoring_bucket >= 92) AND features.mk_payer_fingerprint_device_approved_qty_90d <= 5 AND features.mk_fingerprint_address_approved_qty_90d <= 4 AND ((features.user_events_add_card_qty_7d - features.user_events_add_card_failed_qty_7d) >= 1 OR (features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) >= 2 ) AND ((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21') OR ( payment_method.age.days < 1 AND (address.age.days <= 3 OR device.user_device_age <= 3) AND features.mk_payer_fingerprint_device_approved_qty_90d < 1 AND features.mk_fingerprint_address_approved_qty_90d < 1 AND (((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1))) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) AND order.amount_in_usd >= 90 AND user.maturity not in 'Pro' AND user.segment not in 'Diamond','Power')) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_REST_FORENSIC_MAR2023_FS' order.store_type contains 'restaurant' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND ( (payment_method.country_code in 'co','CO' AND payment_method.age.days <= 3 AND order.custom.mk_internal_model_scoring_bucket >= 96 AND order.amount_in_usd >= 15 AND (address.age.days <= 7 OR user.customs.account_age <= 7) AND (features.mk_fingerprint_address_approved_qty_90d < 1 OR features.mk_payer_fingerprint_device_approved_qty_90d <= 1)) OR (payment_method.country_code not in 'co','CO' AND payment_method.age.days <= 30 AND order.custom.mk_internal_model_scoring_bucket >= 96 AND order.amount_in_usd >= 5 AND user.segment not in 'Power' AND (features.mk_fingerprint_address_approved_qty_90d <= 1 OR features.mk_payer_fingerprint_device_approved_qty_90d <= 1 OR features.mk_payer_address_approved_qty_90d <= 1 OR order.custom.mk_internal_model_scoring_bucket >= 98)) ) AND user.maturity not in 'Pro' AND ( ((features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) OR ( order.custom.mk_internal_model_scoring_bucket >= 98 AND order.amount_in_usd >= 30 AND payment_method.age.days < 1 AND address.age.days <= 1 AND user.customs.account_age <= 1 AND features.mk_fingerprint_address_approved_qty_90d < 1 AND features.mk_payer_fingerprint_device_approved_qty_90d < 1 AND features.mk_payer_address_approved_qty_90d < 1 AND features.mk_payer_distinct_address_id_7d >= 1)) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_TRV_CBK_DEVICES_ABR2023' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND (device.device_id in list('CO_DEVICE_ID_CBK_TOTAL_1') OR device.device_id in list('CO_DEVICE_ID_CBK_TOTAL_2') OR device.device_id in list('CO_DEVICE_ID_CBK_TOTAL_3') OR 'DEVICE_cbk_CO' in matching_smart_lists ) AND ((features_fs.fs_geohash7_cbk_qty_120d > 0 OR features_fs.fs_geohash7_cbk_user_qty_120d > 0) OR ((((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1))) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) AND order.custom.mk_internal_model_scoring_bucket >= 92 )) AND features.mk_user_is_whitelisted = false AND (features.mk_payer_mins_since_first_approved_order > 0 OR order.custom.mk_internal_model_scoring_bucket >= 96) AND order.custom.mk_internal_model_scoring_bucket >= 83 AND payment_method.age.days <= 21 AND ((order.store_type in list('CO_Vertical-All-Ecommerce') AND order.amount_in_usd >= 100) OR (order.store_type in list('CO_Vertical-All-CPGs') AND order.amount_in_usd >= 20) OR (order.store_type contains 'restaurant' AND order.amount_in_usd >= 15) OR (order.store_type in 'ultraservicio','ultraservice' AND order.amount_in_usd >= 80)) AND (user.segment not in 'Power' OR order.custom.mk_internal_model_scoring_bucket >= 97) AND ( features.mk_fingerprint_address_approved_qty_90d <= 3 OR features.mk_payer_address_approved_qty_90d <= 3 OR features.mk_payer_fingerprint_device_approved_qty_90d <= 3) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_LIQUORS_MAY2023' (order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type contains 'turbo') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND order.items.any { unified_category_name contains 'whiskys','whiskey','whiskeys','Whiskey','cerveza','cervezas','Cerveza','tequila','tequilas','rones','aguardiente','vodka' } AND payment_method.age.days <= 7 AND (device.user_device_age <= 30 OR address.age.days <= 30) AND order.custom.mk_internal_model_scoring_bucket >= 77 AND (user.maturity not in 'Pro' OR order.custom.mk_internal_model_scoring_bucket >= 100) AND (user.segment not in 'Diamond','Power' OR order.custom.mk_internal_model_scoring_bucket >= 100) AND order.amount_in_usd >= 6 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 5 AND (features.mk_fingerprint_address_approved_qty_90d <= 2 OR features.mk_payer_address_approved_qty_90d <= 2) AND (features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) >= 1 AND (((features.mk_geohash_cc_approved_amount_90d / (features.mk_geohash_cc_approved_qty_90d + 1)) - (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1))) < (1 * (features.mk_geohash_cc_approved_amount_30d / (features.mk_geohash_cc_approved_qty_30d + 1)))) AND 'DEVICE_cbk_CO' in matching_smart_lists AND (features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_INT_BIN_WEB_NEW_USERS_VELOCITY_MAY2023' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND payment_method.country_code not in 'co','CO' AND device.user_agent not contains 'Grability', 'Dalvik' AND user.customs.account_age_in_days < 20 AND order.custom.mk_internal_model_scoring_bucket > 70 AND (features.mk_payer_qty_1h > 1 OR features.mk_payer_qty_1d > 4 OR features.mk_payer_qty_7d > 10) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_SOAT_JUN2023' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND order.store_type contains 'Soat','SOAT','soat','soat_webview','Soat web view Bogot' AND order.custom.mk_internal_model_scoring_bucket >= 71 AND user.maturity not in 'Pro','Semi pro' AND user.segment not in 'Diamond','Power','Potential Diamond','Potential Power' AND payment_method.age.days <= 20 AND device.user_device_age <= 30 AND order.amount_in_usd >= 50 AND (features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) >= 1 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 2 AND (features.mk_fingerprint_address_approved_qty_90d <= 2 OR features.mk_payer_address_approved_qty_90d <= 2 OR features.mk_device_address_approved_qty_90d <= 2 ) AND features.fake_users_user_email_score <= 10 AND ( 'DEVICE_cbk_CO' in matching_smart_lists OR ((features_fs.fs_geohash7_cbk_qty_120d > 0 OR features_fs.fs_geohash7_cbk_user_qty_120d > 0) AND order.custom.mk_internal_model_scoring_bucket >= 98 AND payment_method.age.days < 1 )) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_TECH_FORENSIC_JUN2023' order.store_type in list('CO_Vertical-Ecommerce-Tech') AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND payment_method.age.days <= 7 AND order.custom.mk_internal_model_scoring_bucket >= 91 AND order.amount_in_usd >= 300 AND user.maturity not in 'Pro','Semi pro' AND user.segment not in 'Diamond','Power','Potential Diamond','Potential Power' AND features.mk_payer_fingerprint_device_approved_qty_90d <= 2 AND ( features.mk_fingerprint_address_approved_qty_90d <= 2 OR features.mk_payer_address_approved_qty_90d <= 2 OR features.mk_device_address_approved_qty_90d <= 2) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_TURBO_SUPER_LIQUORS_JUN2023_DV' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND ( order.store_type contains 'turbo','Turbo' OR order.store_type in list('CO_Vertical-Turbo') OR order.store_type in list('CO_Vertical-Super-and-Hiper') OR order.store_type in list('CO_Vertical-Super')) AND order.items.any { unified_category_name contains 'whiskys','whiskey','whiskeys','Whiskey','cerveza','cervezas','Cerveza','tequila','tequilas','rones','aguardiente','vodka' } AND order.custom.mk_internal_model_scoring_bucket >= 86 AND payment_method.age.days <= 7 AND address.age.days <= 7 AND device.user_device_age <= 30 AND order.amount_in_usd >= 12 AND user.maturity not in 'Pro' AND user.segment not in 'Diamond','Power' AND (features.user_events_add_card_qty_7d - features.user_events_add_card_failed_qty_7d) >= 1 AND (features.mk_payer_fingerprint_device_approved_qty_90d <= 2 OR features.mk_fingerprint_address_approved_qty_90d <= 2 OR features.mk_payer_address_approved_qty_90d <= 2 OR features.mk_device_address_approved_qty_90d <= 2 ) AND ( 'DEVICE_cbk_CO' in matching_smart_lists OR ((features_fs.fs_geohash7_cbk_qty_120d > 0 OR features_fs.fs_geohash7_cbk_user_qty_120d > 0) AND payment_method.age.days < 1 AND device.user_device_age <= 3) OR order.custom.mk_internal_model_scoring_bucket >= 96 ) return prevent with action('cc_validation_required',{'case_type':'-'}) 'NEEDS_VALIDATION_ATTACKS_WATCH-TOWER_RULE' payment_method.payment_type in 'credit_card' AND (( payment_method.card_bin in list('CO_BIN_ANOMALY_JEAN_2023') AND (features.mk_payer_canceled_by_payment_error_qty_1d >= 2 OR features.mk_payer_cc_canceled_by_fraud_qty_1d >= 2)) OR features.mk_payer_canceled_by_payment_error_qty_1d >= 3 OR features.mk_payer_cc_canceled_by_fraud_qty_1d >= 3) AND ( user.maturity not in 'Pro' OR order.custom.mk_internal_model_scoring_bucket >= 97) AND ( user.segment not in 'Diamond','Power' OR order.custom.mk_internal_model_scoring_bucket >= 97) AND order.custom.mk_internal_model_scoring_bucket >= 71 AND order.amount_in_usd >= 6 AND user.customs.account_age <= 7 AND (payment_method.age.days <= 3 OR order.custom.mk_internal_model_scoring_bucket >= 97) AND (device.user_device_age <= 21 AND address.age.days <= 21) AND (features.mk_payer_fingerprint_device_approved_qty_90d <= 3 OR features.mk_fingerprint_address_approved_qty_90d <= 3 OR features.mk_payer_address_approved_qty_90d <= 3) AND (features.mk_user_is_whitelisted = false OR order.custom.mk_internal_model_scoring_bucket >= 97) AND (features.mk_payer_mins_since_first_approved_order > 0 OR (features.mk_payer_mins_since_first_approved_order = 0 AND order.amount_in_usd >= 15)) AND (features.mk_payer_cc_approved_qty_1d >= 2 OR features.mk_payer_cc_approved_qty_7d >= 3) return prevent with action('cc_validation_required',{'case_type':'-'}) 'Prueba_pca_1' payment_method.payment_type in 'credit_card' AND (((-0.176599)*(payment_method.age.days - (207.1500))+(0.201971)*(device.device_age.days - (436.1000))+(-0.872887)*(address.age.days - (300.0000))) <= -558) return allow 'cancel_geo_fs_test_allow' payment_method.payment_type in 'credit_card' AND (features_fs.fs_geohash7_cbk_qty_120d>features_fs.fs_geohash7_approved_qty_90d*0.4) AND (order.custom.mk_internal_model_scoring_bucket >=90) AND(payment_method.age.days<=7) return allow 'restriction_cancel_order_international_new_users_densif_allow' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND ((order.store_type in 'restaurant','restaurante' AND device.user_agent not contains 'Grability') OR order.store_type not in 'restaurant','restaurante') AND order.store_type not in list('CO_Vertical-All-CPGs') AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 3 AND (order.custom.micro_zone in list('CO_MZ-Densified') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Densified')) AND ((order.store_type in 'restaurant','restaurante' AND order.amount_in_usd >= 10 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.mk_internal_model_scoring_bucket > 70) OR order.store_type not in 'restaurant','restaurante') return allow 'restriction_cancel_order_international_risky_products_allow' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND order.items.any { product_name contains list('Global_Risky-Products')} return allow 'restriction_cancel_order_international_high_bucket_user_rest_allow' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.custom.mk_internal_model_scoring_bucket > 90 AND ((features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1h) >= 1 OR (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) >= 2) AND order.store_type in 'restaurant','restaurante' AND features.mk_payer_approved_qty_90d <= 20 return allow 'CANCEL_ORDER_DECISION_TREE_RESTAURANTS_RULE1_allow' payment_method.payment_type in 'credit_card' and order.store_type in 'restaurant' and order.custom.mk_internal_model_score <= 0.06 and ( (payment_method.country_code not in list('Global_Risky-International-BIN-Countries') and features.user_events_login_1d>2 and features.mk_device_cc_cancel_amount_6h>=24.4)or (payment_method.country_code in list('Global_Risky-International-BIN-Countries') and features.mk_device_cc_cancel_qty_90d >=44 and features.mk_payer_distinct_cc_fingerprint_90d > 5 and features.mk_payer_cc_cancel_amount_90d/features.mk_payer_cc_amount_90d > 0.727)or (payment_method.country_code in list('Global_Risky-International-BIN-Countries') and features.mk_device_cc_cancel_qty_90d >=44 and features.mk_payer_distinct_cc_fingerprint_90d > 5 and (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) <= 16)) return allow 'needs_validation_network_mr_allow' user.maturity not in 'Pro' AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) >= 20 AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' return allow 'needs_validation_rest_ip_geo_oct_allow' order.store_type contains 'restaurant' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND (payment_method.age.days <= 30 OR (address.age.days <= 7 AND device.user_device_age <= 7)) AND order.custom.mk_internal_model_scoring_bucket >= 91 AND (features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_device_is_safe_device_90d = 0 OR features.mk_payer_is_safe_user_cc_90d = 0) AND features.mk_payer_fingerprint_device_approved_qty_90d <= 12 AND order.amount_in_usd >= 4 AND (features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) >= 1 AND user.segment not in 'Diamond' AND user.maturity not in 'Pro' AND ((features.mk_payer_distinct_address_id_30d + features.mk_payer_distinct_store_type_30d + features.mk_payer_distinct_device_id_30d + features.mk_payer_distinct_store_30d + features.mk_payer_distinct_cc_fingerprint_30d) >= 4 OR (features.mk_payer_distinct_address_id_30d + features.mk_geohash_distinct_device_id_7d) >= 1 OR ((features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) > 0 AND features.mk_payer_distinct_cc_fingerprint_approved_30d >= 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0) OR (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d) OR (((features.mk_payer_cc_approved_amount_30d - features.mk_payer_cc_approved_amount_7d) * 0.7) < features.mk_payer_cc_approved_amount_7d) OR (user.customs.account_age >= 30 AND (features.user_by_device_events_is_known_device_for_login = 0 AND order.amount_in_usd >= 20))) AND (address.geohash_precision8 contains list('CO_GEOHASH8_TOTAL_FORENSIC_OCT20-JUN21') OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21') return allow 'cancel_order_decision_tree_restaurants_rule7_allow' payment_method.payment_type in 'credit_card' and order.store_type in 'restaurant' and (device.user_agent not contains 'Grability/7.6.1','Grability/7.7') and order.custom.mk_internal_model_score >= 0.2357 and features.mk_payer_distinct_cc_fingerprint_90d > 3 and device.user_device_age<=191 and features.mk_device_cc_cancel_qty_90d > 7 return allow 'cancel_order_ip_geo8_finance_behaviour_allow' payment_method.payment_type in 'credit_card' AND ((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d AND order.custom.mk_internal_model_scoring_bucket >= 91 AND order.amount_in_usd >= 11 AND ((features.mk_device_distinct_user_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_device_distinct_address_id_30d + features.mk_device_distinct_store_type_1d) >= 2 OR (features.mk_payer_distinct_address_id_30d + features.mk_fingerprint_distinct_address_id_30d + features.mk_device_distinct_address_id_30d) >= 3) AND (features.mk_payer_distinct_address_id_30d + features.mk_payer_distinct_store_type_1d + features.mk_payer_distinct_device_id_30d + features.mk_payer_distinct_store_1d + features.mk_payer_distinct_cc_fingerprint_30d) >= 3 AND (features.mk_device_distinct_user_id_30d >= 1 OR features.mk_payer_distinct_device_id_30d >= 1) AND features.mk_payer_distinct_cc_fingerprint_approved_30d >= 1 AND (((address.geohash_precision8 in list('CO_GEOHASH8_TOTAL_FORENSIC_OCT20-JUN21') OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) OR (order.custom.mk_internal_model_scoring_bucket >= 98 AND ((features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) > 0 AND features.mk_payer_distinct_cc_fingerprint_approved_30d >= 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0) AND features.mk_payer_fingerprint_device_approved_qty_90d <= 3 AND features.mk_geohash_cc_approved_qty_90d <= 3 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0 AND features.mk_device_is_safe_device_90d = 0 AND features.mk_payer_is_safe_user_cc_90d = 0 AND payment_method.age.days <= 1 AND address.age.days <= 3 AND device.user_device_age <= 3 AND order.amount_in_usd >= 20)) return allow 'NEEDS_VALIDATION_IP_GEO8_FINANCE_BEHAVIOUR_ALLOW' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND ((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d AND order.custom.mk_internal_model_scoring_bucket >= 91 AND ((order.store_type in list('CO_Vertical-All-CPGs') AND order.amount_in_usd >= 6) OR (order.store_type contains 'restaurant' AND order.amount_in_usd >= 6) OR (order.store_type in list('CO_Vertical-All-Ecommerce') AND order.amount_in_usd >= 18) OR (order.store_type in 'ultraservicio','ultraservice' AND order.amount_in_usd >= 60) OR (order.store_type in 'courier_hours' AND order.amount_in_usd >= 30)) AND (features.mk_device_distinct_user_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_device_distinct_address_id_30d + features.mk_device_distinct_store_type_1d) >= 2 AND (features.mk_payer_distinct_address_id_30d + features.mk_fingerprint_distinct_address_id_30d + features.mk_device_distinct_address_id_30d) >= 2 AND features.mk_payer_distinct_cc_fingerprint_approved_30d >= 1 AND (features.mk_payer_mins_since_last_approved_transaction <= 2160 OR features.mk_geohash_cc_approved_qty_7d <= 20) AND (((address.geohash_precision8 in list('CO_GEOHASH8_TOTAL_FORENSIC_OCT20-JUN21') OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) OR (order.custom.mk_internal_model_scoring_bucket >= 97 AND ((features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) > 0 AND features.mk_payer_distinct_cc_fingerprint_approved_30d >= 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0) AND features.mk_payer_fingerprint_device_approved_qty_90d <= 3 AND features.mk_geohash_cc_approved_qty_90d <= 3 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0 AND features.mk_device_is_safe_device_90d = 0 AND features.mk_payer_is_safe_user_cc_90d = 0 AND payment_method.age.days <= 3 AND address.age.days <= 3 AND device.user_device_age <= 3 AND order.amount_in_usd >= 20)) return allow 'cancel_order_cpgs_ip_geohash7_risk_forensic_non safe_network_allow' (order.store_type in list('CO_Vertical-All-CPGs') OR order.store.store_id in list ('CO_Fraud_Stores_CPGS_2doScore_Mayo') OR order.store.store_id in list ('CO_CPGs-2ndScore-Stores')) AND payment_method.payment_type in 'credit_card' AND (order.custom.mk_internal_model_scoring_bucket >= 91 OR ((order.custom.mk_internal_model_scoring_bucket < 91 AND order.custom.mk_internal_model_scoring_bucket >= 71) AND ( (features.mk_device_distinct_user_id_30d + features.mk_fingerprint_distinct_user_id_30d + features.mk_fingerprint_distinct_device_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_payer_distinct_device_id_30d + features.mk_payer_distinct_cc_fingerprint_30d) >= 6 OR (features.mk_device_distinct_user_id_7d + features.mk_fingerprint_distinct_user_id_7d + features.mk_fingerprint_distinct_device_id_7d + features.mk_device_distinct_cc_fingerprint_7d + features.mk_payer_distinct_device_id_7d + features.mk_payer_distinct_cc_fingerprint_7d) >= 2 OR (features.mk_payer_is_safe_user_cc_90d = 0 OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR features.mk_device_is_safe_device_90d = 0)))) AND (features.mk_payer_distinct_cc_fingerprint_approved_30d >= 1 OR features.user_events_login_15d >= 1 OR order.items.any { product_name contains list('Global_Risky-Products')}) AND order.amount_in_usd >= 4 AND features.mk_payer_mins_since_last_approved_transaction <= 25920 AND address.geohash_precision7 contains list('CO_GEOHASH7_CPGS_FORENSIC_MAR-MAY') AND device.ip in list('CO_IP_RISK_CPGS_FORENSIC_MAR-MAY') return allow 'cancel_order_decision_tree_restaurants_rule4_allow' payment_method.payment_type in 'credit_card' and order.store_type in 'restaurant' and order.custom.mk_internal_model_score > 0.18 and features.mk_device_cc_cancel_amount_90d<=207and features.mk_device_cc_amount_6h >7 and features.user_events_login_1d >2 return allow 'needs_validation_rest_forensic_allow' order.store_type contains 'restaurant' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND order.custom.mk_internal_model_scoring_bucket >= 95 AND (features.mk_device_distinct_user_id_30d + features.mk_fingerprint_distinct_user_id_30d + features.mk_fingerprint_distinct_device_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_payer_distinct_device_id_30d + features.user_events_add_card_qty_30d)>=1 AND address.geohash_precision8 contains list('CO_Rest-Forensic-GH8') AND device.user_agent contains list('CO_Rest-Forensic-Device') return allow 'needs_validation_rest_ip_geo_oct_2_allow' order.store_type contains 'restaurant' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success', 'Success' AND payment_method.card_franchise contains 'visa','Visa','master','Master' AND order.custom.mk_internal_model_scoring_bucket >= 71 AND user.customs.account_age >= 30 AND payment_method.age.days >= 30 AND (address.age.days <= 30 OR device.user_device_age <= 30) AND order.amount_in_usd >= 4 AND (features.mk_payer_distinct_address_id_30d + features.mk_fingerprint_distinct_address_id_30d + features.mk_device_distinct_address_id_30d + features.mk_device_distinct_user_id_30d) >= 1 AND features.mk_payer_cc_approved_qty_90d <= 80 AND features.mk_payer_fingerprint_device_approved_qty_90d <= 45 AND (((address.geohash_precision8 contains list('CO_GEOHASH8_TOTAL_FORENSIC_OCT20-JUN21') OR 'CO_Geohash-Risky-Behavior' in matching_smart_lists) AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21')) OR ( order.custom.mk_internal_model_scoring_bucket >= 91 AND order.amount_in_usd >= 6 AND payment_method.age.days <= 5 AND address.age.days <= 7 AND device.user_device_age <= 7 AND features.mk_fingerprint_is_safe_fingerprint_60d = 0 AND (features.mk_device_is_safe_device_60d = 0 OR features.user_by_device_events_is_known_device_for_login = 0) AND features.mk_payer_fingerprint_device_approved_qty_90d <= 5 AND features.mk_payer_fingerprint_device_approved_amount_90d <= 35 AND features.mk_geohash_cc_approved_qty_90d <= 7 AND (((features.user_events_add_card_qty_30d - features.user_events_add_card_failed_qty_30d) > 0 AND features.mk_payer_distinct_cc_fingerprint_approved_30d >= 1 AND features.mk_fingerprint_is_safe_fingerprint_90d = 0) OR ((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) AND features.mk_payer_cc_approved_qty_90d > 5) OR (user.customs.account_age > 90 AND (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d))))) return allow 'cancel_order_ato_no_safe_device_10d_strange_logins_allow' device.user_agent not contains list('CO_Devices-High-End') AND payment_method.payment_type not in 'cash' AND order.store_type not in 'restaurant' AND features.mk_device_is_safe_device_10d = 0 AND device.user_device_age = 0 AND order.amount > 0 AND user.customs.account_age > 7 AND features.user_events_login_1d >= 2 AND features.mk_geohash_canceled_by_fraud_qty_7d > 5 return allow 'cancel_order_cancellations_ato_allow' (features.mk_payer_amount_1d/(features.mk_payer_amount_90d-features.mk_payer_amount_1d)) > 1 AND features.mk_payer_canceled_by_user_qty_1d > 0 AND order.amount_in_usd >= 80 AND ((features.mk_payer_amount_90d-features.mk_payer_amount_1d) >= 200 OR features.mk_payer_canceled_by_user_amount_1d >= 200) return allow 'cancel_order_decision_tree_liquor_rule2_allow' payment_method.payment_type in 'credit_card' and order.store_type contains list('CO_Vertical-Liquor') and order.custom.mk_internal_model_score <= 0.11349 and ( (order.custom.mk_internal_model_score > 0.004 and (features.mk_payer_cc_cancel_amount_90d/features.mk_payer_cc_amount_90d) > 0.621 and order.amount_in_usd >= 157)or (order.custom.mk_internal_model_score <= 0.004 and features.mk_payer_distinct_address_id_30d <=8 and features.mk_device_cc_cancel_amount_6h>=412)) return allow 'cancel_order_decision_tree_restaurants_rule3_allow' payment_method.payment_type in 'credit_card' and order.store_type in 'restaurant' and order.custom.mk_internal_model_score > 0.06 and features.mk_device_cc_cancel_amount_90d>207and ((features.mk_device_cc_cancel_qty_90d >=74.5 and (payment_method.country_code in list('Global_Risky-International-BIN-Countries'))) or (features.mk_device_cc_cancel_qty_90d <74.5 and (features.mk_fingerprint_cancel_amount_90d/features.mk_fingerprint_amount_90d) <= 0.021 and features.user_events_login_1d > 1)) return allow 'cancel_order_decision_tree_restaurants_rule5_allow' payment_method.payment_type in 'credit_card' and order.store_type in 'restaurant' and (features.mk_device_cc_cancel_qty_90d >44 )and(features.mk_payer_distinct_cc_fingerprint_90d > 4) and payment_method.country_code not in list('Global_Risky-International-BIN-Countries')and ((order.custom.mk_internal_model_score < 0.18 and (features.mk_payer_cc_cancel_amount_90d/features.mk_payer_cc_amount_90d)>0.72) or (order.custom.mk_internal_model_score < 0.18 and (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d)<=16) or (order.custom.mk_internal_model_score > 0.18 and (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d)> 16) ) return allow 'CANCEL_ORDER_ECOMM_IP_GEOHASH_FORENSIC_MAR-JUL_ALLOW' (((order.store_type in list('CO_Vertical-Ecommerce-Tech') OR order.store_type in list('CO_Vertical-Ecommerce-SERVICES') OR order.store_type in list('CO_Vertical-Ecommerce-FASHION') OR order.store_type in list('CO_Vertical-Ecommerce-HOME') OR order.store_type in list('CO_Vertical-Ecommerce-GIFTS')) AND order.amount_in_usd >= 80) OR ((order.store_type in list('CO_Vertical-Ecommerce-SPORTS_OUTDOORS') OR order.store_type in list('CO_Vertical-Ecommerce-BABIES_KIDS') OR order.store_type in list('CO_Vertical-Ecommerce-HEALTH_BEAUTY') OR order.store_type in list('CO_Vertical-Ecommerce-PETS') OR order.store_type in list('CO_Vertical-Ecommerce-OTHER') OR order.store_type in list('CO_Vertical-Ecommerce-BOOKSTORES_STATIONARY')) AND order.amount_in_usd >= 25)) AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 94 AND features.mk_geohash_qty_7d >= 1 AND ((features.mk_geohash_distinct_cc_fingerprint_approved_7d + features.mk_geohash_distinct_device_id_7d) >= 1 OR features.mk_payer_distinct_device_id_30d >= 1) AND device.ip in list('CO_IP_RISK_ECOMM_FORENSIC_JUL') AND (order.custom.micro_zone in list('CO_MZ_RISK_ECOMM_FORENSIC_JUL') OR address.geohash_precision7 contains list('CO_GEOHASH7_RISK_ECOMM_FORENSIC_JUL')) AND (order.store.store_id in list('CO_ECOMM_RISK-STOREID-LIST_FORENSIC_JUL') OR order.store_type in list('CO_ECOMM_RISK-STORETYPE-LIST_FORENSIC_JUL') OR (features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) <= features.mk_payer_cc_approved_amount_30d) return allow 'CANCEL_ORDER_INT_DECISION_TREE_P4_DIC22_ALLOW' payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND ((user.customs.account_age = 0 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) > 0.55 AND device.user_agent contains 'Dalvik' AND features.mk_fingerprint_mins_since_last_approved_transaction <= 344.42) OR (user.customs.account_age > 0 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) > 0.64 AND features.mk_fingerprint_is_safe_fingerprint_10d = 0 AND features.mk_payer_approved_qty_90d > 33) OR (user.customs.account_age = 0 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) > 0.55 AND device.user_agent not contains 'Dalvik' AND order.items.any { product_name contains list('Global_Risky-Products')}) OR (user.customs.account_age = 0 AND (features.mk_geohash_cancel_qty_90d/features.mk_geohash_qty_90d) <= 0.65 AND features.crosses_user_fingerprint_qty_users_30d> 2.5 AND features.crosses_user_fingerprint_qty_users_failed<= 0.5)) AND order.custom.mk_internal_model_scoring_bucket >= 90 return allow 'needs_validation_new_ios_ALLOW' device.user_agent contains 'Grability' AND device.user_agent not contains list('CO_Devices-High-End') AND payment_method.payment_type in 'credit_card' AND features.mk_device_distinct_user_id_90d >= 5 AND payment_method.verification_status not in 'success','Success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return allow 'needs_validation_device_network_allow' payment_method.payment_type in 'credit_card' AND features.mk_device_distinct_user_id_90d >= 7 AND payment_method.verification_status not in 'success','Success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return allow 'cancel_order_by_new_users_finished_order>3_allow' features.mk_payer_approved_qty_1d > 3 AND user.customs.account_age_in_days = 0 AND payment_method.payment_type in 'credit_card' return allow 'needs_validation_risk_device_allow' device.user_agent contains list('CO_Devices-CBK-Upper-Risk') AND payment_method.payment_type = 'credit_card' AND user.power_user_alike_score < 30 AND payment_method.verification_status not in 'success' AND payment_method.card_bin not in list('CO_BIN-Local-Prepaid') return allow 'needs_validation_ip_geo8_forensic_mar2022_allow' payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success','Success' AND (order.store_type contains 'restaurant' OR order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type in list('CO_Vertical-All-Ecommerce') OR order.store_type in 'ultraservicio', 'ultraservice' ) AND order.custom.mk_internal_model_scoring_bucket >= 91 AND ((((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) OR payment_method.age.days < 1 OR (((features.mk_payer_cc_approved_amount_90d - features.mk_payer_cc_approved_amount_30d) * 0.7) < features.mk_payer_cc_approved_amount_30d)) AND (features.mk_payer_fingerprint_device_approved_qty_90d <= 7 OR features.mk_fingerprint_address_approved_qty_90d <= 7) AND ((features.mk_device_distinct_user_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_device_distinct_address_id_30d + features.mk_device_distinct_store_type_1d) >= 3 OR (features.mk_payer_distinct_address_id_30d + features.mk_payer_distinct_store_type_1d + features.mk_payer_distinct_device_id_30d + features.mk_payer_distinct_store_1d + features.mk_payer_distinct_cc_fingerprint_30d) >= 3 OR (features.mk_device_distinct_user_id_7d + features.mk_fingerprint_distinct_user_id_7d + features.mk_fingerprint_distinct_device_id_7d + features.mk_device_distinct_cc_fingerprint_7d + features.mk_payer_distinct_device_id_7d + features.mk_payer_distinct_cc_fingerprint_7d) >= 2) AND order.amount_in_usd >= 6 AND device.ip in list('CO_IP_TOTAL_FORENSIC_OCT20-JUN21') AND (address.geohash_precision8 in list('CO_GEOHASH8_TOTAL_FORENSIC_OCT20-JUN21') OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) return allow 'CANCEL_ORDER_RISKY_AMOUNT_SOB_ALLOW' payment_method.payment_type in 'rappi_pay_gateway_wallet', 'cash', 'credit_card' AND ((order.store_type = 'restaurant' AND order.store.self_onboarding = true AND order.amount <= 2000 AND (user.power_user_alike_score <= 10 OR user.hvu_prob <= 0.2) AND features.mk_payer_approved_amount_90d < 20 AND user.maturity in 'New', 'None', 'Amateur' AND device.user_agent contains 'Dalvik' AND user.email_verification_status = 'BOUNCED') OR (order.amount <= 50 AND order.store_type = 'restaurant' AND order.store.self_onboarding = true)) return allow 'CANCEL_ORDER_RPRODUCT_NEW_PSE_USER_ALLOW' payment_method.payment_type contains 'pse' AND user.customs.account_age = 0 AND order.custom.different_items_quantity <= 5 AND (user.email_verification_status in 'BOUNCED','DENIED' OR order.custom.different_items_quantity <= 3 OR order.items.count { unified_category_name contains list('Global_Risky_Category_Products')} >= 2) AND order.items.any { unified_category_name contains list('Global_Risky_Category_Products')} return allow 'Cancel_deposits_betplay_ALLOW' user.email_verification_status in 'BOUNCED' AND user.segment in 'Zero' AND order.store_type contains 'restaurant','Restaurant' AND payment_method.payment_type in 'Cash', 'cash' AND features.mk_payer_active_orders_qty > 1 return allow 'CANCEL_ORDER_CPGS_REST_HIGH_RISK_BIN_VELOCITY_ADD_CARD_FEB2023' (order.store_type in list('CO_Vertical-All-CPGs') OR order.store_type contains 'restaurant') AND payment_method.payment_type in 'credit_card' AND order.amount_in_usd > 10 AND order.custom.mk_internal_model_scoring_bucket > 90 AND features.user_events_add_card_qty_7d > 2 AND payment_method.age.days < 15 AND features.mk_payer_distinct_address_id_7d > 0 AND payment_method.card_bin in list('CO_BIN_HIGH_RISK_ADD_CARD_VELOCITY_FEB23') AND device.device_age <= 300 return allow ' CANCEL_ORDER_TECH_FORENSIC_NOV2022_FS_ALLOW' order.store_type in list('CO_Vertical-Ecommerce-Tech') AND payment_method.payment_type in 'credit_card' AND order.custom.mk_internal_model_scoring_bucket >= 80 AND order.amount_in_usd >= 48 AND user.maturity not in 'Pro' AND user.segment not in 'Diamond','Potential Diamond' AND (features.mk_payer_fingerprint_device_approved_qty_90d <= 1 OR address.age.days <= 2 OR features.mk_fingerprint_address_approved_qty_90d <= 2 ) AND (features.mk_device_distinct_user_id_30d + features.mk_fingerprint_distinct_user_id_30d + features.mk_fingerprint_distinct_device_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_payer_distinct_device_id_30d + features.mk_payer_distinct_cc_fingerprint_30d) >= 6 AND (((order.amount_in_usd > features.mk_payer_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_device_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_fingerprint_max_approved_amount_90d) OR (order.amount_in_usd > features.mk_payer_cc_approved_amount_90d)) AND features.mk_payer_mins_since_first_approved_order > 0) AND (features_fs.fs_geohash8_cbk_qty_120d > 0 OR features_fs.fs_geohash8_cbk_user_qty_120d > 0 OR 'CO_Geo8_Cbk__Maduration_def' in matching_smart_lists) return allow 'RESTRICTION_CANCEL_ORDER_SOAT_INTERNATIONAL_NEW_USERS_NON_DENSIF_HV_ALLOW' order.amount_in_usd >= 10 AND order.store.store_type not contains 'soat' AND order.amount_in_usd >= 35 AND (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND ((order.store_type in 'restaurant','restaurante' AND device.user_agent not contains 'Grability') OR order.store_type not in 'restaurant','restaurante') AND order.store_type not in list('CO_Vertical-All-CPGs') AND (features.mk_device_distinct_user_id_90d + features.mk_fingerprint_distinct_user_id_90d + features.mk_fingerprint_distinct_device_id_90d + features.mk_device_distinct_cc_fingerprint_90d + features.mk_payer_distinct_cc_fingerprint_90d + features.mk_payer_distinct_device_id_90d) > 0 AND order.custom.micro_zone not in list('CO_MZ-Densified') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Densified') AND (address.age.days <30) AND (features.mk_device_distinct_cc_fingerprint_90d >= 4 OR user.segment not in 'Zero' OR features.crosses_add_card_events_other_fingerprint_qty_fingerprints >= 4) AND order.store_type not in list('CO_Vertical-ECommerce') return allow 'CANCELLATION_TEMPORARY_CASH_BLOCK_1H_ULTRA_NEW_USER_COSTA' payment_method.payment_type = 'cash' AND user.segment in 'Zero' AND user.completed_orders <= 1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND address.geohash_precision7 startswith list('Macrozona_costa_santander') AND (features.mk_payer_cash_cancel_qty_1h >= 3 OR features.mk_device_cash_cancel_qty_1h >= 3 OR features.mk_payer_cancel_qty_1h >= 5) AND (device.user_agent not contains 'Grability' OR order.store_type not in 'restaurant' OR device.user_agent not contains list('CO_Devices-High-End')) return allow 'ALLIED_DISABLE_CASH_I_SOB_MARKETPLACE_ALLOW' order.store.self_onboarding = true AND payment_method.payment_type = 'cash' AND order.is_marketplace = true AND user.segment NOT in 'Potential Diamond', 'Power', 'Diamond' AND features.mk_payer_approved_qty_90d < 20 AND device.user_device_age <= 30 AND 'CO_Stores_Whitelist_v2' not in matching_smart_lists return allow 'RESTRICTION_NEEDS_VALIDATION_INTERNATIONAL_NEW_USERS_IOS_REST_ALLOW' (payment_method.country_code not in 'co','CO' OR payment_method.card_bin in list('CO_Bin-Direct-Compensation')) AND user.maturity in 'None','New','Amateur' AND payment_method.payment_type in 'credit_card' AND payment_method.verification_status not in 'success' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND features.mk_payer_approved_qty_90d <= 10 AND user.completed_orders < 15 AND order.store_type in 'restaurant','restaurante' AND device.user_agent contains 'Grability' AND ((features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1h) >= 1 OR (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_6h) >= 2 OR (order.is_marketplace = true AND order.store.store_id not in list('Non_fraud_marketplace_rests'))) AND (order.custom.mk_internal_model_scoring_bucket >= 80 OR order.amount_in_usd >= 10) AND payment_method.country_code not in 'us','US','pe','PE' AND order.custom.mk_internal_model_scoring_bucket > 75 AND order.amount_in_usd > 5 return allow 'accept_order_model' payment_method.payment_type = 'credit_card' return allow 'Disable_cash_max_order_turbo_allow' order.store.store_type in list('CO_Vertical-Turbo') AND (order.amount > 119000 OR user.maturity in 'New','None' OR user.completed_orders <= 1 OR features.mk_payer_approved_qty_90d < 3) AND payment_method.payment_type = 'cash' AND user.maturity not in 'Pro' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND (order.custom.items_quantity > 3 OR order.amount > 59000) return allow 'Disable_cash_max_order_turbo' order.store.store_type in list('CO_Vertical-Turbo') AND order.amount > 40000 AND features.mk_payer_approved_qty_90d <= 10 AND payment_method.payment_type = 'cash' AND user.maturity not in 'Pro' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.segment not in 'Diamond','Power' AND (order.custom.different_items_quantity <= 3 AND order.amount > 89000 OR order.custom.different_items_quantity < 2 AND order.amount > 59000) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_payless_wallet_new_user' payment_method.payment_type in 'cash','rappi_pay_gateway_wallet' AND order.store_type in list('CO_Vertical-All-CPGs') AND order.amount_in_usd >= 30 AND user.customs.account_age_in_days <= 30 AND order.custom.different_items_quantity <= 6 AND user.power_user_alike_score <= 40 AND (features.mk_payer_cancel_qty_6h >= 2 OR features.mk_payer_cancel_qty_1d >= 3) AND features.mk_payer_approved_qty_90d <= 10 AND (features.mk_payer_cancel_amount_6h - features.mk_payer_canceled_by_fraud_amount_6h - features.mk_payer_canceled_by_payment_error_amount_6h) >= 90 AND user.maturity in 'None','New', 'Amateur' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('cancel_order',{'case_type':'-'}) 'cancellation_cash_prevent_discount_new_user' user_restrictions.any {restriction == 'prevent_discount'} AND order.store_type in list('CO_Vertical-All-CPGs') AND payment_method.payment_type in 'cash' AND user.power_user_alike_score < 50 AND user.maturity in 'None','New','Amateur' AND user.customs.account_age_in_days <= 300 AND order.amount_in_usd >= 20 return block with action('cancel_order',{'case_type':'-'}) 'cancellation_cash_condom_abuse' payment_method.payment_type = 'cash' AND (user.maturity in 'New','None' OR user.completed_orders <= 1) AND order.items.any { product_name contains 'Rappicombo Climax Mutuo', 'preservativo', 'condon'} AND order.custom.different_items_quantity <= 2 AND order.amount >= 100000 AND order.items.any{quantity >= 3} return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_attack_high_cancellations' payment_method.payment_type = 'cash' AND device.user_agent NOT contains list('CO_Devices_High_End') AND order.store_type in list('CO_Vertical-Cash-rules') AND user.email_domain <> 'rappi.com' AND user.customs.account_age <= 30 AND mk_payer_cash_canceled_by_fraud_amount_1d > 20 AND features.mk_payer_approved_qty_90d <= 3 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation__cash_canceled_by_fraud_velocity_new' user.maturity in 'New', 'None' AND payment_method.payment_type = 'cash' AND (features.mk_payer_cash_canceled_by_fraud_qty_1h > 1 OR features.mk_payer_cash_canceled_by_fraud_qty_1d > 3 OR features.mk_payer_cash_canceled_by_fraud_qty_7d > 5) AND order.amount > 50000 AND device.user_agent not contains list('Global_Devices_iOS-High-End') AND features.user_events_add_card_qty_30d = 0 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_canceled_by_fraud_velocity_amateur' user.maturity = 'Amateur' AND payment_method.payment_type = 'cash' AND (features.mk_payer_cash_canceled_by_fraud_qty_1h > 2 OR features.mk_payer_cash_canceled_by_fraud_qty_1d > 4 OR features.mk_payer_cash_canceled_by_fraud_qty_7d > 6) AND order.amount > 25000 AND device.user_agent not contains list('Global_Devices_iOS-High-End') AND features.user_events_add_card_qty_30d = 0 AND features.user_events_login_1h >= 1 AND order.custom.items_quantity >2 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_canceled_by_fraud_velocity_pro' user.maturity in 'Semi Pro', 'Pro' AND payment_method.payment_type = 'cash' AND (features.mk_payer_cash_canceled_by_fraud_qty_1h > 3 OR features.mk_payer_cash_canceled_by_fraud_qty_1d > 6 OR features.mk_payer_cash_canceled_by_fraud_qty_7d > 9) AND order.amount > 25000 AND device.user_agent not contains list('Global_Devices_iOS-High-End') AND features.user_events_add_card_qty_30d = 0 return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_temp_rt_strike' 1=0 AND (user.power_user_alike_score < 35 OR user.hvu_prob < 0.1) AND payment_method.payment_type = 'cash' AND device.user_agent not contains list('CO_Devices-High-End') AND user.maturity in 'New','None','Amateur' AND address.geohash_precision7 startswith list('CO_rt_strike_geohash') AND features.mk_payer_approved_qty_90d <= 10 AND order.custom.digital_wallet_amount < 5000 AND user.completed_orders <= 10 return prevent with action('disable_cash',{'case_type':'-'}) 'Disable_Cash_address_high_risk' order.shipping_address.address1 in list('CO_Confirmed-fraud-addresses') return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_max_cash_amount' 1=0 AND payment_method.payment_type contains 'cash', 'Cash' AND payment_method.payment_type not in 'massive', '$massive' AND order.amount > 500000 return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_product_restrictions_rappicash_and_tu_boleta' payment_method.payment_type = 'cash' AND order.store_type in 'ultraservicio', 'ultraservice', 'ticket_events_web', 'viajes', 'viaje' return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_multiple_orders_in_progress' 1=0 AND payment_method.payment_type = 'cash' AND user.power_user_alike_score < 50 AND features.mk_payer_orders_qty > 0 AND features.mk_payer_canceled_by_user_qty / features.mk_payer_orders_qty > 0.20 AND features.mk_payer_active_orders_qty > 0 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_in_progress_hard_cap' payment_method.payment_type = 'cash' AND (features.mk_payer_active_orders_qty > 3 OR (features.mk_payer_cash_qty_1h - features.mk_payer_cash_cancel_qty_1h - features.mk_payer_cash_approved_qty_1h) > 2) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_payer_cancel_qty_1h >2 AND user.segment in 'Zero' AND device.user_devices_count >= 1 return prevent with action('disable_cash',{'case_type':'-'}) 'DISABLE_CASH_VELOCITY_CONDITIONS_1D' (payment_method.payment_type = 'cash') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_payer_approved_qty_90d < 15 AND ((features.mk_payer_cash_qty_1d>10) OR (features.mk_payer_cash_amount_1d>100) OR (features.mk_device_cash_qty_1d>10) OR (features.mk_device_cash_amount_1d>100) OR (features.mk_payer_store_qty_1h>4)) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_new_user_high_velocity_1h' 1=0 AND (user.maturity in 'New','None' OR features.mk_payer_approved_qty_90d < 15) AND (features.mk_payer_active_orders_qty+features.mk_payer_approved_qty_1h) >=3 AND payment_method.payment_type = 'cash' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_new_user_high_velocity_6h' 1=0 AND (user.maturity in 'New','None' OR features.mk_payer_approved_qty_90d < 15) AND (features.mk_payer_active_orders_qty+features.mk_payer_approved_qty_6h) >=5 AND payment_method.payment_type = 'cash' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_new_user_high_velocity_1d' 1=0 AND (user.maturity in 'New','None' OR features.mk_payer_approved_qty_90d < 15) AND (features.mk_payer_active_orders_qty+features.mk_payer_approved_qty_1d) >=7 AND payment_method.payment_type = 'cash' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_geohash5_madrugada' payment_method.payment_type = 'cash' AND address.geohash_precision7 startswith list('Geohash5-disable_cash_madrugada') AND user.customs.date_time_hour >= 1 AND user.customs.date_time_hour <= 6 AND order.store_type in 'restaurant','courier_hours' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND device.user_devices_count >= 1 AND features.mk_payer_canceled_by_fraud_qty_1h > 1 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_risky_zone' payment_method.payment_type = 'cash' AND order.custom.micro_zone in list('CO_Microzone-Cash') AND (user.customs.date_time_hour >= 21 OR user.customs.date_time_hour < 6) AND features.mk_payer_approved_qty_90d < 1 AND (user.power_user_alike_score < 10 OR user.hvu_prob < 0.1) AND features.mk_payer_mins_since_first_approved_order < 129600 return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_hr_quantity_rest' (user.maturity in 'New','None','Amateur' OR user.completed_orders < 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type in 'Cash', 'cash' AND order.custom.user_is_prime = false AND order.custom.different_items_quantity <= 2 AND order.custom.items_quantity> 10 AND order.store_type in 'restaurant', 'restaurante' AND user.power_user_alike_score < 35 AND (features.mk_payer_cash_cancel_amount_90d> 15) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_pickup_coupon_abuse' user.completed_orders <= 5 AND order.custom.coupon_type contains 'refered','first_time' AND order.delivery_method = 'pickup' AND features.mk_user_is_whitelisted = false AND order.custom.coupon_code not contains list('R4B_Coupons_whitelist') AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type in 'cash' AND order.store_type in 'restaurant' return prevent with action('disable_cash',{'case_type':'-'}) 'rt_fraud_atm_withdrawal' payment_method.payment_type = 'cash' AND address.geohash_precision7 startswith list('CO_Geohash-Bogot') AND order.custom.micro_zone NOT contains list('CO_MZ-Cash-Cuatro-Cinco') AND order.store.store_type in list('CO_Vertical-RT-ATM-Withdraw-Risk') AND order.items.any {product_name contains list('CO_Items-RT-Withdraw-Risk')} AND user.maturity <> 'Pro' AND ((device.user_device_age < 14 AND device.user_devices_count > 2) OR features.crosses_login_device_qty_users_90d > 2 OR features.crosses_registration_device_qty_users_90d > 0 OR features.mk_device_distinct_user_id_90d > 2 OR features.mk_payer_cash_canceled_by_fraud_amount_1h >= 100 OR features.mk_payer_cash_canceled_by_fraud_amount_1d >= 200 OR features.mk_geohash_cash_canceled_by_fraud_amount_1d >= 200 OR features.mk_payer_active_orders_qty > 1) AND order.amount >= 353000 return prevent with action('disable_cash',{'case_type':'-'}) 'FREEPASS_TOTAL_VALUE_LESS_THAN_5_USD_CASH' (payment_method.payment_type in 'cash','Cash') AND (order.store_type contains 'restaurant' ) AND (features.fake_users_user_email_score < -30 OR user.user_email contains '@privaterelay.appleid.com' ) AND(features.mk_payer_approved_qty_1h<=3) AND(features.mk_payer_approved_qty_1d<=3) AND (features.mk_device_distinct_user_new_1d<=1) AND (features.mk_fingerprint_distinct_user_id_1d <=4) AND (features.crosses_login_device_qty_users_90d<=5) AND (order.amount_in_usd<=5) return allow 'FREEPASS_TOTAL_VALUE_5_USD_CASH_NOT_IN_REST' (payment_method.payment_type in 'cash','Cash') AND (order_strore_type <> restaurants ) AND (features.fake_users_user_email_score < -30 OR user.user_email contains '@privaterelay.appleid.com' ) AND(features.mk_payer_approved_qty_1h<=3) AND(features.mk_payer_approved_qty_1d<=3) AND (features.mk_device_distinct_user_new_1d<=1) AND (features.mk_fingerprint_distinct_user_id_1d <=4) AND (features.crosses_login_device_qty_users_90d<=5) AND (order.amount_in_usd<=5) return allow 'free_pass_user_has_device_high_end' payment_method.payment_type = 'cash' AND device.user_agent contains list('CO_Devices-High-End') AND features.mk_payer_cash_canceled_by_user_qty_1d = 0 AND user.segment <> 'Zero' AND user.email_verification_status in 'SENT', 'VERIFIED' AND user.hvu_prob > 0.2 AND order.is_marketplace = false AND (user.customs.date_time_hour >= 6 AND user.customs.date_time_hour <= 23) return allow 'free_pass_users_greater_than_4_orders' payment_method.payment_type = 'cash' AND features.mk_payer_approved_qty_90d > 4 AND features.mk_payer_mins_since_first_approved_order > 10000 AND features.mk_payer_cash_canceled_by_user_qty_1d = 0 AND features.mk_payer_cash_qty_1h < 2 AND features.mk_payer_cash_approved_amount_90d >= 50 AND user.hvu_prob > 0.1 AND (user.customs.date_time_hour >= 6 AND user.customs.date_time_hour <= 23) AND features.mk_payer_cash_approved_amount_1h = 0 AND features.mk_payer_cash_approved_amount_1d < 100 AND features.mk_payer_cash_approved_amount_7d < 200 AND user.maturity not in 'New', 'None' AND features.crosses_registration_device_qty_users_90d < 2 AND features.crosses_login_device_qty_users_90d < 2 AND features.mk_device_distinct_user_id_90d <= 2 AND ('CO_CPGs-Store-Under-Attack' NOT in matching_smart_lists OR 'CO-Stores-Medium-Risk-Cash' NOT in matching_smart_lists) AND order.amount < 90000 return allow 'free_pass_users_greater_than_20_completed_orders' payment_method.payment_type = 'cash' AND user.completed_orders > 20 AND features.mk_payer_mins_since_first_approved_order > 10000 AND features.mk_payer_cash_canceled_by_user_qty_1d = 0 AND features.mk_payer_cash_approved_amount_1h = 0 AND features.mk_payer_cash_approved_amount_1d < 100 AND features.mk_payer_cash_approved_amount_7d < 200 AND features.crosses_registration_device_qty_users_90d < 2 AND features.crosses_login_device_qty_users_90d < 2 AND features.mk_device_distinct_user_id_90d <= 2 return allow 'free_pass_hvu_mz_4_and_5' payment_method.payment_type = 'cash' AND user.segment in 'Diamond','Potential Diamond','Power','Potential Power' AND order.custom.micro_zone in list('CO_MZ-Cash-Cuatro-Cinco') AND features.mk_payer_cash_canceled_by_user_qty_1d = 0 AND features.mk_payer_cash_approved_amount_1h <= 50 AND features.mk_payer_cash_approved_amount_1d <= 70 AND features.mk_payer_cash_approved_amount_7d <= 120 AND features.mk_payer_cash_approved_amount_30d <= 240 AND features.mk_payer_cash_approved_amount_90d >= 50 return allow 'free_pass_users_whitelist' payment_method.payment_type = 'cash' AND (features.mk_user_is_whitelisted = true OR order.custom.mk_user_has_freepass = true) return allow 'free_pass_cash_friction_reduction_v1' (features.mk_payer_store_qty_1d <1) AND (features.mk_device_cash_qty_90d <= 30) AND (features.mk_payer_cash_qty_1d < 2) AND (order.custom.totalwithtip <= 91517) AND(order.custom.applied_credits <= 30000) AND (order.amount_in_usd<15) AND (features.crosses_login_device_qty_users_7d<=1.5) AND (features.mk_payer_cash_amount_1d<2) AND (features.mk_device_cash_qty_1d<1) AND ((features.mk_device_cash_qty_30d <= 10 OR features.mk_payer_cash_qty_30d <= 10)OR (features.mk_device_cash_qty_90d>10 AND features.mk_device_cash_canceled_by_fraud_qty_90d<0.6*features.mk_device_cash_qty_90d) OR (features.mk_payer_cash_qty_90d>10 AND features.mk_payer_cash_canceled_by_fraud_qty_90d<0.6*features.mk_payer_cash_qty_90d)) AND (features.fake_users_user_email_score < 40 OR user.user_email contains '@privaterelay.appleid.com') return allow 'disable_cash_product_restrictions_max_amount_restaurant' 1=0 AND payment_method.payment_type = 'cash' AND order.amount > 280000 AND order.store_type = 'restaurant' return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_product_restrictions_courier' payment_method.payment_type = 'cash' AND order.store_type = 'courier_hours' AND user.email_verification_status NOT in 'SENT', 'VERIFIED' return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_courier_cancellation_risk' payment_method.payment_type = 'cash' AND order.store_type = 'courier_hours' AND features.rappi_favor_full_directions contains list('CO_Items-Courier-Cancellation-Risk') AND address.geohash_precision7 startswith list('CO_Geohash-Mosquera') AND user.customs.account_age < 15 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_rappifavor_risky_user' payment_method.payment_type = 'cash' AND order.store_type = 'courier_hours' AND features.mk_payer_approved_amount_90d < 10 AND user.maturity in 'New', 'None' AND (features.mk_payer_cash_canceled_by_user_qty_1h > 0 OR features.mk_payer_cash_canceled_by_user_qty_1d > 1) AND features.mk_payer_canceled_by_user_amount_90d / (features.mk_payer_canceled_by_user_amount_90d + features.mk_payer_approved_amount_90d) >= 0.5 AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.custom.micro_zone NOT in list('CO_MZ-Cash-Cuatro-Cinco') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_rappifavor_risky_geohash' payment_method.payment_type = 'cash' AND order.store_type = 'courier_hours' AND user.maturity in 'New', 'None', 'Amateur' AND (user.power_user_alike_score < 30 OR user.hvu_prob < 0.1) AND features.mk_payer_approved_amount_90d < 10 AND features.mk_geohash_cash_canceled_by_user_amount_30d >= 20 AND features.mk_geohash_cash_canceled_by_user_amount_30d / (features.mk_geohash_cash_canceled_by_user_amount_30d + features.mk_geohash_cash_approved_amount_30d) >= 0.5 AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.custom.micro_zone NOT in list('CO_MZ-Cash-Cuatro-Cinco') return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_first_order_risk_items' payment_method.payment_type = 'cash' AND user.email_verification_status in 'BOUNCED' AND order.amount < 60000 AND order.custom.discount > 0 AND order.custom.applied_credits > 0 AND user.segment in 'Zero' AND order.store_type not contains 'restaurant','Restaurant' AND features.user_events_login_1d >= 1 AND device.user_device_age < 30 AND order.custom.different_items_quantity >3 return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_first_order_risk_items_rest' payment_method.payment_type = 'cash' AND user.email_verification_status in 'BOUNCED' AND order.amount < 35000 AND order.custom.discount > 0 AND order.custom.applied_credits > 10000 AND user.segment in 'Zero' AND order.store_type contains 'restaurant','Restaurant' AND order.custom.items_quantity > 3 return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_user_is_rt_i' user.power_user_alike_score < 60 AND device.user_agent not contains list('CO_Devices-High-End') AND user.rt = true AND device.user_agent contains 'Dalvik','Grability' AND features.mk_device_distinct_user_id_90d > 3 AND payment_method.payment_type contains 'cash', 'Cash' return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_user_is_rt_ii' 1=0 AND user.power_user_alike_score < 20 AND user.rt = true AND payment_method.payment_type = 'cash' AND order.store_type in 'courier_hours','restaurant' AND device.user_agent contains 'Dalvik','Grability' AND device.user_agent not contains list('CO_Devices-High-End') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_fast_account_creation' 1=0 AND payment_method.payment_type = 'cash' AND user.customs.account_age_in_minutes < 5 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_new_user_velocity_last_hour' payment_method.payment_type = 'cash' AND user.customs.account_age < 7 AND (features.mk_payer_canceled_by_fraud_qty_1h > 0.5*features.mk_payer_cash_qty_1h) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_velocity_last_day' payment_method.payment_type = 'cash' AND user.power_user_alike_score < 30 AND features.mk_payer_cash_canceled_by_user_qty_1d > 1 AND features.mk_payer_canceled_by_user_qty / (user.completed_orders + features.mk_payer_canceled_by_user_qty) > 0.20 AND ((order.store.store_type = 'restaurant' AND features.mk_payer_approved_qty_90d < 3 AND device.user_agent NOT contains list('CO_Devices-High-End') AND user.power_user_alike_score < 15 AND features.mk_payer_mins_since_first_approved_order < 129600 AND order.amount > 35300) OR order.store.store_type <> 'restaurant') AND (features.mk_payer_canceled_by_fraud_qty_1h > 0.5*features.mk_payer_cash_qty_1h) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_multiple_users_same_device' payment_method.payment_type = 'cash' AND features.mk_device_distinct_user_id_90d >= 4 AND features.mk_payer_approved_qty_90d < 6 AND features.crosses_login_device_qty_users_90d >= 4 AND user.maturity in 'New','None' AND order.custom.mk_user_has_freepass = false AND features.mk_user_is_whitelisted = false return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_three_users_same_device_new' payment_method.payment_type = 'cash' AND features.mk_device_distinct_user_id_90d >= 3 AND order.store_type in list('CO_Vertical-Cash-rules') AND user.maturity in 'New','None','Amateur' AND features.mk_payer_approved_amount_90d < 25 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_two_users_same_device_new' payment_method.payment_type = 'cash' AND features.mk_device_distinct_user_id_90d >= 2 AND order.store_type in list('CO_Vertical-Cash-rules') AND user.maturity in 'New','None','Amateur' AND features.mk_payer_approved_amount_90d < 25 AND user.customs.account_age < 90 AND ((order.store_type in 'restaurant','restaurante' AND device.user_agent contains 'Grability' AND user.email_domain not in 'privaterelay.appleid.com' AND user.power_user_alike_score < 10 AND features.mk_payer_approved_qty_90d = 0) OR order.store_type not in 'restaurant','restaurante' OR device.user_agent not contains 'Grability') AND device.user_device_age = 0 AND device.user_devices_count > 1 AND order.amount >= 17650 AND (features.mk_payer_cash_cancel_amount_1d> 7.78) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_two_users_same_device_zero' 1=0 AND payment_method.payment_type = 'cash' AND features.mk_device_distinct_user_id_90d > 0 AND features.mk_payer_qty_90d = 0 AND user.segment = 'Zero' AND user.customs.account_age < 30 AND order.store_type in list('CO_Vertical-Cash-rules') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_funky_email' payment_method.payment_type = 'cash' AND features.account_email_username_fraction_vowels = 0 AND features.mk_payer_approved_qty_90d < 5 AND user.email_domain NOT in 'privaterelay.appleid.com' AND user.power_user_alike_score < 10 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_funky_email_ii' payment_method.payment_type = 'cash' AND user.segment NOT in 'Diamond','Power' AND user.user_email contains list('Global_risky_email') AND user.email_domain NOT in 'privaterelay.appleid.com' AND (features.mk_payer_cash_amount_1d> 9.7) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_restricted_domains' payment_method.payment_type = 'cash' AND (user.email_domain in list('CO_Domain-Risk') OR 'fake-email-domains' in matching_smart_lists) AND user.email_domain NOT in list('CO_Domain-False-Positive') return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_by_fraud_stores' 1=0 AND order.store.store_id in list('CO_Fraud-Stores_V2') AND payment_method.payment_type contains 'cash', 'Cash' AND user.segment not in 'Potential Diamond','Diamond','potential diamond','diamond' AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND device.user_agent not contains list('CO_Devices-High-End') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_wrong_hr' 1=0 AND user.email_verification_status in 'DENIED','BOUNCED' AND payment_method.payment_type = 'cash' AND user.maturity in 'New','None' AND order.store.store_id in list ('CO_Stores-High-Risk-Cash') AND features.mk_payer_approved_amount_90d < 25 AND user.hvu_prob < 0.2 AND user.user_email not contains list('CO_Domain-False-Positive') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_wrong_mr' user.email_verification_status in 'DENIED','BOUNCED' AND payment_method.payment_type = 'cash' AND user.maturity in 'New','None' AND order.store.store_id in list ('CO_Stores-Medium-Risk-Cash') AND features.mk_payer_approved_amount_90d < 25 AND user.hvu_prob < 0.2 AND user.user_email not contains list('CO_Domain-False-Positive') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_wrong' user.email_verification_status in 'DENIED','BOUNCED' AND payment_method.payment_type in 'cash', 'Cash' AND user.segment not in 'Diamond','Potential Diamond','Power','Potential Power' AND order.store.store_id not contains list ('CO_Stores-High-Risk-Cash') AND features.mk_payer_approved_qty_90d > 0 AND 1 = 0 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND user.user_email not contains list('CO_Domain-False-Positive') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_whim_new_users' order.store_type in 'courier_hours' AND payment_method.payment_type in 'cash' AND device.user_agent not contains list('CO_Devices-High-End') AND device.user_agent contains 'Dalvik' AND features.mk_payer_approved_qty_90d < 5 AND features.mk_device_distinct_user_id_90d >=2 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND user.maturity in 'New','None' return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_wallet_whim_new_users' order.store_type in 'courier_hours' AND payment_method.payment_type in 'rappi_pay_gateway_wallet' AND order.amount_in_usd < 2 AND device.user_agent not contains list('CO_Devices-High-End') AND features.mk_payer_approved_qty_90d < 5 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND (user.maturity in 'New','None' OR user.segment in 'Zero','null') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_rappipay_compensations' payment_method.payment_type in 'rappi_pay_gateway_wallet' AND order.store_type not in 'restaurant','restaurante' AND features.user_compensations_qty_1d > 0 AND user.segment in 'Zero', 'Null', 'null', 'None', 'none' AND order.amount_in_usd < 3 AND user.customs.account_age < 9 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancellation_cash_3u_android' order.store_type in 'restaurant','Restaurant','courier_hours' AND payment_method.payment_type in 'cash', 'Cash' AND device.user_agent contains 'Dalvik' AND features.mk_device_distinct_user_id_30d >= 3 AND features.mk_payer_approved_qty_90d < 5 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_stores_hr' payment_method.payment_type = 'cash' AND 'CO-Stores-High-Risk-Cash' in matching_smart_lists AND features.mk_payer_approved_qty_90d < 5 AND features.mk_payer_approved_amount_90d < 25 AND user.hvu_prob < 0.2 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_stores_mr_i' payment_method.payment_type = 'cash' AND 'CO-Stores-Medium-Risk-Cash' in matching_smart_lists AND user.customs.date_time_hour >= 21 AND features.mk_payer_approved_qty_90d < 5 AND features.mk_payer_approved_amount_90d < 25 AND user.hvu_prob < 0.2 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_stores_mr_ii' payment_method.payment_type = 'cash' AND 'CO-Stores-Medium-Risk-Cash' in matching_smart_lists AND user.customs.date_time_hour <= 6 AND features.mk_payer_approved_qty_90d < 5 AND features.mk_payer_approved_amount_90d < 25 AND user.hvu_prob < 0.2 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_stores_mr_iii' payment_method.payment_type = 'cash' AND 'CO-Stores-Medium-Risk-Cash' in matching_smart_lists AND order.amount > 40000 AND features.mk_payer_approved_qty_90d < 5 AND features.mk_payer_approved_amount_90d < 25 AND user.hvu_prob < 0.2 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_stores_lr_i' payment_method.payment_type in 'cash', 'Cash' AND 'CO-Stores-Low-Risk-Cash' in matching_smart_lists AND user.customs.date_time_hour > 22 AND features.mk_payer_approved_qty_90d < 5 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not in list('CO_MZ-Cash-Cuatro-Cinco') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_stores_lr_ii' 1=0 AND payment_method.payment_type in 'cash', 'Cash' AND 'CO-Stores-Low-Risk-Cash' in matching_smart_lists AND user.customs.date_time_hour < 6 AND features.mk_payer_approved_qty_90d < 5 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not in list('CO_MZ-Cash-Cuatro-Cinco') return allow 'Disable_cash_coupon_first_order' user.email_verification_status in 'DENIED','BOUNCED' AND order.custom.coupon_type in 'first_time', 'Refered', 'refered' AND order.amount < 50000 AND payment_method.payment_type in 'cash','Cash' AND user.user_email not contains list('CO_Domain-False-Positive') return prevent with action('disable_cash',{'case_type':'-'}) 'Disable_cash_coupon_first_order_domain_risk' (user.email_domain in list('CO_Domain-Risk') OR 'fake-email-domains' in matching_smart_lists) AND user.email_verification_status in 'DENIED','BOUNCED','SENT' AND order.custom.coupon_type in 'first_time', 'Refered', 'refered' AND order.amount < 50000 AND payment_method.payment_type in 'cash','Cash' AND user.user_email not in list('CO_Domain-False-Positive') return prevent with action('disable_cash',{'case_type':'-'}) 'Disable_cash_wrong_email_coupon_first_cash' 1=0 AND order.store_type contains list('CO_Stores-Low-Value-Cashless-Cancelations') AND user.email_verification_status in 'BOUNCED','ERROR' AND payment_method.payment_type in 'cash', 'Cash' AND order.custom.coupon_type contains 'refered' AND order.different_items_quantity <= 3 AND features.mk_payer_approved_qty_90d <= 5 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND user.user_email not contains list('CO_Domain-False-Positive') return prevent with action('disable_cash',{'case_type':'-'}) 'Disable_cash_wrong_domain_coupon_first_cash' 1=0 AND order.store_type contains list('CO_Stores-Low-Value-Cashless-Cancelations') AND (user.email_domain in list('CO_Domain-Risk') OR 'fake-email-domains' in matching_smart_lists) AND user.email_verification_status in 'DENIED','BOUNCED','SENT' AND payment_method.payment_type in 'cash', 'Cash' AND order.custom.coupon_type contains 'refered' AND order.different_items_quantity <= 3 AND features.mk_payer_approved_qty_90d <= 5 AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND user.user_email not contains list('CO_Domain-False-Positive') return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_coupon_first' user.email_verification_status in 'BOUNCED','ERROR' AND payment_method.payment_type in 'cash', 'Cash' AND order.custom.coupon_code contains list('CO_Coupon-Cashless-Cancelations-First-Order') AND features.mk_payer_approved_qty_90d < 5 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') AND user.user_email not contains list('CO_Domain-False-Positive') return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_coupon_cash_and' payment_method.payment_type in 'cash', 'Cash' AND order.custom.coupon_type contains 'refered' AND device.user_agent not contains list('CO_Devices-High-End') AND device.user_agent contains 'Dalvik' AND order.amount = 0 AND features.mk_payer_mins_since_first_approved_order < 14400 AND order.custom.applied_credits > 1 AND order.custom.micro_zone not contains list('CO_MZ-Cash-Cuatro-Cinco') return prevent with action('disable_cash',{'case_type':'-'}) 'DISABLE_CASH_RESTAURANT_CANCELATION_ABUSE' payment_method.payment_type in 'cash', 'Cash' AND 'CO_Restaurant_SOB_Cashless' in matching_smart_lists AND (features.mk_payer_cash_amount_90d> 19) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_max_cash_limit_new_user_all' payment_method.payment_type = 'cash' AND features.mk_payer_approved_qty_90d <= 1 AND order.amount >= 300000 AND user.maturity in 'New','None' return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_max_cash_limit_new_user_rest' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.amount_in_usd > 25 AND (user.power_user_alike_score < 10 OR user.hvu_prob < 0.3) AND features.mk_payer_approved_amount_90d < 25 AND user.maturity in 'New', 'None', 'Amateur' AND order.store.self_onboarding = false AND device.user_agent contains 'Dalvik' AND user.completed_orders = 0 AND user.segment in 'Zero', 'Low Value' AND (features.mk_payer_cash_amount_1d> 10) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_max_cash_limit_new_user_rest_self_onboarding' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.store.self_onboarding = true AND (order.custom.applied_credits + order.amount + order.custom.digital_wallet_amount + order.custom.discount) >= 70600 AND user.power_user_alike_score <= 30 AND features.mk_payer_approved_amount_90d < 20 AND user.maturity in 'New', 'None' return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_max_amount_rest_risky_device' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.amount >= 56480 AND user.maturity in 'New', 'None', 'Amateur' AND user.customs.account_age < 90 AND features.mk_payer_approved_amount_90d < 25 AND device.user_agent contains list('CO_Devices-Cash-Cashless-Cancellations') AND (features.mk_payer_cash_canceled_by_user_amount_30d > 0 OR features.mk_geohash_cash_canceled_by_user_qty_30d > 0 OR features.mk_device_distinct_user_id_90d > 1 OR device.user_devices_count > 1 OR features.crosses_registration_device_qty_users_90d > 0) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_max_amount_rest_risky_microzone_mz_4_and_5' 1= 0 AND (order.custom.micro_zone contains list('CO_MZ-Cuatro-Cinco') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Cuatro-Cinco')) AND payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.is_marketplace = false AND order.amount >= 45350 AND user.maturity in 'New', 'None', 'Amateur' AND user.customs.account_age < 20 AND features.mk_payer_approved_amount_90d < 5 AND user.power_user_alike_score = 0 AND (order.custom.micro_zone in list('CO_MZ-Cash-Cashless-Cancellations') OR address.geohash_precision7 in list('CO_Geohash-Restricted-Cash')) AND (features.mk_payer_cash_canceled_by_user_amount_30d > 0 OR features.mk_geohash_cash_canceled_by_user_amount_90d > 0 OR features.mk_device_distinct_user_id_90d > 1 OR device.user_devices_count > 1 OR features.crosses_registration_device_qty_users_90d > 0 OR user.customs.account_age < 30 OR features.mk_payer_cash_canceled_by_fraud_qty_7d > 0) return allow 'cancellation_cash_max_amount_rest_risky_microzone' order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') AND payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.is_marketplace = false AND order.amount >= 35300 AND user.maturity in 'New', 'None', 'Amateur' AND user.customs.account_age < 90 AND features.mk_payer_approved_amount_90d < 25 AND (user.power_user_alike_score < 30 OR user.power_user_alike_score = 100) AND (order.custom.micro_zone in list('CO_MZ-Cash-Cashless-Cancellations') OR address.geohash_precision7 in list('CO_Geohash-Restricted-Cash')) AND (features.mk_payer_cash_canceled_by_user_amount_30d > 0 OR features.mk_geohash_cash_canceled_by_user_amount_90d > 0 OR features.mk_device_distinct_user_id_90d > 1 OR device.user_devices_count > 1 OR features.crosses_registration_device_qty_users_90d > 0 OR user.customs.account_age < 30 OR features.mk_payer_cash_canceled_by_fraud_qty_7d > 0) AND (features.mk_payer_cash_amount_1d> 12.25 OR order.amount> 45000) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_restaurant_web_cashless_cancellations' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND user.segment = 'Zero' AND device.user_agent NOT contains 'Dalvik','Grability' AND ((user.customs.date_time_hour = 23 OR user.customs.date_time_hour < 6) OR features.mk_geohash_cash_canceled_by_user_qty_30d > 0) AND (features.mk_geohash_cash_canceled_by_user_qty_30d > features.mk_geohash_cash_qty_30d*0.5) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_restaurant_new_device_android' 1=0 AND payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0 AND device.user_agent contains 'Dalvik' AND device.user_devices_count > 1 AND device.device_age.hours < 1 AND features.user_events_login_1h > 0 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_restaurant_new_device_velocity' 1=0 AND payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0 AND device.user_devices_count > 1 AND device.device_age.hours < 1 AND features.user_events_login_1h > 0 AND features.mk_device_cash_cancel_qty_1h > 0 return prevent with action('disable_cash',{'case_type':'-'}) 'CANCELLATION_CASH_RESTAURANT_NEW_DEVICE' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0 AND device.user_devices_count > 2 AND device.device_age.hours < 1 AND features.user_events_login_1h > 1 AND features.mk_device_cash_cancel_qty_1h > 0 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_restaurant_device_cancel_perc' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND user.completed_orders = 0 AND features.mk_payer_approved_qty_90d = 0 AND features.mk_device_cash_cancel_qty_7d > 0 AND features.mk_device_cash_cancel_qty_90d / (features.mk_device_cash_cancel_qty_90d + features.mk_device_cash_approved_qty_90d) > 0.5 AND ((features.mk_device_distinct_user_id_90d > 1) OR (features.crosses_login_device_qty_users_90d + features.crosses_registration_device_qty_users_90d >= 1)) AND user.segment = 'Zero' return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_velocity_amount_rest_new' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND user.maturity in 'New','None','Amateur' AND user.segment in 'Zero', 'Low Value', 'Regular' AND user.completed_orders < 3 AND features.mk_payer_approved_qty_90d < 3 AND (features.mk_payer_cash_canceled_by_user_qty_1h > 0 OR features.mk_payer_cash_canceled_by_user_qty_1d > 1 OR features.mk_payer_canceled_by_user_qty_7d > 2) AND (order.amount + order.custom.discount) >= 35300 AND (features.mk_payer_cash_canceled_by_user_amount_90d / (features.mk_payer_cash_canceled_by_user_amount_90d + features.mk_payer_approved_amount_90d)) >= 0.5 AND order.items_quantity > 1 AND device.user_agent contains 'Dalvik' AND (features.mk_payer_cash_amount_1d> 7) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_restaurant_risky_ip_address' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.is_marketplace = false AND user.segment = 'Zero' AND features.mk_payer_approved_qty_90d = 0 AND user.customs.account_age <= 1 AND device.ip in list('CO_IP-Cashless-Cancellations') return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_max_cash_limit_new_user_rest_ii' 1=0 AND payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND user.completed_orders > 1 AND user.completed_orders < 5 AND order.amount > 98000 AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.custom.micro_zone NOT contains list('CO_MZ-Cash-Cuatro-Cinco') AND user.maturity in 'New','None' return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_max_amount_cpgs_new' payment_method.payment_type = 'cash' AND order.store_type in list('CO_Vertical-All-CPGs') AND user.segment in 'Zero', 'Low Value', 'Regular' AND order.custom.micro_zone NOT in list('CO_MZ-Cash-Cuatro-Cinco') AND (order.amount + order.custom.discount) > 247100 AND device.user_agent contains 'Dalvik' AND user.completed_orders < 3 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_max_amount_pharmacies_new' payment_method.payment_type = 'cash' AND order.store_type in list('CO_Vertical-Pharmacy') AND user.completed_orders < 4 AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.amount > 176500 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_in_progress_pharmacies_new' payment_method.payment_type = 'cash' AND order.store_type in list('CO_Vertical-Pharmacy') AND user.completed_orders < 4 AND device.user_agent NOT contains list('CO_Devices-High-End') AND (features.mk_payer_active_orders_qty + features.mk_payer_cash_qty_1h - features.mk_payer_canceled_by_fraud_qty_1h) > 0 AND (features.mk_payer_canceled_by_fraud_qty_1h > 0.5*features.mk_payer_cash_qty_1h) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_risky_items_pharmacies_new' 1=0 AND payment_method.payment_type = 'cash' AND order.store_type in list('CO_Vertical-Pharmacy') AND user.completed_orders <= 1 AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.custom.micro_zone NOT in list('CO_MZ-Cash-Cuatro-Cinco') AND order.items.any {product_name contains list('CO_Items-Pharmacy-High-Risk')} return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_in_progress_risky_verticals' payment_method.payment_type = 'cash' AND order.store_type in list('CO_Vertical-Cash-rules') AND (features.mk_payer_active_orders_qty > 1 OR (features.mk_payer_cash_qty_1h - features.mk_payer_cash_cancel_qty_1h - features.mk_payer_cash_approved_qty_1h) > 1) AND user.maturity in 'New','None','Amateur' AND features.mk_payer_approved_amount_90d < 25 AND (user.customs.account_age < 360 OR device.user_device_age < 180) AND (features.mk_payer_cash_amount_1h - features.mk_payer_cash_canceled_by_fraud_amount_1h) > 0 AND order.amount_in_usd / (features.mk_payer_cash_amount_1h - features.mk_payer_cash_canceled_by_fraud_amount_1h) >= 0.8 AND (features.mk_geohash_cash_canceled_by_user_amount_90d > 0 OR device.user_devices_count > 1 OR features.crosses_registration_device_qty_users_90d > 0 OR user.customs.account_age < 15) AND order.custom.micro_zone NOT in list('CO_MZ-Cash-Cuatro-Cinco') AND device.user_agent NOT contains list('CO_Devices-High-End') return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_rt_pay' payment_method.payment_type in 'cash', 'Cash' AND order.store_type in 'express' AND order.amount < 7000 AND order.custom.discount < 1 AND order.custom.applied_credits < 1 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_max_cash_limit_new_user_liquor' payment_method.payment_type = 'cash' AND order.store_type in list('CO_Vertical-Liquor') AND features.mk_payer_approved_amount_90d < 40 AND order.amount >= 250000 AND device.user_agent NOT contains list('CO_Devices-High-End') AND (features.mk_payer_canceled_by_user_qty > 0 OR features.mk_geohash_canceled_by_user_amount_7d >= 50 OR features.mk_payer_cash_canceled_by_fraud_qty_1h > 0 OR features.mk_payer_cash_canceled_by_fraud_qty_1d > 1) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_liquor' payment_method.payment_type = 'cash' AND order.store_type in list('CO_Vertical-Liquor') AND order.store.store_id in list ('CO_Stores-Cash-First-orders-Cancelations') AND features.mk_payer_approved_amount_90d < 40 AND features.mk_payer_mins_since_first_approved_order < 21600 AND device.user_agent NOT contains list('CO_Devices-High-End') AND (features.mk_payer_canceled_by_user_qty > 0 OR features.mk_geohash_canceled_by_user_amount_7d >= 50 OR features.mk_payer_cash_canceled_by_fraud_qty_1h > 0 OR features.mk_payer_cash_canceled_by_fraud_qty_1d > 1) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_liquor_mz' payment_method.payment_type = 'cash' AND user.maturity in 'New','None' AND order.custom.micro_zone in list('CO_MZ-Liquor-Cancelation-Risk') AND order.store_type in list('CO_Vertical-Liquor-Cancelations-Risk') AND features.mk_payer_approved_amount_90d < 40 AND device.user_agent NOT contains list('CO_Devices-High-End') AND (features.mk_payer_canceled_by_user_qty > 0 OR features.mk_geohash_canceled_by_user_amount_7d >= 50 OR features.mk_payer_cash_canceled_by_fraud_qty_1h > 0 OR features.mk_payer_cash_canceled_by_fraud_qty_1d > 1) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_chiper_new_users' payment_method.payment_type = 'cash' AND user.maturity in 'New','None' AND order.store_type in list('CO_vertical-Chiper') AND device.user_agent NOT contains list('CO_Devices-High-End') AND features.mk_payer_mins_since_first_approved_order < 43200 AND features.mk_payer_canceled_by_user_qty > 2 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_wrong_hr_chiper' payment_method.payment_type = 'cash' AND user.maturity in 'New','None' AND order.store_type in list('CO_vertical-Chiper') AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.store.store_id in list ('CO_Stores-High-Risk-Cash') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_liquor_cancellations' order.store_type contains list('CO_Vertical-Liquor') AND payment_method.payment_type = 'cash' AND device.user_device_age < 90 AND features.mk_device_distinct_user_id_90d > 1 AND order.amount >= 141200 AND user.maturity in 'New','None' AND (features.mk_payer_canceled_by_user_qty > 0 OR features.mk_geohash_canceled_by_user_amount_7d >= 50 OR features.mk_payer_cash_canceled_by_fraud_qty_1h > 0 OR features.mk_payer_cash_canceled_by_fraud_qty_1d > 1) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_liquor_cancellations_ii' payment_method.payment_type = 'cash' AND order.store.store_type in list('CO_Vertical-Liquor') AND user.maturity in 'New', 'None', 'Amateur' AND (user.power_user_alike_score < 40 OR user.hvu_prob < 0.1) AND device.user_agent NOT contains list('CO_Devices-High-End') AND features.mk_payer_cash_approved_qty_7d >= 4 AND features.mk_payer_cash_approved_amount_7d < 50 AND (user.power_user_alike_score < 10) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_0_fo_2_co' payment_method.payment_type = 'cash' AND order.store.store_type in list('CO_Vertical-Cash-rules') AND features.mk_payer_canceled_by_user_qty_7d >= 2 AND features.mk_payer_approved_qty_90d = 0 AND user.maturity in 'New', 'None' AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.custom.micro_zone NOT in list('CO_MZ-Cash-Cuatro-Cinco') AND (features.mk_payer_cash_cancel_qty_1d> 2.5) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_1_fo_3_co' 1=0 AND payment_method.payment_type = 'cash' AND order.store.store_type in list('CO_Vertical-Cash-rules') AND features.mk_payer_canceled_by_user_qty >= 3 AND features.mk_payer_approved_qty_90d = 1 AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.custom.micro_zone NOT in list('CO_MZ-Cash-Cuatro-Cinco') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_2_fo_4_co' 1=0 AND payment_method.payment_type = 'cash' AND order.store.store_type in list('CO_Vertical-Cash-rules') AND features.mk_payer_canceled_by_user_qty >= 4 AND features.mk_payer_approved_qty_90d >= 2 AND features.mk_payer_approved_qty_90d < 4 AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.custom.micro_zone NOT in list('CO_MZ-Cash-Cuatro-Cinco') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_0_fo_1_co_wrong_email' 1=0 AND payment_method.payment_type = 'cash' AND user.completed_orders = 0 AND (features.mk_payer_canceled_by_user_qty > 0 OR (features.mk_payer_cash_qty_1h - features.mk_payer_cash_canceled_by_fraud_qty_1h) > 0) AND user.email_verification_status in 'BOUNCED','DENIED' AND features.mk_payer_approved_amount_90d < 25 AND user.hvu_prob < 0.1 AND user.user_email NOT contains list('CO_Domain-False-Positive') AND order.store.store_type in list('CO_Vertical-Cash-rules') return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_liquor_manual_assignment' payment_method.payment_type = 'cash' AND order.store.store_type in list('CO_Vertical-Liquor') AND order.amount > 88250 AND device.user_agent NOT contains list('CO_Devices-High-End') AND address.geohash_precision8 startswith list('Global_Geohashes-Manual-Assignment') AND features.mk_payer_mins_since_first_approved_order < 172800 AND (features.mk_payer_cash_approved_amount_1h >= 50 OR features.mk_payer_cash_approved_amount_1d >= 70 OR features.mk_payer_cash_approved_amount_7d >= 120 OR features.mk_payer_cash_approved_amount_30d >= 240) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_turbo_manual_assignment' payment_method.payment_type = 'cash' AND order.store.store_type in list('CO_Vertical-Turbo') AND user.maturity = 'Amateur' AND (features.mk_device_distinct_user_id_90d > 1 OR (device.user_devices_count > 1 AND device.user_device_age < 7)) AND (features.mk_payer_cash_approved_amount_1h >= 40 OR features.mk_payer_cash_approved_amount_1d >= 60) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_max_amount_whim_new' 1=0 AND order.store_type = 'courier_hours' AND payment_method.payment_type = 'cash' AND features.mk_payer_approved_qty_90d< 3 AND order.amount > 141200 AND user.segment in 'Zero', 'Low Value' return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_rest_mktpl_comp_wrong' payment_method.payment_type = 'cash' AND user.email_verification_status in 'BOUNCED', 'ERROR' AND order.is_marketplace = true AND user.segment NOT in 'Potential Diamond', 'Power', 'Diamond' AND user.power_user_alike_score < 35 AND features.mk_payer_approved_qty_90d < 10 AND user.user_email not contains list('CO_Domain-False-Positive') AND (features.mk_payer_cash_cancel_amount_1d> 14) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_rest_mktpl_comp_network' payment_method.payment_type = 'cash' AND features.mk_device_distinct_user_id_90d > 2 AND order.is_marketplace = true AND (features.mk_payer_cash_approved_amount_1d > 20 OR features.mk_payer_cash_approved_amount_7d > 60 OR features.mk_payer_cash_approved_amount_30d > 200) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_rest_mktpl_comp_device' payment_method.payment_type = 'cash' AND device.user_agent contains list('CO_Devices-Rest-MKP-Comp') AND order.amount > 35300 AND order.is_marketplace = true AND features.mk_payer_mins_since_first_approved_order < 129600 AND features.mk_payer_approved_qty_90d < 10 AND (features.mk_device_cash_amount_1d> 10.8) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_rest_mktpl_comp_in_progress' payment_method.payment_type = 'cash' AND order.is_marketplace = true AND features.mk_payer_active_orders_qty > 0 AND (user.maturity in 'New', 'None' OR user.completed_orders < 5) AND order.amount > 35300 AND (features.mk_payer_cash_cancel_amount_90d> 10.8) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_rest_mktpl_comp_max_amount' payment_method.payment_type = 'cash' AND order.is_marketplace = true AND order.amount_in_usd >= 25 AND (user.maturity in 'New', 'None' OR user.completed_orders < 5) AND device.user_agent NOT in list('CO_Devices-High-End') return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_rest_mktpl_comp_risky_ip' payment_method.payment_type = 'cash' AND order.is_marketplace = true AND features.mk_payer_approved_qty_90d < 10 AND device.ip in list('CO_IP-Rest-MKP-Comp') return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_high_risk_users_i_mz_4_and_5' (order.custom.micro_zone contains list('CO_MZ-Cuatro-Cinco') OR address.geohash_precision7 startswith list('CO_Geohash6_MZ-Cuatro-Cinco')) AND payment_method.payment_type = 'cash' AND user.segment = 'Zero' AND user.power_user_alike_score < 10 AND user.email_verification_status in 'BOUNCED','DENIED' AND user.user_email NOT contains list('CO_Domain-False-Positive') AND order.custom.mk_user_has_freepass = false AND features.mk_geohash_canceled_by_user_amount_90d >= 29 AND (features.mk_payer_cash_canceled_by_user_amount_30d > 0 OR features.mk_geohash_cash_canceled_by_user_amount_90d > 0 OR features.mk_device_distinct_user_id_90d > 1 OR device.user_devices_count > 1 OR features.crosses_registration_device_qty_users_90d > 0 OR features.mk_payer_cash_canceled_by_fraud_qty_7d > 0) AND order.amount_in_usd >= 5 AND order.store_type = 'restaurant' AND (features.mk_payer_cash_amount_1d> 12) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_high_risk_users_i' order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') AND payment_method.payment_type = 'cash' AND user.segment = 'Zero' AND (user.power_user_alike_score < 10 OR user.hvu_prob < 0.1) AND user.email_verification_status in 'BOUNCED','DENIED' AND user.user_email NOT contains list('CO_Domain-False-Positive') AND order.custom.mk_user_has_freepass = false AND (features.mk_payer_cash_canceled_by_user_amount_30d > 0 OR features.mk_geohash_cash_canceled_by_user_amount_90d > 0 OR features.mk_device_distinct_user_id_90d > 1 OR device.user_devices_count > 1 OR features.crosses_registration_device_qty_users_90d > 0 OR user.customs.account_age < 30 OR features.mk_payer_cash_canceled_by_fraud_qty_7d > 0) AND (features.mk_device_cash_qty_1d> 0.5) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_high_risk_users_ii' 1=0 AND payment_method.payment_type = 'cash' AND user.segment = 'Zero' AND features.mk_payer_canceled_by_user_qty_7d > 0 AND order.store_type in list('CO_Vertical-Cash-rules') AND order.store.store_type NOT in 'restaurant' return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_restricted_geohash' 1 = 0 AND payment_method.payment_type = 'cash' AND address.geohash_precision8 startswith list('CO_Geohash-Restricted-Cash') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.maturity in 'New', 'None', 'Amateur' AND (features.mk_payer_cash_canceled_by_user_qty_1d > 0 OR features.mk_geohash_cash_canceled_by_user_amount_90d > 0 OR features.mk_device_distinct_user_id_90d > 1 OR features.crosses_registration_device_qty_users_90d > 0 OR user.customs.account_age < 7 OR features.mk_payer_cash_canceled_by_fraud_qty_1d > 0 OR features.mk_payer_active_orders_qty > 0 OR (features.mk_payer_cash_qty_1h - features.mk_payer_cash_canceled_by_fraud_qty_1h - features.mk_payer_cash_canceled_by_user_qty_1h) > 0) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_fraud_La_calera' payment_method.payment_type = 'cash' AND address.geohash_precision7 startswith list('geohash-fraud-la-calera') AND (user.maturity in 'New', 'None' OR (user.segment = 'Low Value' AND (device.user_devices_count >= 2 OR features.mk_payer_distinct_device_id_90d >= 2) AND device.user_device_age < 7) OR user.email_verification_status in 'BOUNCED','DENIED') AND order.store_type not in 'restaurant' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_in_progress_new_user' 1=0 AND features.mk_payer_active_orders_qty > 1 AND user.maturity in 'New','None' AND payment_method.payment_type = 'cash' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.completed_orders <= 1 return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_split_new_user' user.maturity in 'New','None' AND payment_method.payment_type = 'cash' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.order_split.count_orders_by_split_id >= 2 AND order.amount < 14120 AND features.mk_geohash_cash_approved_amount_90d > 353000 AND user.completed_orders = 0 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_emails_created_by_bots' user.completed_orders = 0 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type = 'cash' AND user.user_email startswith list('CO_Email_Created_Bots') AND (user.customs.account_age < 15 OR device.user_device_age = 0) AND (((features.mk_payer_store_qty_1d<= 2.5) AND (features.mk_payer_cash_amount_1d> 11.8)) OR ((features.mk_payer_store_qty_1d> 2.5) AND (features.mk_payer_cash_amount_90d<= 7.75))) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_rest_mktpl_free_shipping_new' payment_method.payment_type = 'cash' AND order.store.store_type = 'restaurant' AND order.is_marketplace = true AND user.segment = 'Zero' AND user.completed_orders = 0 AND order.custom.discount >= order.custom.shipping_cost AND order.amount < 10000 AND (order.amount + order.custom.discount) <= 20000 AND order.custom.shipping_cost > 5000 AND features.mk_geohash_qty_7d > 1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND device.user_agent contains 'Dalvik' AND device.user_agent NOT contains list('CO_Devices-High-End') AND order.store.store_id not in list('Non_fraud_marketplace_rests') AND (features.mk_payer_cash_amount_1d> 3) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_dispersion_abuse' features.mk_geohash_cancel_qty_1h > 3 AND user.maturity in 'Amateur','New','None' AND order.store_type in list('CO_store_type_dispersion_abuse') AND device.user_agent not contains list('CO_Devices-High-End') AND order.amount > 229450 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_killer_fraude_aliado_madrugada' payment_method.payment_type in 'cash' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.maturity in 'Amateur','New','None' AND (features.mk_payer_store_cancel_qty_12h - features.mk_payer_store_canceled_by_fraud_qty_12h - features.mk_payer_canceled_by_payment_error_qty_12h >= 1) AND order.store_type = 'restaurant' AND user.customs.date_time_hour >= 1 AND user.customs.date_time_hour <= 6 AND features.mk_payer_cancel_qty_12h >4 AND features.mk_payer_cancel_qty_1h >2 return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_restaurant_pickup_new_nios' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.delivery_method = 'pickup' AND user.maturity in 'New', 'None' AND device.user_agent NOT contains 'Grability' AND (features.mk_payer_store_qty_1d> 1) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_restaurant_pickup_new_nios_ii' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.delivery_method = 'pickup' AND device.user_agent NOT contains 'Grability' AND device.user_agent NOT contains list('CO_Devices-High-End') AND user.segment in 'Zero', 'Low Value', 'Regular' AND (order.amount + order.custom.discount) > 70600 AND user.completed_orders < 5 return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_restaurant_pickup_invalid_nios' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.delivery_method = 'pickup' AND device.user_agent NOT contains 'Grability' AND device.user_agent NOT contains list('CO_Devices-High-End') AND user.segment in 'Zero', 'Low Value', 'Regular' AND (order.amount + order.custom.discount) > 70600 AND user.email_verification_status NOT in 'SENT', 'VERIFIED' return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_restaurant_pickup_new_ios' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.delivery_method = 'pickup' AND device.user_agent contains 'Grability' AND (features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1d) > 1 return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_restaurant_pickup_new_ios_ii' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.delivery_method = 'pickup' AND user.maturity in 'New', 'None' AND device.user_agent contains 'Grability' AND ((features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1d) > 1 OR features.mk_device_distinct_user_id_90d > 1 OR device.user_devices_count > 1 OR features.crosses_registration_device_qty_users_90d > 1) AND user.segment in 'Zero', 'Low Value', 'Regular' AND (order.amount + order.custom.discount) > 70600 AND user.completed_orders < 5 return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_restaurant_pickup_invalid_ios' payment_method.payment_type = 'cash' AND order.store_type = 'restaurant' AND order.delivery_method = 'pickup' AND device.user_agent contains 'Grability' AND ((features.mk_payer_active_orders_qty + features.mk_payer_approved_qty_1d) > 1 OR features.mk_device_distinct_user_id_90d > 1 OR device.user_devices_count > 1 OR features.crosses_registration_device_qty_users_90d > 1) AND user.segment in 'Zero', 'Low Value', 'Regular' AND (order.amount + order.custom.discount) > 70600 AND user.email_verification_status NOT in 'SENT', 'VERIFIED' return prevent with action('disable_cash',{'case_type':'-'}) 'DISABLE_CASH_RESTAURANT_PICKUP_ABUSE' payment_method.payment_type in 'cash','Cash' AND 'CO_Stores_PickUp-Abuse' in matching_smart_lists AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND store.self_onboarding = true return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_max_amount_costa' payment_method.payment_type = 'cash' AND address.geohash_precision7 startswith list('Macrozona_costa_santander') AND order.amount > 150000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_late_night_amount' payment_method.payment_type = 'cash' AND order.amount > 90000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (user.customs.date_time_hour >= 23 OR user.customs.date_time_hour < 6) AND device.user_devices_count >= 1 AND features.mk_payer_approved_qty_1d >= 1 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_late_night_new_user' payment_method.payment_type = 'cash' AND features.mk_payer_approved_qty_90d < 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (user.customs.date_time_hour >= 23 OR user.customs.date_time_hour < 6) AND order.amount > 30000 AND (order.amount > 35000 OR address.geohash_precision7 startswith list('Barranquilla-geohash-sur') OR user.rt = true OR user.customs.account_age > device.user_device_age OR user.customs.account_age > address.age.days OR device.user_devices_count >= 2 OR features.mk_device_distinct_user_id_90d >= 2 OR features.user_events_login_1h >= 1) AND device.user_devices_count >= 1 AND user.segment in 'Zero', 'Low Value' return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_marketplace_costa_nios' payment_method.payment_type = 'cash' AND device.user_agent NOT contains 'Grability' AND user.completed_orders <= 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND address.geohash_precision7 startswith list('Macrozona_costa_santander') AND order.store_type = 'restaurant' AND order.is_marketplace = true AND order.store.store_id not in list('Non_fraud_marketplace_rests') AND order.amount > 25000 AND (order.amount > 45000 OR address.geohash_precision7 startswith list('Barranquilla-geohash-sur') OR user.rt = true OR user.customs.account_age > device.user_device_age OR user.customs.account_age > address.age.days OR device.user_devices_count >= 2 OR features.mk_device_distinct_user_id_90d >= 2 OR features.user_events_login_1h >= 1) return prevent with action('disable_cash',{'case_type':'-'}) 'disable_cash_marketplace_costa_ios' payment_method.payment_type = 'cash' AND device.user_agent contains 'Grability' AND (device.user_agent NOT contains list('CO_Devices-High-End') OR order.custom.applied_credits > 14000) AND user.completed_orders <= 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND address.geohash_precision7 startswith list('Macrozona_costa_santander') AND order.store_type = 'restaurant' AND order.is_marketplace = true AND order.store.store_id not in list('Non_fraud_marketplace_rests') AND order.amount > 25000 AND (order.amount > 65000 OR address.geohash_precision7 startswith list('Barranquilla-geohash-sur') OR user.rt = true OR user.customs.account_age > device.user_device_age OR user.customs.account_age > address.age.days OR device.user_devices_count >= 2 OR features.mk_device_distinct_user_id_90d >= 2 OR features.user_events_login_1h >= 1) return prevent with action('disable_cash',{'case_type':'-'}) 'CANCELLATION_TEMPORARY_CASH_BLOCK_1H_ULTRA_NEW_USER_COSTA' 1=0 AND payment_method.payment_type = 'cash' AND user.segment in 'Zero' AND user.completed_orders <= 1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND address.geohash_precision7 startswith list('Macrozona_costa_santander') AND (features.mk_payer_cash_cancel_qty_1h >= 3 OR features.mk_device_cash_cancel_qty_1h >= 3 OR features.mk_payer_cancel_qty_1h >= 5) AND (device.user_agent not contains 'Grability' OR order.store_type not in 'restaurant' OR device.user_agent not contains list('CO_Devices-High-End')) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_temporary_cash_block_6h_ultra_new_user_costa' payment_method.payment_type = 'cash' AND user.segment in 'Zero' AND user.completed_orders <= 1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND address.geohash_precision7 startswith list('Macrozona_costa_santander') AND (features.mk_payer_cash_cancel_qty_6h >= 6 OR features.mk_device_cash_cancel_qty_6h >= 6 OR features.mk_payer_cancel_qty_6h >= 9) AND (device.user_agent not contains 'Grability' OR order.store_type not in 'restaurant' OR device.user_agent not contains list('CO_Devices-High-End')) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_temporary_cash_block_1d_ultra_new_user_costa' payment_method.payment_type = 'cash' AND user.segment in 'Zero' AND user.completed_orders <= 1 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND address.geohash_precision7 startswith list('Macrozona_costa_santander') AND (features.mk_payer_cash_cancel_qty_1d >= 9 OR features.mk_device_cash_cancel_qty_1d >= 9 OR features.mk_payer_cancel_qty_1d >= 12) AND (device.user_agent not contains 'Grability' OR order.store_type not in 'restaurant' OR device.user_agent not contains list('CO_Devices-High-End')) return prevent with action('disable_cash',{'case_type':'-'}) 'test_disable_cash_killer_mktplace' payment_method.payment_type = 'cash' AND user.completed_orders <= 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type = 'restaurant' AND order.is_marketplace = true AND order.amount >= 39900 AND ( user.customs.account_age > device.user_device_age OR user.customs.account_age > address.age.days OR device.user_devices_count >= 2 OR features.mk_device_distinct_user_id_90d >= 2 OR features.user_events_login_1h >= 1) AND order.store.store_id not in list('Non_fraud_marketplace_rests') AND (features.mk_payer_cash_cancel_amount_90d>100 OR features.mk_payer_cash_amount_1d>20) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_temp_disable_cash_1st_order_cpg_galerias' 1=0 AND payment_method.payment_type = 'cash' AND (user.completed_orders = 0 OR features.mk_payer_approved_amount_90d < 10) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.order_type in 'express_picker','market','express' AND address.geohash_precision7 startswith list('Bogota-geohash-galerias') AND (user.customs.account_age < 60 OR device.user_device_age = 0) return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_cpgs_cancellations_risk' payment_method.payment_type = 'cash' AND user.segment = 'Zero' AND device.user_agent contains 'Dalvik' AND order.order_type in 'express_picker', 'express', 'market' AND address.geohash_precision7 startswith list('CO_Geohash-Bogot') AND (device.user_devices_count > 2 OR user.customs.account_age_in_minutes < 400) AND device.user_device_age < 30 return prevent with action('disable_cash',{'case_type':'-'}) 'cancellation_cash_cpgs_cancellations_velocity' payment_method.payment_type = 'cash' AND user.segment = 'Zero' AND order.order_type in 'express_picker', 'express', 'market' AND address.geohash_precision7 startswith list('CO_Geohash-Bogot') AND (features.mk_payer_cash_qty_1h - features.mk_payer_canceled_by_fraud_qty_1h) > 0 AND (features.mk_payer_canceled_by_fraud_qty_1h > 0.5*features.mk_payer_cash_qty_1h) return prevent with action('disable_cash',{'case_type':'-'}) 'TEMP_CANCELLATION_CASH_RAPPIFAVOR_ZERO' payment_method.payment_type = 'cash' AND order.store_type = 'courier_hours' AND (user.segment = 'Zero' OR user.customs.account_age < 10 OR user.completed_orders < 3 OR (user.segment = 'Low Value' AND device.user_devices_count >= 2 AND device.device_age = 0)) return prevent with action('disable_cash',{'case_type':'-'}) ruleset 'DNP OFF' 'DNP_Nequi_1_SPLIT' 1 = 0 AND user.completed_orders <= 1 AND payment_method.payment_type in 'nequi', 'rappi_pay' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.order_split.count_orders_by_split_id >= 2 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Nequi_2_First_Orders_Low_Value_Liq' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND order.amount < 51000 AND payment_method.payment_type in 'nequi', 'rappi_pay' AND order.store_type contains list('CO_Vertical-Liquor') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_geohash_qty_1d >= 1 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Nequi_3_First_Orders_Low_Value_Pha' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND order.amount < 51000 AND payment_method.payment_type in 'nequi', 'rappi_pay' AND order.store_type contains list('CO_Vertical-Pharmacy') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_geohash_qty_1d >= 1 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Nequi_4_First_Orders_Low_Value_Express' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND order.order_type in 'express_picker','market','express' AND payment_method.payment_type in 'nequi','rappi_pay' AND order.amount < 51000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_geohash_qty_1d >= 1 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Nequi_5_Email_Bounced' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'rappi_pay','nequi' AND user.email_verification_status in 'BOUNCED','DENIED' AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') AND user.user_email not contains list('CO_Domain-False-Positive') AND order.amount < 51000 AND order.store_type not in 'restaurant','Restaurant' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Nequi_6_Device_network' 1 = 0 AND payment_method.payment_type in 'nequi','rappi_pay' AND user.maturity in 'None','New','Amateur' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_device_distinct_user_id_90d >= 3 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Nequi_7_emails_created_by_bots' 1 = 0 AND (user.maturity in 'New','None','Amateur' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type in 'nequi','rappi_pay' AND user.user_email startswith list('CO_Email_Created_Bots') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Nequi_9_multiple_orders' 1 = 0 AND features.mk_payer_active_orders_qty > 1 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'nequi','rappi_pay' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_NEQUI_10_La_Rebaja' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'nequi','rappi_pay' AND order.store_type contains list('CO_Vertical-Pharmacy') AND (order.amount + order.custom.discount) < 15000 AND order.custom.applied_credits = 0 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_NEQUI_11_First_Orders_Low_Value_Express2' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 2) AND order.order_type in 'express_picker','market','express' AND payment_method.payment_type in 'nequi','rappi_pay' AND order.amount < 51000 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_NEQUI_12_First_Orders_Low_Value_Liq2' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 2) AND order.amount < 21000 AND payment_method.payment_type in 'nequi', 'rappi_pay' AND order.store_type contains list('CO_Vertical-Liquor') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_NEQUI_13_First_Orders_Low_Value_Pha2' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 2) AND order.amount < 21000 AND payment_method.payment_type in 'nequi', 'rappi_pay' AND order.store_type contains list('CO_Vertical-Pharmacy') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_NEQUI_14_ultra_new_accounts' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 1) AND payment_method.payment_type in 'nequi' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_NEQUI_15_late_night_ultra_new' 1 = 0 AND payment_method.payment_type in 'nequi', 'rappi_pay' AND user.completed_orders <= 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.customs.date_time_hour < 7 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_1_SPLIT' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.order_split.count_orders_by_split_id >= 2 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_2_Email_Bounced' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND user.email_verification_status in 'BOUNCED','DENIED' AND features.mk_payer_approved_qty_90d <= 2 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') AND user.user_email not contains list('CO_Domain-False-Positive') AND order.amount < 51000 AND order.store_type not in 'restaurant','Restaurant' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_3_Device_network' 1 = 0 AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND (user.maturity in 'New','None','Amateur' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_device_distinct_user_id_90d >= 3 AND order.amount < 51000 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_4_fingerprint_network' 1 = 0 AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND (user.maturity in 'New','None','Amateur' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_fingerprint_distinct_user_id_7d >= 3 AND order.amount < 51000 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_5_Risky_Name' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND payment_method.full_name contains list('Global_payment_method_risky_name') AND order.amount < 51000 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_6_emails_created_by_bots' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND user.user_email startswith list('CO_Email_Created_Bots') AND features.mk_geohash_qty_1d >= 1 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_8_multiple_orders' 1 = 0 AND features.mk_payer_active_orders_qty > 1 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_geohash_qty_1d >= 1 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_9_mk_geohash_abuse' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_geohash_qty_6h >= 4 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_10_local_prepaid_cards_CPGs_New' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Local-Prepaid') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in 'restaurant','ultraservicio' AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND order.store_type not in list('CO_Verticals-Ecommerce-Others') AND order.amount <= 60000 AND (features.mk_geohash_approved_qty_1d >= 2 OR features.mk_device_approved_qty_1d >= 2 OR features.mk_fingerprint_distinct_user_id_7d >1 OR mk_device_distinct_user_id_7d > 1) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_11_local_prepaid_cards_CPGs_late_night' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Local-Prepaid') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in 'restaurant','ultraservicio' AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND order.store_type not in list('CO_Verticals-Ecommerce-Others') AND order.amount <= 60000 AND (user.customs.date_time_hour > 21 OR user.customs.date_time_hour < 6) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_12_local_prepaid_cards_CPGs_ultra_new' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Local-Prepaid') AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in 'restaurant','ultraservicio' AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND order.store_type not in list('CO_Verticals-Ecommerce-Others') AND order.amount <= 20000 AND (user.customs.account_age_in_days = 0 OR address.age.days = 0) AND order.custom.applied_credits = 0 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_Prepaid_13_late_night_ultra_new' 1 = 0 AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND user.completed_orders <= 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.customs.date_time_hour < 7 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_1_SPLIT' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.order_split.count_orders_by_split_id >= 2 AND payment_method.country_code not in 'co','CO' AND payment_method.payment_type in 'credit_card' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_2_Email_Bounced' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.country_code not in 'co','CO' AND payment_method.payment_type in 'credit_card' AND user.email_verification_status in 'BOUNCED','DENIED' AND features.mk_payer_approved_qty_90d <= 2 AND device.user_agent not contains list('CO_Devices-High-End') AND order.custom.micro_zone not contains list('CO_MZ-Cuatro-Cinco') AND address.geohash_precision7 not startswith list('CO_Geohash6_MZ-Cuatro-Cinco') AND user.user_email not contains list('CO_Domain-False-Positive') AND order.amount < 51000 AND order.store_type not in 'restaurant','Restaurant' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_4_fingerprint_network' 1 = 0 AND payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND (user.maturity in 'New','None','Amateur' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_fingerprint_distinct_user_id_7d >= 3 AND order.amount < 51000 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_5_Risky_Name' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND payment_method.full_name contains list('Global_payment_method_risky_name') AND order.amount < 51000 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_6_emails_created_by_bots' 1 = 0 AND payment_method.payment_type in 'credit_card' AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND payment_method.country_code not in 'co','CO' AND user.user_email startswith list('CO_Email_Created_Bots') AND features.mk_geohash_qty_1d >= 1 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_7_funky_email' 1 = 0 AND payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.user_email contains list('Global_risky_email') AND user.user_email not contains '@privaterelay.appleid.com' AND features.mk_geohash_qty_1d >= 1 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_3_Device_network' 1 = 0 AND payment_method.country_code not in 'co','CO' AND payment_method.payment_type in 'credit_card' AND (user.maturity in 'New','None','Amateur' OR user.completed_orders <= 5) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_device_distinct_user_id_90d >= 3 AND order.amount < 51000 AND order.store_type not in 'restaurant','Restaurant' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_8_multiple_orders' 1 = 0 AND features.mk_payer_active_orders_qty > 1 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_geohash_qty_1d >= 1 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_9_mk_geohash_abuse' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND features.mk_geohash_qty_6h >= 4 AND order.store_type not in 'restaurant','Restaurant' AND ((user.customs.account_age <= 120 AND (order.custom.mk_internal_model_scoring_bucket > 65 OR features.mk_payer_canceled_by_fraud_qty > 0 OR (features.mk_device_distinct_user_id_30d + features.mk_fingerprint_distinct_user_id_30d + features.mk_fingerprint_distinct_device_id_30d + features.mk_device_distinct_cc_fingerprint_30d + features.mk_payer_distinct_device_id_30d + features.user_events_add_card_qty_30d) >= 4 OR address.age.days <= 7 OR features.mk_device_mins_since_last_approved_transaction <= features.mk_payer_mins_since_last_approved_transaction OR features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR device.user_devices_count > 0)) OR (user.customs.account_age > 120 AND order.custom.mk_internal_model_scoring_bucket >= 85 AND (features.mk_fingerprint_is_safe_fingerprint_90d = 0 OR address.age.days < 7))) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_10_local_prepaid_cards_CPGs_New' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in 'restaurant','ultraservicio' AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND order.store_type not in list('CO_Verticals-Ecommerce-Others') AND order.amount <= 60000 AND (features.mk_geohash_approved_qty_1d >= 2 OR features.mk_device_approved_qty_1d >= 2 OR features.mk_fingerprint_distinct_user_id_7d >1 OR mk_device_distinct_user_id_7d > 1) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_11_local_prepaid_cards_CPGs_late_night' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in 'restaurant','ultraservicio' AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND order.store_type not in list('CO_Verticals-Ecommerce-Others') AND order.amount <= 60000 AND (user.customs.date_time_hour > 21 OR user.customs.date_time_hour < 6) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_12_local_prepaid_cards_CPGs_ultra_new' 1 = 0 AND (user.maturity in 'New','None' OR user.completed_orders <= 5) AND payment_method.payment_type in 'credit_card' AND payment_method.country_code not in 'co','CO' AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND order.store_type not in 'restaurant','ultraservicio' AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND order.store_type not in list('CO_Verticals-Ecommerce-Others') AND order.amount <= 20000 AND (user.customs.account_age_in_days = 0 OR address.age.days = 0) AND order.custom.applied_credits = 0 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_International_13_late_night_ultra_new' 1 = 0 AND payment_method.payment_type in 'credit_card' AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND user.completed_orders <= 2 AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND user.customs.date_time_hour < 7 return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_order_dnp_new_android_rpay' 1 = 0 AND device.user_agent not contains list('CO_Devices-High-End') AND device.user_agent contains 'Dalvik' AND payment_method.payment_type in 'rappi_pay','nequi' AND features.mk_device_distinct_user_id_90d >= 5 AND order.store.store_id in '900074596', '900070792', '900071742' AND order.amount < 1 AND order.custom.discount > 0 AND features.mk_payer_approved_qty_90d = 0 AND user.email_verification_status not in 'VERIFIED','UNVERIFIED' AND user.user_email not contains list('CO_Domain-False-Positive') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'DNP_rappipay_attack_marketplace' 1 = 0 AND (payment_method.payment_type in 'nequi','rappi_pay' OR payment_method.card_bin in list('CO_BIN-Prepaid-Cards')) AND features.mk_user_is_whitelisted = false AND order.custom.mk_user_has_freepass = false AND (user.completed_orders <= 5 OR user.customs.account_age_in_days <= 30) AND (order.is_marketplace = true OR order.store.store_id in list('CO_SelfOnboarding_Stores')) AND order.store.store_id not in list('Non_fraud_marketplace_rests') return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_low_value_ecard' 1 = 0 AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND order.store_type not in 'activations', 'restaurant', 'courier_hours', 'ultraservicio', 'eventos_ccc', 'tech_exito', 'rappi_livestream', 'social_gifts' AND user.segment not in 'Diamond','Power','Potential Diamond','Potential Power','diamond','potential diamond','power','potential power' AND device.user_agent not contains list('CO_Devices-High-End') AND order.store_type not in list('CO_Vertical-Ecommerce-Tech') AND order.store_type not in list('CO_Verticals-Ecommerce-Others') AND order.store_type not in list('CO_Vertical-Ecommerce-Dia-Sin-IVA') AND features.mk_payer_approved_qty_90d < 10 AND order.amount < 51000 AND user.maturity in 'New','None' AND order.custom.mk_internal_model_scoring_bucket > 41 AND (features.mk_fingerprint_is_safe_fingerprint_60d = 0 OR features.mk_device_is_safe_device_60d = 0) return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_low_value_ecard_express' 1 = 0 AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND user.segment not in 'Diamond','Power','Potential Diamond','Potential Power' AND device.user_agent not contains list('CO_Devices-High-End') AND order.store_type in list('CO_Vertical-Express') AND features.mk_payer_approved_qty_90d < 10 AND order.amount < 51000 AND features.mk_payer_cc_approved_amount_90d < 28 AND user.maturity in 'New','None' AND order.gift_information.store.store_type not in 'social_gifts' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) 'cancel_low_value_ecard_super' 1 = 0 AND payment_method.card_bin in list('CO_BIN-Prepaid-Cards') AND user.segment not in 'diamond','potential diamond','power','potential power' AND device.user_agent not contains list('CO_Devices-High-End') AND order.store_type in list('CO_Vertical-Super-and-Hiper') AND features.mk_payer_approved_qty_90d < 10 AND order.amount < 51000 AND features.mk_payer_cc_approved_amount_90d < 28 AND user.maturity in 'New','None' AND order.gift_information.store.store_type not in 'social_gifts' return block with action('communications',{'case_type':'cancel_order_fraud_communication'}) default allow end
